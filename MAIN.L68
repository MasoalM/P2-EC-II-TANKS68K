00003E7E Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 25/12/2024 20:25:58

00000000                             1  *-----------------------------------------------------------
00000000                             2  * Título      : TANKS 68K!
00000000                             3  * Escrito por : Sergi Villalonga Gamundí y Marcos Socías Alberto 
00000000                             4  * Descripción : Juego donde eres un tanque verde que se enfrenta
00000000                             5  *               a otros tanques de color rojo. Se basa en 3 niveles
00000000                             6  *               que debes superar antes de ser derrotado.
00000000                             7  *-----------------------------------------------------------
00001000                             8          ORG    $1000
00001000                             9      
00001000                            10          INCLUDE "SYSCONST.X68"
00001000                            11  
00001000                            12  ; --- CONSTANTES RELACIONADAS CON LA PANTALLA --------------
00001000                            13  
00001000  =00000280                 14  SCRWIDTH    EQU     640         ; ANCHURA DE LA PANTALLA DEL JUEGO
00001000  =000001E0                 15  SCRHEIGH    EQU     480         ; ALTURA DE LA PANTALLA DEL JUEGO
00001000  =00000032                 16  SCRFPS      EQU     50          ; SCREEN FRAMES PER SECOND, EN NUESTRO CASO 50 FPS (UNA INTERRUPCIÓN CADA 20 ms)
00001000                            17  
00001000                            18  ; --- KEYCODES ---------------------------------------------
00001000                            19  
00001000  =00000041                 20  KBDLEFT     EQU     'A'
00001000  =00000057                 21  KBDUP       EQU     'W'
00001000  =00000044                 22  KBDRIGHT    EQU     'D'
00001000  =00000053                 23  KBDDOWN     EQU     'S'
00001000  =00000020                 24  KBDFIRE     EQU     ' '
00001000  =00000049                 25  KBDINSTR    EQU     'I'
00001000                            26  
00001000                            27  ; --- SOUND IDENTIFIERS ------------------------------------
00001000                            28  
00001000  =00000000                 29  SNDINTRO    EQU     0
00001000  =00000001                 30  SNDINSTR    EQU     1
00001000  =00000002                 31  SNDWALL     EQU     2
00001000  =00000003                 32  SNDHIT      EQU     3
00001000  =00000004                 33  SNDKILL     EQU     4
00001000  =00000005                 34  SNDDISP     EQU     5
00001000  =00000006                 35  SNDGVR1     EQU     6
00001000  =00000007                 36  SNDWIN      EQU     7
00001000  =00000008                 37  SNDEXPLO    EQU     8
00001000                            38  
00001000                            39  ; --- TRAP NUMBERS -----------------------------------------
00001000                            40  
00001000  =00000000                 41  SCRUPTN     EQU     0           ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 42  KBDUPTN     EQU     1           ; KEYBOARD UPDATE TRAP NUMBER
00001000  =00000002                 43  MOUUPTN     EQU     2           ; MOUSE UPDATE TRAP NUMBER
00001000  =00000003                 44  SNDPLTN     EQU     3           ; SOUND PLAY TRAP NUMBER
00001000                            45  
00001000                            46  ; --- INTERRUPT NUMBERS ------------------------------------
00001000                            47  
00001000  =00000001                 48  SCRINTN     EQU     1           ; TIMED INTERRUPT NUMBER
00001000                            49  
00001000                            50  
00001000                            51  
00001000                            52  
00001000                            53  
00001000                            54  
00001000                            55  
00001000                            56  
00001000                            57  
00001000                            58  
00001000                            59  
00001000                            60  
00001000                            61  
00001000                            62  
00001000                            63  
00001000                            64  -------------------- end include --------------------
00001000                            65          INCLUDE "CONST.X68"
00001000                            66      
00001000                            67  ; --- CONSTANTES RELACIONADAS CON LA BALA DEL TANQUE -------
00001000                            68  
00001000  =00000004                 69  BULRAD      EQU     4           ; RADIO DE LA BALA
00001000  =0031494D                 70  BULPCOL     EQU     $0031494D   ; COLOR DE CONTORNO DE LA BALA        
00001000  =007CB4BA                 71  BULFCOL     EQU     $007CB4BA   ; COLOR DE RELLENO DE LA BALA  
00001000  =00000007                 72  BULSPEED    EQU     7           ; MAGNITUD DE LA VELOCIDAD X E Y DE LA BALA
00001000  =00000028                 73  BULDMG      EQU     40          ; DAÑO DE LA BALA
00001000  =00000003                 74  MAXTOUCH    EQU     3           ; TOQUES MÁXIMOS DE LA BALA CON LAS PAREDES
00001000                            75  
00001000                            76  ; --- CONSTANTES RELACIONADAS CON EL TANQUE ----------------
00001000                            77  
00001000  =00000010                 78  TANWIDTH    EQU     16                      ; ANCHURA DEL TANQUE
00001000  =00000010                 79  TANHEIGH    EQU     16                      ; ALTURA DEL TANQUE
00001000  =00000002                 80  PLRSPEED    EQU     2                       ; MAGNITUD DE LA VELOCIDAD X E Y DEL JUGADOR
00001000  =00000001                 81  ENESPEED    EQU     1                       ; MAGNITUD DE LA VELOCIDAD X E Y DEL ENEMIGO
00001000  =00000032                 82  PLRINITX    EQU     50                      ; POSICIÓN X INICIAL DEL JUGADOR
00001000  =000000F0                 83  PLRINITY    EQU     SCRHEIGH/2              ; POSICIÓN Y INICIAL DEL JUGADOR
00001000  =00000190                 84  PLRINILF    EQU     BULDMG*10               ; VIDA INICIAL DEL TANQUE JUGADOR
00001000  =00000078                 85  ENEINILF    EQU     BULDMG*3                ; VIDA INICIAL DEL TANQUE ENEMIGO
00001000  =00000014                 86  PLRLIFEH    EQU     20                      ; ALTURA DE LA BARRA DE VIDA DEL JUGADOR
00001000  =000001C6                 87  PLRLIFEY    EQU     SCRHEIGH-PLRLIFEH-6     ; POSICIÓN Y DE LA BARRA DE VIDA DEL JUGADOR
00001000  =000000FF                 88  PLRLIFEC    EQU     $000000FF               ; COLOR DE LA BARRA DE VIDA
00001000  =00000003                 89  PLMAXBUL    EQU     3                       ; CANTIDAD MÁXIMA DE BALAS DISPARADAS SIMULTÁNEAMENTE POR EL JUGADOR
00001000  =00000064                 90  ENEMYRTF    EQU     SCRFPS*2                ; TIEMPO MÍNIMO QUE SE TOMA EL ENEMIGO ENTRE DISPARO Y DISPARO. (SCRFPS * SEGUNDOS DESEADOS)
00001000                            91  
00001000                            92  ; --- CONSTANTES RELACIONADAS CON LOS MARCADORES -----------
00001000                            93  
00001000  =00000000                 94  SCOFCOL     EQU     $00000000   ; COLOR DE FONDO DEL TEXTO
00001000  =00000000                 95  SCOLINE     EQU     $0000       ; COORDENADAS DE LA LÍNEA DE TEXTO ($CXCY)
00001000  =00004000                 96  FPSLINE1    EQU     $4000       ; COORDENADAS DE LOS PRIMEROS FPS A MOSTRAR      
00001000  =00004001                 97  FPSLINE2    EQU     $4001       ; COORDENADAS DE LOS SEGUNDOS FPS A MOSTRAR
00001000                            98  
00001000                            99  ; --- CONSTANTES RELACIONADAS CON EL ESTADO ----------------
00001000                           100  
00001000  =FFFFFFFF                101  STANONE     EQU     -1          ; NÚMERO DE ESTADO NO EXISTENTE (NO VÁLIDO)
00001000  =000001F4                102  ISCMAXTM    EQU     500         ; CICLOS DE ESPERA EN LA PANTALLA DE INTRODUCCIÓN
00001000                           103  
00001000                           104  ; --- CONSTANTES DE NIVELES --------------------------------
00001000                           105  
00001000  =00000002                106  ENEMLVL1        EQU     2
00001000  =00000006                107  ENEMLVL2        EQU     4+ENEMLVL1
00001000  =00000009                108  ENEMLVL3        EQU     3+ENEMLVL2       ; MÁXIMAS KILLS
00001000                           109  
00001000                           110  ; --- CONSTANTES DE VICTORIA/DERROTA -----------------------
00001000                           111       
00001000  =00000000                112  PLYRALIV    EQU     0           ; JUGADOR VIVO
00001000  =00000001                113  KILLPLYR    EQU     1           ; MATAR AL JUGADOR (JUGADOR MUERTO)
00001000                           114  
00001000                           115  ; --- CONSTANTES RELACIONADAS CON EL MAPA ------------------
00001000                           116  
00001000  =00000000                117  MAPINIX     EQU     0           ; POSICIÓN DE INICIO DEL MAPA RESPECTO A X
00001000  =00000000                118  MAPINIY     EQU     0           ; POSICIÓN DE INICIO DE MAPA RESPECTO A Y
00001000  =00000014                119  MAPPIEX     EQU     20          ; NÚMERO DE CASILLAS EN EL EJE X
00001000  =0000000F                120  MAPPIEY     EQU     15          ; NÚMERO DE CASILLAS EN EL EJE Y
00001000  =00000020                121  PIESIZX     EQU     32          ; TAMAÑO DE LAS CASILLAS EN EL EJE X
00001000  =00000020                122  PIESIZY     EQU     32          ; TAMAÑO DE LAS CASILLAS EN EL EJE Y 
00001000  =00000258                123  SIZLVL      EQU     600         ; TAMAÑO DE UN MAPA
00001000                           124  
00001000                           125  ; --- CONSTANTES RELACIONADAS CON EL TIPO DE AGENTE --------
00001000                           126  
00001000  =00000001                127  BULTYPE     EQU     1           ; BALA
00001000  =00000002                128  TANPLAY     EQU     2           ; TANQUE JUGADOR
00001000  =00000003                129  TANENEM     EQU     3           ; TANQUE ENEMIGO
00001000                           130  
00001000                           131  ; --- CONSTANTES RELACIONADAS CON LA IMAGEN DEL MENÚ -------
00001000                           132  
00001000  =00000200                133  IMAWIDTH    EQU     512
00001000  =00000180                134  IMAHEIGH    EQU     384
00001000  =00000064                135  WINWIDTH    EQU     100
00001000  =00000050                136  WINHEIGH    EQU     80
00001000                           137  
00001000                           138  
00001000                           139  
00001000                           140  
00001000                           141  
00001000                           142  
00001000                           143  
00001000                           144  
00001000                           145  
00001000                           146  
00001000                           147  
00001000                           148  
00001000                           149  
00001000                           150  
00001000                           151  
00001000                           152  
00001000                           153  
00001000                           154  
00001000                           155  
00001000                           156  
00001000                           157  
00001000                           158  
00001000                           159  
00001000                           160  
00001000                           161  
00001000                           162  
00001000                           163  
00001000                           164  
00001000                           165  
00001000                           166  
00001000                           167  
00001000                           168  
00001000                           169  
00001000                           170  
00001000                           171  
00001000                           172  
00001000                           173  
00001000                           174  
00001000                           175  
00001000                           176  
00001000                           177  
00001000                           178  
00001000                           179  
00001000                           180  
00001000                           181  
00001000                           182  
00001000                           183  
00001000                           184  
00001000                           185  
00001000                           186  
00001000                           187  -------------------- end include --------------------
00001000                           188          INCLUDE "LIB/DMMCONST.X68"
00001000                           189  ; =============================================================================
00001000                           190  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001000                           191  ; =============================================================================
00001000                           192  
00001000  =00000040                193  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                194  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                195  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000  =00000000                196  -------------------- end include --------------------
00001000                           197          INCLUDE "LIB/UTLCONST.X68"
00001000                           198  
00001000  =00000008                199  UTLCHRWD    EQU     8       ; CHARACTER WIDTH IN PIXELS
00001000                           200  
00001000                           201  -------------------- end include --------------------
00001000                           202          INCLUDE "LIB/DMMCODE.X68"
00001000                           203  ; =============================================================================
00001000                           204  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001000                           205  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001000                           206  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001000                           207  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001000                           208  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001000                           209  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001000                           210  ; =============================================================================
00001000                           211  
00001000                           212  ; -----------------------------------------------------------------------------
00001000                           213  DMMINIT
00001000                           214  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001000                           215  ; INPUT    - NONE
00001000                           216  ; OUTPUT   - NONE
00001000                           217  ; MODIFIES - NONE
00001000                           218  ; -----------------------------------------------------------------------------
00001000  48E7 8080                219              MOVEM.L D0/A0,-(A7)
00001004  41F9 001D0EC0            220              LEA     DMMDATA,A0
0000100A  303C 0031                221              MOVE.W  #DMMBNUM-1,D0
0000100E  30BC 0000                222  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001012  D1FC 00000040            223              ADD.L   #DMMBSIZE,A0
00001018  51C8 FFF4                224              DBRA.W  D0,.LOOP
0000101C  4CDF 0101                225              MOVEM.L (A7)+,D0/A0
00001020  4E75                     226              RTS
00001022                           227  
00001022                           228  ; -----------------------------------------------------------------------------
00001022                           229  DMMFIRST
00001022                           230  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001022                           231  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001022                           232  ; INPUT    - NONE
00001022                           233  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001022                           234  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001022                           235  ; -----------------------------------------------------------------------------
00001022  41F9 001D0EC0            236              LEA     DMMDATA,A0
00001028  4A58                     237  DMMFRLOP    TST.W   (A0)+
0000102A  6600 0016                238              BNE     DMMFRFND
0000102E  D1FC 0000003E            239              ADD.L   #DMMBSIZE-2,A0
00001034  B1FC 001D1B3F            240  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000103A  6DEC                     241              BLT     DMMFRLOP
0000103C  207C 00000000            242              MOVE.L  #0,A0
00001042  4E75                     243  DMMFRFND    RTS
00001044                           244  
00001044                           245  ; -----------------------------------------------------------------------------
00001044                           246  DMMNEXT
00001044                           247  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001044                           248  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001044                           249  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001044                           250  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001044                           251  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001044                           252  ; -----------------------------------------------------------------------------
00001044  2F00                     253              MOVE.L  D0,-(A7)
00001046  2008                     254              MOVE.L  A0,D0
00001048  C0BC FFFFFFC0            255              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000104E  0680 00000040            256              ADD.L   #DMMBSIZE,D0
00001054  2040                     257              MOVE.L  D0,A0
00001056  201F                     258              MOVE.L  (A7)+,D0
00001058  60DA                     259              BRA     DMMFRCOM
0000105A                           260  
0000105A                           261  ; -----------------------------------------------------------------------------
0000105A                           262  DMMFRSTO
0000105A                           263  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000105A                           264  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000105A                           265  ; INPUT    - D0.W : ID TO SEARCH
0000105A                           266  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000105A                           267  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000105A                           268  ; -----------------------------------------------------------------------------
0000105A  41F9 001D0EC0            269              LEA     DMMDATA,A0
00001060  B058                     270  DMMFLOOP    CMP.W   (A0)+,D0
00001062  6700 0016                271              BEQ     DMMFFND
00001066  D1FC 0000003E            272              ADD.L   #DMMBSIZE-2,A0
0000106C  B1FC 001D1B3F            273  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001072  6DEC                     274              BLT     DMMFLOOP
00001074  207C 00000000            275              MOVE.L  #0,A0
0000107A  4E75                     276  DMMFFND     RTS
0000107C                           277  
0000107C                           278  ; -----------------------------------------------------------------------------
0000107C                           279  DMMNEXTO
0000107C                           280  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000107C                           281  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000107C                           282  ; INPUT    - D0.W : ID TO SEARCH
0000107C                           283  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000107C                           284  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000107C                           285  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000107C                           286  ; -----------------------------------------------------------------------------
0000107C  2F00                     287              MOVE.L  D0,-(A7)
0000107E  2008                     288              MOVE.L  A0,D0
00001080  C0BC FFFFFFC0            289              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001086  0680 00000040            290              ADD.L   #DMMBSIZE,D0
0000108C  2040                     291              MOVE.L  D0,A0
0000108E  201F                     292              MOVE.L  (A7)+,D0
00001090  60DA                     293              BRA     DMMFCOM
00001092                           294  
00001092                           295  ; -----------------------------------------------------------------------------
00001092                           296  DMMALLOC
00001092                           297  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001092                           298  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001092                           299  ; INPUT    - D0.W : ID TO ASSIGN
00001092                           300  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001092                           301  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001092                           302  ; -----------------------------------------------------------------------------
00001092  3F00                     303              MOVE.W  D0,-(A7)
00001094  4240                     304              CLR.W   D0
00001096  4EB8 105A                305              JSR     DMMFRSTO
0000109A  301F                     306              MOVE.W  (A7)+,D0
0000109C  B1FC 00000000            307              CMP.L   #0,A0
000010A2  6700 0006                308              BEQ     .END
000010A6  3140 FFFE                309              MOVE.W  D0,-2(A0)
000010AA  4E75                     310  .END        RTS
000010AC                           311  
000010AC                           312  ; -----------------------------------------------------------------------------
000010AC                           313  DMMFREE
000010AC                           314  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010AC                           315  ; SYSTEM (0)
000010AC                           316  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010AC                           317  ; OUTPUT   - NONE
000010AC                           318  ; MODIFIES - NONE
000010AC                           319  ; -----------------------------------------------------------------------------
000010AC  48E7 8080                320              MOVEM.L D0/A0,-(A7)
000010B0  2008                     321              MOVE.L  A0,D0
000010B2  C0BC FFFFFFC0            322              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010B8  2040                     323              MOVE.L  D0,A0
000010BA  4250                     324              CLR.W   (A0)
000010BC  4CDF 0101                325              MOVEM.L (A7)+,D0/A0
000010C0  4E75                     326              RTS
000010C0  4E75                     327  -------------------- end include --------------------
000010C2                           328          INCLUDE "SYSTEM.X68"
000010C2                           329  
000010C2                           330  ; ----------------------------------------------------------
000010C2                           331  SYSINIT
000010C2                           332  ; INITIALIZE SYSTEM
000010C2                           333  ; INPUT     : NONE
000010C2                           334  ; OUTPUT    : NONE
000010C2                           335  ; MODIFIES  : NONE
000010C2                           336  ; ----------------------------------------------------------
000010C2                           337              
000010C2  21FC 0000121A 0080       338              MOVE.L  #SCRPLOT,($80+SCRUPTN*4)
000010CA  21FC 00001250 0084       339              MOVE.L  #KBDUPD,($80+KBDUPTN*4) 
000010D2  21FC 000011CE 008C       340              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
000010DA  21FC 00001234 0064       341              MOVE.L  #SCRTIM,($60+SCRINTN*4) ; INTERRUPCIÓN DE TIPO 1
000010E2                           342              
000010E2  4EB9 000011E0            343              JSR     SCRINIT
000010E8  4EB9 00001242            344              JSR     KBDINIT
000010EE  4EB9 0000129E            345              JSR     MOUINIT
000010F4  4EB9 00001106            346              JSR     SNDINIT
000010FA  4EB8 1000                347              JSR     DMMINIT
000010FE                           348              
000010FE  40E7                     349              MOVE.W  SR,-(A7)
00001100  0257 D8FF                350              ANDI.W  #$D8FF,(A7) ; MODO USUARIO Y HABILITAR INTERRUPCIONES
00001104  4E73                     351              RTE        
00001106                           352  
00001106                           353  ; ----------------------------------------------------------            
00001106                           354  SNDINIT
00001106                           355  ; SOUND SYSTEM INIT
00001106                           356  ; INPUT     : NONE
00001106                           357  ; OUTPUT    : NONE
00001106                           358  ; MODIFIES  : NONE
00001106                           359  ; ----------------------------------------------------------
00001106                           360  
00001106  48E7 C0C0                361              MOVEM.L D0-D1/A0-A1,-(A7)
0000110A                           362  
0000110A  4201                     363              CLR.B   D1
0000110C  41F9 000011A6            364              LEA     .SNDLIST,A0
00001112  2018                     365  .LOOP       MOVE.L  (A0)+,D0    ; SI HICIESEMOS MOVEA (PASAR DE A0 A A1 DIRECTAMENTE) NO ACTUALIZARÍA EL FLAG Z
00001114  6700 000E                366              BEQ     .DONE
00001118  2240                     367              MOVE.L  D0,A1
0000111A  103C 0047                368              MOVE.B  #71,D0
0000111E  4E4F                     369              TRAP    #15
00001120  5201                     370              ADDQ.B  #1,D1
00001122  60EE                     371              BRA     .LOOP
00001124  4CDF 0303                372  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1   
00001128  4E75                     373              RTS
0000112A= 53 4E 44 2F 49 4E ...    374  .SNDINTRO   DC.B    'SND/INTRO.wav',0
00001138= 53 4E 44 2F 49 4E ...    375  .SNDINSTR   DC.B    'SND/INSTR.wav',0
00001146= 53 4E 44 2F 57 41 ...    376  .SNDWALL    DC.B    'SND/WALL.wav',0
00001153= 53 4E 44 2F 48 49 ...    377  .SNDHIT     DC.B    'SND/HIT.wav',0
0000115F= 53 4E 44 2F 45 4E ...    378  .SNDKILL    DC.B    'SND/ENEMKILL.wav',0
00001170= 53 4E 44 2F 44 49 ...    379  .SNDDISP    DC.B    'SND/DISP.wav',0
0000117D= 53 4E 44 2F 47 4F ...    380  .SNDGVR1    DC.B    'SND/GOVER1.wav',0
0000118C= 53 4E 44 2F 57 49 ...    381  .SNDWIN     DC.B    'SND/WIN.wav',0
00001198= 53 4E 44 2F 45 58 ...    382  .SNDEXPLO   DC.B    'SND/EXPLO.wav',0
000011A6                           383              DS.W    0
000011A6= 0000112A 00001138 ...    384  .SNDLIST    DC.L    .SNDINTRO,.SNDINSTR,.SNDWALL,.SNDHIT,.SNDKILL,.SNDDISP,.SNDGVR1,.SNDWIN,.SNDEXPLO,0
000011CE                           385              
000011CE                           386  ; ----------------------------------------------------------
000011CE                           387  SNDPLAY
000011CE                           388  ; PLAY SOUND
000011CE                           389  ; INPUT     : D7 SOUND ID
000011CE                           390  ; OUTPUT    : NONE
000011CE                           391  ; MODIFIES  : NONE
000011CE                           392  ; ----------------------------------------------------------
000011CE  48A7 C000                393              MOVEM.W D0-D1,-(A7)
000011D2  103C 0048                394              MOVE.B  #72,D0
000011D6  1207                     395              MOVE.B  D7,D1
000011D8  4E4F                     396              TRAP    #15
000011DA  4C9F 0003                397              MOVEM.W (A7)+,D0-D1
000011DE  4E73                     398              RTE
000011E0                           399              
000011E0                           400  ; ----------------------------------------------------------
000011E0                           401  SCRINIT
000011E0                           402  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
000011E0                           403  ; ENABLE DOUBLE BUFFER, ENABLE TIMED INTERRUPT
000011E0                           404  ; INPUT     : NONE
000011E0                           405  ; OUTPUT    : NONE
000011E0                           406  ; MODIFIES  : NONE
000011E0                           407  ; ----------------------------------------------------------
000011E0                           408              
000011E0  48E7 C000                409              MOVEM.L D0-D1,-(A7)
000011E4                           410  
000011E4                           411              ; SET SCREEN RESOLUTION
000011E4  103C 0021                412              MOVE.B  #33,D0
000011E8  223C 028001E0            413              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
000011EE  4E4F                     414              TRAP    #15
000011F0                           415              
000011F0                           416              ; SET WINDOWED MODE
000011F0  7201                     417              MOVE.L  #1,D1
000011F2  4E4F                     418              TRAP    #15
000011F4                           419              
000011F4                           420              ; CLEAR SCREEN
000011F4  103C 000B                421              MOVE.B  #11,D0
000011F8  323C FF00                422              MOVE.W  #$FF00,D1
000011FC  4E4F                     423              TRAP    #15
000011FE                           424              
000011FE                           425              ; ENABLE DOUBLE BUFFER
000011FE                           426              ;MOVE.B  #92,D0
000011FE                           427              ;MOVE.B  #17,D1
000011FE                           428              ;TRAP    #15
000011FE                           429              
000011FE                           430              ; ENABLE TIMED INTERRUPT
000011FE  103C 0020                431              MOVE.B  #32,D0
00001202  123C 0006                432              MOVE.B  #6,D1
00001206  143C 0081                433              MOVE.B  #$80|SCRINTN,D2 ; BIT 7 = 1 TO ENABLE INDIVIDUAL IRQ, BITS 6-0 = NUMBER OF INTERRUPT (1)
0000120A  7614                     434              MOVE.L  #1000/SCRFPS,D3
0000120C  4E4F                     435              TRAP    #15
0000120E                           436              
0000120E                           437              ; CLEAR INTERRUPT COUNTER
0000120E  4239 00003F78            438              CLR.B   (SCRINTCT)   
00001214                           439              
00001214  4CDF 0003                440              MOVEM.L (A7)+,D0-D1
00001218                           441              
00001218  4E75                     442              RTS
0000121A                           443              
0000121A                           444  ; ----------------------------------------------------------
0000121A                           445  SCRPLOT
0000121A                           446  ; UPDATE DOUBLE BUFFER
0000121A                           447  ; INPUT     : NONE
0000121A                           448  ; OUTPUT    : NONE
0000121A                           449  ; MODIFIES  : NONE
0000121A                           450  ; ----------------------------------------------------------
0000121A  48A7 C000                451              MOVEM.W D0-D1,-(A7)
0000121E                           452              ; SWITCH BUFFERS
0000121E  103C 005E                453              MOVE.B  #94,D0
00001222  4E4F                     454              TRAP    #15
00001224                           455              
00001224                           456              ; CLEAR HIDDEN BUFFER
00001224  103C 000B                457              MOVE.B  #11,D0
00001228  323C FF00                458              MOVE.W  #$FF00,D1
0000122C  4E4F                     459              TRAP    #15 
0000122E  4C9F 0003                460              MOVEM.W (A7)+,D0-D1
00001232                           461              
00001232  4E73                     462              RTE
00001234                           463  
00001234                           464  ; ----------------------------------------------------------            
00001234                           465  SCRTIM
00001234                           466  ; TIMED INTERRUPT SERVICE ROUTINE
00001234                           467  ; INPUT    : NONE
00001234                           468  ; OUTPUT   : NONE
00001234                           469  ; MODIFIES : NONE
00001234                           470  ; ----------------------------------------------------------
00001234                           471              
00001234  5239 00003F78            472              ADDQ.B  #1,(SCRINTCT)
0000123A  5239 00003F79            473              ADDQ.B  #1,(SCRCYCCT)
00001240  4E73                     474              RTE
00001242                           475              
00001242                           476  ; ----------------------------------------------------------
00001242                           477  KBDINIT
00001242                           478  ; INIT KEYBARD
00001242                           479  ; INPUT     : NONE
00001242                           480  ; OUTPUT    : NONE
00001242                           481  ; MODIFIES  : NONE
00001242                           482  ; ----------------------------------------------------------
00001242  4239 00003F6A            483              CLR.B   (KBDVAL)
00001248  4239 00003F6B            484              CLR.B   (KBDEDGE)
0000124E  4E75                     485              RTS
00001250                           486              
00001250                           487  ; ----------------------------------------------------------
00001250                           488  KBDUPD
00001250                           489  ; UPDATE KEYBOARD INFO
00001250                           490  ; 7 ->
00001250                           491  ; 6 ->
00001250                           492  ; 5 -> INSTRUCTIONS
00001250                           493  ; 4 -> FIRE
00001250                           494  ; 3 -> DOWN
00001250                           495  ; 2 -> RIGHT
00001250                           496  ; 1 -> UP
00001250                           497  ; 0 -> LEFT
00001250                           498  ; INPUT     : NONE
00001250                           499  ; OUTPUT    : NONE
00001250                           500  ; MODIFIES  : NONE
00001250                           501  ; ----------------------------------------------------------
00001250                           502              
00001250  48E7 F000                503              MOVEM.L D0-D3,-(A7)
00001254                           504  
00001254                           505              ; READ FIRST PART
00001254  103C 0013                506              MOVE.B  #19,D0
00001258  223C 00004920            507              MOVE.L  #KBDINSTR<<8|KBDFIRE,D1
0000125E  4E4F                     508              TRAP    #15
00001260                           509              
00001260                           510              ; CONVERT TO DESIRED FORMAT
00001260  4EB9 00001290            511              JSR     .PACK
00001266                           512              
00001266                           513              ; READ SECOND PART
00001266  223C 53445741            514              MOVE.L  #KBDDOWN<<24|KBDRIGHT<<16|KBDUP<<8|KBDLEFT,D1
0000126C  4E4F                     515              TRAP    #15
0000126E                           516              
0000126E                           517              ; CONVERT TO DESIRED FORMAT
0000126E  4EB9 00001290            518              JSR     .PACK
00001274                           519              
00001274                           520              ; COMPUTE KBDEDGE
00001274  1039 00003F6A            521              MOVE.B  (KBDVAL),D0
0000127A  4600                     522              NOT.B   D0
0000127C  C002                     523              AND.B   D2,D0       ; KBDVAL NUEVO AND KBDVAL ANTERIOR NEGADO
0000127E  13C0 00003F6B            524              MOVE.B  D0,(KBDEDGE)
00001284                           525              
00001284                           526              ; STORE KBDVAL
00001284  13C2 00003F6A            527              MOVE.B  D2,(KBDVAL)
0000128A                           528              
0000128A  4CDF 000F                529              MOVEM.L (A7)+,D0-D3
0000128E                           530              
0000128E  4E73                     531              RTE
00001290                           532              
00001290  363C 0003                533  .PACK       MOVE.W  #3,D3
00001294  E189                     534  .LOOP       LSL.L   #8,D1
00001296  E312                     535              ROXL.B  #1,D2
00001298  51CB FFFA                536              DBRA.W  D3,.LOOP
0000129C  4E75                     537              RTS
0000129E                           538              
0000129E                           539  
0000129E                           540  ; ----------------------------------------------------------
0000129E                           541  MOUINIT
0000129E                           542  ; INIT MOUSE
0000129E                           543  ; INPUT     : NONE
0000129E                           544  ; OUTPUT    : NONE
0000129E                           545  ; MODIFIES  : NONE
0000129E                           546  ; ----------------------------------------------------------
0000129E  42B9 00003F74            547              CLR.L   (MOUPOS)
000012A4  4279 00003F70            548              CLR.W   (MOUBUT)
000012AA  4E75                     549              RTS
000012AC                           550              
000012AC                           551  ; ----------------------------------------------------------
000012AC                           552  MOUUPD
000012AC                           553  ; INIT MOUSE
000012AC                           554  ; INPUT     : NONE
000012AC                           555  ; OUTPUT    : NONE
000012AC                           556  ; MODIFIES  : NONE
000012AC                           557  ; ----------------------------------------------------------
000012AC  48E7 C000                558              MOVEM.L D0-D1,-(A7)
000012B0  103C 003D                559              MOVE.B  #61,D0
000012B4  4201                     560              CLR.B   D1
000012B6  4E4F                     561              TRAP    #15
000012B8  23C1 00003F74            562              MOVE.L  D1,(MOUPOS)
000012BE  1239 00003F70            563              MOVE.B  (MOUBUT),D1
000012C4  13C0 00003F70            564              MOVE.B  D0,(MOUBUT)
000012CA  4601                     565              NOT.B   D1
000012CC  C001                     566              AND.B   D1,D0
000012CE  13C0 00003F6C            567              MOVE.B  D0,(MOUEDGE)
000012D4  1039 00003F6C            568              MOVE.B  (MOUEDGE),D0
000012DA  4CDF 0003                569              MOVEM.L (A7)+,D0-D1
000012DE  4E75                     570              RTS
000012E0                           571              
000012E0                           572  ; ----------------------------------------------------------------------------           
000012E0                           573  READMOU
000012E0                           574  ; READ MOUSE VARIABLES
000012E0                           575  ; INPUT    : NONE
000012E0                           576  ; OUTPUT   : NONE
000012E0                           577  ; MODIFIES : NONE
000012E0                           578  ;----------------------------------------------------------------------------- 
000012E0  48E7 F000                579              MOVEM.L D0-D3, -(A7)
000012E4  4281                     580              CLR.L   D1
000012E6                           581              
000012E6  303C 003D                582              MOVE.W  #61,D0           ;LECTURA DEL RATÓN
000012EA  123C 0000                583              MOVE.B  #0,D1
000012EE  4E4F                     584              TRAP    #15
000012F0                           585              
000012F0  0800 0000                586              BTST    #0,D0
000012F4  6700 000C                587              BEQ     .NOCLICKED
000012F8                           588        
000012F8  2401                     589              MOVE.L  D1, D2           ;PROCESO DE EXTRACCIÓN DE LA COORDENADA X
000012FA  0282 0000FFFF            590              ANDI.L  #$0000FFFF, D2
00001300                           591              
00001300  2601                     592              MOVE.L  D1, D3           ;PROCESO D'EXTRACCIÓN DE LA COORDENADA Y
00001302                           593              ;ANDI.L  #$FFFF0000, D3
00001302                           594              ;LSR.L   #8, D3
00001302                           595              ;LSR.L   #8, D3
00001302                           596  .NOCLICKED:             
00001302  4CDF 000F                597              MOVEM.L (A7)+, D0-D3
00001306  4E75                     598              RTS
00001308                           599  
00001308                           600  
00001308                           601  ; ----------------------------------------------------------------------------           
00001308                           602  APUNTADOR
00001308                           603  ; COLOCA LA DIRECCIÓN EN LA CUAL APUNTA EL RATÓN O EL ENEMIGO (LA FOTO, LAS VARS DE LA BALA)
00001308                           604  ; INPUT     : D7 (0 indica que es el jugador, 1 el jugador en la demo y 2 el enemigo)
00001308                           605  ; OUTPUT    : NONE
00001308                           606  ; MODIFIES  : NONE
00001308                           607  ;----------------------------------------------------------------------------- 
00001308                           608  
00001308  48E7 3F00                609              MOVEM.L D2-D7,-(A7)
0000130C                           610              
0000130C  BE7C 0002                611              CMP.W   #2,D7
00001310  6700 0028                612              BEQ     .ENEMY
00001314  BE7C 0001                613              CMP.W   #1,D7
00001318  6700 0030                614              BEQ     .DEMOPLAY
0000131C                           615              
0000131C  2439 00003F74            616              MOVE.L (MOUPOS),D2
00001322  2602                     617              MOVE.L  D2,D3            ;PROCESO DE EXTRACCIÓN DE LA COORDENADA X
00001324  0283 0000FFFF            618              ANDI.L  #$0000FFFF,D3
0000132A                           619              
0000132A  2802                     620              MOVE.L  D2,D4            ;PROCESO DE EXTRACCIÓN DE LA COORDENADA Y
0000132C  0284 FFFF0000            621              ANDI.L  #$FFFF0000,D4
00001332  E08C                     622              LSR.L   #8,D4
00001334  E08C                     623              LSR.L   #8,D4
00001336  6000 001E                624              BRA     .CONT
0000133A                           625  .ENEMY      
0000133A  3639 00003F50            626              MOVE.W  (PLAYPOSX),D3
00001340  3839 00003F52            627              MOVE.W  (PLAYPOSY),D4
00001346  6000 000E                628              BRA     .CONT
0000134A                           629  .DEMOPLAY   
0000134A  3639 00003F54            630              MOVE.W  (ENEMPOSX),D3
00001350  3839 00003F56            631              MOVE.W  (ENEMPOSY),D4 
00001356                           632  .CONT            
00001356  9640                     633              SUB.W   D0,D3
00001358  9841                     634              SUB.W   D1,D4
0000135A                           635              
0000135A  3A04                     636              MOVE.W  D4,D5
0000135C  48C5                     637              EXT.L   D5
0000135E  E28D                     638              LSR.L   #1,D5             ;DIVIDIR POR Y 2
00001360  BA43                     639              CMP.W   D3,D5
00001362  6D00 00C6                640              BLT     .UPRECTEI         ;SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA EMPINADA INFERIOR
00001366                           641              
00001366  3A04                     642              MOVE.W  D4,D5
00001368  E34D                     643              LSL.W   #1,D5             ;MULTIPLICAR POR Y 2
0000136A  4445                     644              NEG.W   D5                ;NEGAMOS Y
0000136C  BA43                     645              CMP.W   D3,D5
0000136E  6D00 005C                646              BLT     .DWRECTSS         ;SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE SUPERIOR
00001372                           647  
00001372  3A04                     648              MOVE.W  D4,D5
00001374  E34D                     649              LSL.W   #1,D5             ;MULTIPLICAR POR Y 2
00001376  BA43                     650              CMP.W   D3,D5
00001378  6D00 002A                651              BLT     .DWRECTSI         ;SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE INFERIOR
0000137C  33FC FFF9 00003F4A       652              MOVE.W  #-BULSPEED,(BULVELX)          ;ZONA 6 
00001384  33FC 0000 00003F48       653              MOVE.W  #0,(BULVELY)
0000138C  33FC FFEC 00003F4E       654              MOVE.W  #-20,(BULPOSORGX)
00001394  33FC 0000 00003F4C       655              MOVE.W  #0,(BULPOSORGY)
0000139C                           656              
0000139C  3C3C 000C                657              MOVE.W  #12,D6
000013A0  6000 0148                658              BRA     .FINAPU  
000013A4                           659  .DWRECTSI            
000013A4  33FC FFFD 00003F4A       660              MOVE.W  #-BULSPEED/2,(BULVELX)          ;ZONA 7
000013AC  33FC FFFD 00003F48       661              MOVE.W  #-BULSPEED/2,(BULVELY)
000013B4  33FC FFEC 00003F4E       662              MOVE.W  #-20,(BULPOSORGX)
000013BC  33FC FFEC 00003F4C       663              MOVE.W  #-20,(BULPOSORGY)
000013C4                           664              
000013C4  3C3C 000E                665              MOVE.W  #14,D6
000013C8  6000 0120                666              BRA     .FINAPU
000013CC                           667              
000013CC                           668  .DWRECTSS            
000013CC  3A04                     669              MOVE.W  D4,D5
000013CE  48C5                     670              EXT.L   D5
000013D0  E28D                     671              LSR.L   #1,D5             ;DIVIDIR Y POR 2
000013D2  4445                     672              NEG.W   D5
000013D4                           673              
000013D4  BA43                     674              CMP.W   D3,D5
000013D6  6D00 002A                675              BLT     .DWRECTES         ; SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE SUPERIOR
000013DA  33FC FFFD 00003F4A       676              MOVE.W  #-BULSPEED/2,(BULVELX)          ;ZONA 5
000013E2  33FC 0003 00003F48       677              MOVE.W  #BULSPEED/2,(BULVELY)
000013EA  33FC FFEC 00003F4E       678              MOVE.W  #-20,(BULPOSORGX)
000013F2  33FC 0014 00003F4C       679              MOVE.W  #20,(BULPOSORGY) 
000013FA                           680              
000013FA  3C3C 000A                681              MOVE.W  #10,D6
000013FE  6000 00EA                682              BRA     .FINAPU  
00001402                           683  .DWRECTES            
00001402  33FC 0007 00003F48       684              MOVE.W  #BULSPEED,(BULVELY)          ;ZONA 4
0000140A  33FC 0000 00003F4A       685              MOVE.W  #0,(BULVELX)
00001412  33FC 0014 00003F4C       686              MOVE.W  #20,(BULPOSORGY)
0000141A  33FC 0000 00003F4E       687              MOVE.W  #0,(BULPOSORGX)
00001422                           688              
00001422  3C3C 0008                689              MOVE.W  #8,D6
00001426  6000 00C2                690              BRA     .FINAPU
0000142A                           691              
0000142A                           692  .UPRECTEI      
0000142A  3A04                     693              MOVE.W  D4,D5
0000142C  E34D                     694              LSL.W   #1,D5             ;MULTIPLICAR POR Y 2
0000142E  4445                     695              NEG.W   D5                 ;NEGAMOS Y
00001430  BA43                     696              CMP.W   D3,D5
00001432  6E00 005C                697              BGT     .UPRECTSS         ;SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE SUPERIOR
00001436                           698  
00001436                           699  
00001436  3A04                     700              MOVE.W  D4,D5
00001438  E34D                     701              LSL.W   #1,D5             ;MULTIPLICAR POR Y 2
0000143A  BA43                     702              CMP.W   D3,D5
0000143C  6D00 002A                703              BLT     .UPRECTSI         ;SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE INFERIOR
00001440  33FC 0003 00003F4A       704              MOVE.W  #BULSPEED/2,(BULVELX)          ;ZONA 3
00001448  33FC 0003 00003F48       705              MOVE.W  #BULSPEED/2,(BULVELY)
00001450  33FC 0014 00003F4E       706              MOVE.W  #20,(BULPOSORGX)
00001458  33FC 0014 00003F4C       707              MOVE.W  #20,(BULPOSORGY)
00001460                           708              
00001460  3C3C 0006                709              MOVE.W  #6,D6
00001464  6000 0084                710              BRA     .FINAPU  
00001468                           711  .UPRECTSI            
00001468  33FC 0007 00003F4A       712              MOVE.W  #BULSPEED,(BULVELX)          ;ZONA 2
00001470  33FC 0000 00003F48       713              MOVE.W  #0,(BULVELY)
00001478  33FC 0014 00003F4E       714              MOVE.W  #20,(BULPOSORGX)
00001480  33FC 0000 00003F4C       715              MOVE.W  #0,(BULPOSORGY)
00001488                           716              
00001488  3C3C 0004                717              MOVE.W  #4,D6
0000148C  6000 005C                718              BRA     .FINAPU
00001490                           719              
00001490                           720  .UPRECTSS            
00001490  3A04                     721              MOVE.W  D4,D5
00001492  48C5                     722              EXT.L   D5
00001494  E28D                     723              LSR.L   #1,D5             ;DIVIDIR Y POR 2
00001496  4445                     724              NEG.W   D5
00001498                           725              
00001498  BA43                     726              CMP.W   D3,D5
0000149A  6D00 002A                727              BLT     .UPRECTES         ; SI X<Y/2, APUNTAMOS POR ENCIMA DE LA RECTA SUAVE SUPERIOR
0000149E  33FC FFF9 00003F48       728              MOVE.W  #-BULSPEED,(BULVELY)          ;ZONA 0
000014A6  33FC 0000 00003F4A       729              MOVE.W  #0,(BULVELX)
000014AE  33FC FFEC 00003F4C       730              MOVE.W  #-20,(BULPOSORGY)
000014B6  33FC 0000 00003F4E       731              MOVE.W  #0,(BULPOSORGX)
000014BE                           732              
000014BE  3C3C 0000                733              MOVE.W  #0,D6
000014C2  6000 0026                734              BRA     .FINAPU  
000014C6                           735  .UPRECTES            
000014C6  33FC 0007 00003F4A       736              MOVE.W  #BULSPEED,(BULVELX)          ;ZONA 1
000014CE  33FC FFFD 00003F48       737              MOVE.W  #-BULSPEED/2,(BULVELY)
000014D6  33FC 0014 00003F4E       738              MOVE.W  #20,(BULPOSORGX)
000014DE  33FC FFEC 00003F4C       739              MOVE.W  #-20,(BULPOSORGY)
000014E6                           740              
000014E6  3C3C 0002                741              MOVE.W  #2,D6
000014EA                           742  .FINAPU  
000014EA  BE7C 0001                743              CMP.W   #1,D7
000014EE  6300 000C                744              BLS     .FINPLY
000014F2  33C6 00003F64            745              MOVE.W  D6,(ENCANPOS)
000014F8  6000 0008                746              BRA     .FINENE
000014FC                           747  .FINPLY            
000014FC  33C6 00003F62            748              MOVE.W  D6,(PLCANPOS)                   
00001502                           749  .FINENE            
00001502  4CDF 00FC                750              MOVEM.L (A7)+,D2-D7
00001506  4E75                     751              RTS
00001508                           752  
00001508                           753  
00001508                           754  
00001508                           755  
00001508                           756  
00001508                           757  
00001508                           758  
00001508                           759  
00001508                           760  
00001508                           761  
00001508                           762  
00001508                           763  
00001508                           764  
00001508                           765  
00001508                           766  
00001508                           767  
00001508                           768  
00001508                           769  
00001508                           770  
00001508                           771  
00001508                           772  -------------------- end include --------------------
00001508                           773          INCLUDE "LIB/AGLCODE.X68"
00001508                           774  ; =============================================================================
00001508                           775  ; AGENT MANAGEMENT
00001508                           776  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001508                           777  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001508                           778  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001508                           779  ; +8:END    : DATA (AGENT SPECIFIC)
00001508                           780  ; =============================================================================
00001508                           781  
00001508                           782  ; -----------------------------------------------------------------------------
00001508                           783  AGLADD
00001508                           784  ; CREATES A NEW AGENT
00001508                           785  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
00001508                           786  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
00001508                           787  ;            A3 - POINTER TO AGENT PLOT FUNCTION
00001508                           788  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM) - MUST NOT BE ZERO
00001508                           789  ;            D1 - AGENT INITIALIZATION PARAMETER 1
00001508                           790  ;            D2 - AGENT INITIALIZATION PARAMETER 2
00001508                           791  ;            D3 - AGENT INITIALIZATION PARAMETER 3
00001508                           792  ; OUTPUT   - NONE
00001508                           793  ; MODIFIES - NONE
00001508                           794  ; -----------------------------------------------------------------------------
00001508  2F08                     795              MOVE.L  A0,-(A7)
0000150A  4EB8 1092                796              JSR     DMMALLOC
0000150E  B1FC 00000000            797              CMP.L   #0,A0
00001514  6700 0008                798              BEQ     .END
00001518  20CA                     799              MOVE.L  A2,(A0)+
0000151A  20CB                     800              MOVE.L  A3,(A0)+
0000151C  4E91                     801              JSR     (A1)
0000151E  205F                     802  .END        MOVE.L  (A7)+,A0
00001520  4E75                     803              RTS
00001522                           804  
00001522                           805  ; -----------------------------------------------------------------------------
00001522                           806  AGLUPD
00001522                           807  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001522                           808  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001522                           809  ; INPUT    - NONE
00001522                           810  ; OUTPUT   - NONE
00001522                           811  ; MODIFIES - NONE
00001522                           812  ; -----------------------------------------------------------------------------
00001522  48E7 00C0                813              MOVEM.L A0-A1,-(A7)
00001526  4EB8 1022                814              JSR     DMMFIRST
0000152A  B1FC 00000000            815  .LOOP       CMP.L   #0,A0
00001530  6700 000E                816              BEQ     .END
00001534  2250                     817              MOVE.L  (A0),A1
00001536  5088                     818              ADD.L   #8,A0
00001538  4E91                     819              JSR     (A1)
0000153A  4EB8 1044                820              JSR     DMMNEXT
0000153E  60EA                     821              BRA     .LOOP
00001540  4CDF 0300                822  .END        MOVEM.L (A7)+,A0-A1
00001544  4E75                     823              RTS
00001546                           824  
00001546                           825  ; -----------------------------------------------------------------------------
00001546                           826  AGLPLOT
00001546                           827  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001546                           828  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001546                           829  ; INPUT    - NONE
00001546                           830  ; OUTPUT   - NONE
00001546                           831  ; MODIFIES - NONE
00001546                           832  ; -----------------------------------------------------------------------------
00001546  48E7 00C0                833              MOVEM.L A0-A1,-(A7)
0000154A  4EB8 1022                834              JSR     DMMFIRST
0000154E  B1FC 00000000            835  .LOOP       CMP.L   #0,A0
00001554  6700 0010                836              BEQ     .END
00001558  2268 0004                837              MOVE.L  4(A0),A1
0000155C  5088                     838              ADD.L   #8,A0
0000155E  4E91                     839              JSR     (A1)
00001560  4EB8 1044                840              JSR     DMMNEXT
00001564  60E8                     841              BRA     .LOOP
00001566  4CDF 0300                842  .END        MOVEM.L (A7)+,A0-A1
0000156A  4E75                     843              RTS
0000156C                           844  
0000156C                           845  ; -----------------------------------------------------------------------------
0000156C  =000010AC                846  AGLKILL     EQU     DMMFREE
0000156C                           847  ; KILLS THE AGENT BY RELEASING ITS MEMORY
0000156C                           848  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
0000156C                           849  ; OUTPUT   - NONE
0000156C                           850  ; MODIFIES - NONE
0000156C                           851  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
0000156C                           852  ; -----------------------------------------------------------------------------
0000156C                           853  -------------------- end include --------------------
0000156C                           854          INCLUDE "LIB/UTLCODE.X68"
0000156C                           855  ; =============================================================================
0000156C                           856  ; UTILITY MACROS
0000156C                           857  ; =============================================================================
0000156C                           858  
0000156C                           859  ; -----------------------------------------------------------------------------
0000156C                           860  UTLSPEN     MACRO
0000156C                           861  ; WRAPPER FOR SET PEN TRAP 15 TASK.
0000156C                           862  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
0000156C                           863  ; OUTPUT   - NONE
0000156C                           864  ; MODIFIES - D0,D1
0000156C                           865  ; -----------------------------------------------------------------------------
0000156C                           866              MOVE.B  #80,D0
0000156C                           867              MOVE.L  \1,D1
0000156C                           868              TRAP    #15
0000156C                           869              ENDM
0000156C                           870  
0000156C                           871  ; -----------------------------------------------------------------------------
0000156C                           872  UTLSFIL     MACRO
0000156C                           873  ; WRAPPER FOR SET FIL TRAP 15 TASK.
0000156C                           874  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
0000156C                           875  ; OUTPUT   - NONE
0000156C                           876  ; MODIFIES - D0,D1
0000156C                           877  ; -----------------------------------------------------------------------------
0000156C                           878              MOVE.B  #81,D0
0000156C                           879              MOVE.L  \1,D1
0000156C                           880              TRAP    #15
0000156C                           881              ENDM
0000156C                           882  
0000156C                           883  
0000156C                           884  ; =============================================================================
0000156C                           885  ; UTILITY CODE
0000156C                           886  ; =============================================================================
0000156C                           887  
0000156C                           888  ; -----------------------------------------------------------------------------
0000156C                           889  UTLINIT
0000156C                           890  ; INITIALIZES UTILITY CODE
0000156C                           891  ; INPUT    - NONE
0000156C                           892  ; OUTPUT   - NONE
0000156C                           893  ; MODIFIES - NONE
0000156C                           894  ; -----------------------------------------------------------------------------
0000156C  48E7 C000                895              MOVEM.L D0-D1,-(A7)
00001570  103C 0008                896              MOVE.B  #8,D0
00001574  4E4F                     897              TRAP    #15
00001576  13C1 00003F68            898              MOVE.B  D1,(UTLRNDIX)
0000157C  4CDF 0003                899              MOVEM.L (A7)+,D0-D1
00001580  4E75                     900              RTS
00001582                           901   
00001582                           902  ; -----------------------------------------------------------------------------
00001582                           903  UTLPRINT
00001582                           904  ; PRINT SCREEN  CENTERED TEXT
00001582                           905  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
00001582                           906  ;            D0.B SCREEN ROW TO PRINT TEXT
00001582                           907  ; OUTPUT   : D0.B NEXT ROW
00001582                           908  ; MODIFIES : NONE (ASIDE OF OUTPUT)
00001582                           909  ; -----------------------------------------------------------------------------
00001582  48E7 C0C0                910              MOVEM.L D0-D1/A0-A1,-(A7)
00001586  4201                     911              CLR.B   D1
00001588  2248                     912              MOVE.L  A0,A1
0000158A  4A18                     913  .LOOP       TST.B   (A0)+
0000158C  6700 0006                914              BEQ     .ENDLOOP
00001590  5201                     915              ADDQ.B  #1,D1
00001592  60F6                     916              BRA     .LOOP
00001594  E209                     917  .ENDLOOP    LSR.B   #1,D1                   ; DIVIDIR D1 ENTRE 2
00001596  0401 0028                918              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
0000159A  4401                     919              NEG.B   D1
0000159C  E141                     920              ASL.W   #8,D1
0000159E  8240                     921              OR.W    D0,D1
000015A0  103C 000B                922              MOVE.B  #11,D0
000015A4  4E4F                     923              TRAP    #15
000015A6  103C 000D                924              MOVE.B  #13,D0
000015AA  4E4F                     925              TRAP    #15          
000015AC  4CDF 0303                926              MOVEM.L (A7)+,D0-D1/A0-A1
000015B0  5200                     927              ADDQ.B  #1,D0
000015B2  4E75                     928              RTS
000015B4                           929    
000015B4                           930  ; -----------------------------------------------------------------------------
000015B4                           931  UTLCHCOL
000015B4                           932  ; CHECKS COLLISION
000015B4                           933  ; INPUT    - D0.W X0 COORDINATE
000015B4                           934  ;            D1.W Y0 COORDINATE
000015B4                           935  ;            D2.W X1 COORDINATE
000015B4                           936  ;            D3.W Y1 COORDINATE
000015B4                           937  ;            D4.W WIDTH 0
000015B4                           938  ;            D5.W WIDTH 1
000015B4                           939  ;            D6.W HEIGHT 0
000015B4                           940  ;            D7.W HEIGHT 1
000015B4                           941  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
000015B4                           942  ; MODIFIES - NONE
000015B4                           943  ; -----------------------------------------------------------------------------
000015B4  48A7 0F00                944              MOVEM.W D4-D7,-(A7)
000015B8  D840                     945              ADD.W   D0,D4
000015BA  B842                     946              CMP.W   D2,D4
000015BC  6F00 0022                947              BLE     .NOCOL
000015C0  DA42                     948              ADD.W   D2,D5
000015C2  BA40                     949              CMP.W   D0,D5
000015C4  6F00 001A                950              BLE     .NOCOL
000015C8  DC41                     951              ADD.W   D1,D6
000015CA  BC43                     952              CMP.W   D3,D6
000015CC  6F00 0012                953              BLE     .NOCOL
000015D0  DE43                     954              ADD.W   D3,D7
000015D2  BE41                     955              CMP.W   D1,D7
000015D4  6F00 000A                956              BLE     .NOCOL
000015D8  103C 00FF                957              MOVE.B  #$FF,D0
000015DC  6000 0004                958              BRA     .END
000015E0  4200                     959  .NOCOL      CLR.B   D0
000015E2  4C9F 00F0                960  .END        MOVEM.W (A7)+,D4-D7
000015E6  4E75                     961              RTS
000015E8                           962              
000015E8                           963  ; -----------------------------------------------------------------------------
000015E8                           964  RELPOS
000015E8                           965  ; PROVIDES THE RELATIVE POSITION
000015E8                           966  ; INPUT    - DO.W : POSITION X OF THE AGENT
000015E8                           967  ;            D1.W : POSITION Y OF THE AGENT
000015E8                           968  ;            A1.L : ADDRESS OF THE MAP 
000015E8                           969  ; OUTPUT   - D0.W : POSITION X OF THE AGENT
000015E8                           970  ;            D1.W : POSITION Y OF THE AGENT
000015E8                           971  ;            D2.W : DISTANCE BETWEEN 0 AND THE BEGINNING OF THE BLOCK WHERE IS THE TANK (X)
000015E8                           972  ;            D3.W : DISTANCE BETWEEN 0 AND THE BEGINNING OF THE BLOCK WHERE IS THE TANK (Y)
000015E8                           973  ;            D4.W : RELATIVE POSITION OF THE TANK IN X
000015E8                           974  ;            D5.W : RELATIVE POSITION OF THE TANK IN Y
000015E8                           975  ;            A1.L : POSITION OF THE TANK AT THE MAP (A1)
000015E8                           976  ; MODIFIES - A1.L
000015E8                           977  ; -----------------------------------------------------------------------------
000015E8                           978  
000015E8  3800                     979              MOVE.W  D0,D4
000015EA  3A01                     980              MOVE.W  D1,D5
000015EC  343C 0000                981              MOVE.W  #0,D2
000015F0  363C 0000                982              MOVE.W  #0,D3
000015F4                           983              
000015F4                           984              ;SACAMOS LA POSICIÓN RELATIVA DE X
000015F4  6000 000C                985              BRA .CHKX
000015F8                           986  .NOORGX
000015F8  0444 0020                987              SUB.W   #PIESIZX,D4
000015FC  5489                     988              ADDQ.L  #2,A1
000015FE  0642 0020                989              ADD.W   #PIESIZX,D2
00001602                           990  .CHKX            
00001602  B87C 0020                991              CMP.W   #PIESIZX,D4
00001606  6EF0                     992              BGT     .NOORGX             
00001608                           993              
00001608                           994              ;SACAMOS LA POSICIÓN RELATIVA DE Y
00001608  6000 0010                995              BRA .CHKY
0000160C                           996  .NOORGY
0000160C  0445 0020                997              SUB.W   #PIESIZY,D5
00001610  D3FC 00000028            998              ADD.L   #40,A1
00001616  0643 0020                999              ADD.W   #PIESIZY,D3
0000161A                          1000  .CHKY            
0000161A  BA7C 0020               1001              CMP.W   #PIESIZX,D5
0000161E  6EEC                    1002              BGT     .NOORGY
00001620                          1003  
00001620  4E75                    1004              RTS
00001622                          1005              
00001622                          1006  ; -----------------------------------------------------------------------------
00001622                          1007  KILLBULS
00001622                          1008  ; SUBRUTINA QUE DESTRUYE TODAS LAS BALAS QUE EXISTAN 
00001622                          1009  ; EN LA PILA DE AGENTES
00001622                          1010  ; INPUT    - NONE
00001622                          1011  ; OUTPUT   - NONE
00001622                          1012  ; MODIFIES - NONE
00001622                          1013  ; -----------------------------------------------------------------------------
00001622  48E7 8000               1014              MOVEM.L D0,-(A7)
00001626                          1015              
00001626  303C 0001               1016              MOVE.W  #BULTYPE,D0 
0000162A  4EB8 105A               1017              JSR     DMMFRSTO
0000162E                          1018  .BULLOOP            
0000162E  B1FC 00000000           1019              CMP.L   #0,A0
00001634  6700 001A               1020              BEQ     .NOBULS
00001638  4EB8 10AC               1021              JSR     AGLKILL
0000163C  4EB8 107C               1022              JSR     DMMNEXTO
00001640  60EC                    1023              BRA     .BULLOOP
00001642                          1024              ; DEVOLVERLE LAS BALAS AL JUGADOR
00001642  303C 0002               1025              MOVE.W  #TANPLAY,D0 
00001646  4EB8 105A               1026              JSR     DMMFRSTO
0000164A  317C 0003 0012          1027              MOVE.W  #PLMAXBUL,18(A0)
00001650                          1028  .NOBULS            
00001650  4CDF 0001               1029              MOVEM.L (A7)+,D0
00001654  4E75                    1030              RTS
00001656                          1031              
00001656                          1032  ; -----------------------------------------------------------------------------
00001656                          1033  PLIMASEL
00001656                          1034  ; SELECCIONA LA POSICIÓN DEL TANQUE Y DEL CAÑÓN PARA 
00001656                          1035  ; DIBUJAR AL JUGADOR
00001656                          1036  ; INPUT    - NONE
00001656                          1037  ; OUTPUT   - NONE
00001656                          1038  ; MODIFIES - A1
00001656                          1039  ; -----------------------------------------------------------------------------
00001656  48E7 FF00               1040              MOVEM.L D0-D7,-(A7)
0000165A  0C79 0008 00003F62      1041              CMP.W   #8,(PLCANPOS)
00001662  6500 0096               1042              BLO     .LOW1     
00001666  0C79 000C 00003F62      1043              CMP.W   #12,(PLCANPOS)
0000166E  6500 0046               1044              BLO     .LOW2
00001672  0C79 000E 00003F62      1045              CMP.W   #14,(PLCANPOS)
0000167A  6500 001A               1046              BLO     .LOW3
0000167E  6600 000C               1047              BNE     .QUINCE
00001682  43F9 001BC666           1048              LEA     DATPLYNW,A1
00001688  6000 0100               1049              BRA     .ENDDECOD
0000168C                          1050  .QUINCE
0000168C  43F9 001B4966           1051              LEA     DATPLXNW,A1
00001692  6000 00F6               1052              BRA     .ENDDECOD
00001696                          1053  .LOW3
00001696  0C79 000C 00003F62      1054              CMP.W   #12,(PLCANPOS)
0000169E  6600 000C               1055              BNE     .TRECE
000016A2  43F9 001C04E6           1056              LEA     DATPLYW,A1
000016A8  6000 00E0               1057              BRA     .ENDDECOD
000016AC                          1058  .TRECE
000016AC  43F9 001B4966           1059              LEA     DATPLXNW,A1
000016B2  6000 00D6               1060              BRA     .ENDDECOD
000016B6                          1061  .LOW2
000016B6  0C79 000A 00003F62      1062              CMP.W   #10,(PLCANPOS)
000016BE  6500 001A               1063              BLO     .LOW31
000016C2  6600 000C               1064              BNE     .ONCE
000016C6  43F9 001BF546           1065              LEA     DATPLYSW,A1
000016CC  6000 00BC               1066              BRA     .ENDDECOD
000016D0                          1067  .ONCE
000016D0  43F9 001B4966           1068              LEA     DATPLXNW,A1
000016D6  6000 00B2               1069              BRA     .ENDDECOD
000016DA                          1070  .LOW31
000016DA  0C79 0008 00003F62      1071              CMP.W   #8,(PLCANPOS)
000016E2  6600 000C               1072              BNE     .NUEVE
000016E6  43F9 001BD606           1073              LEA     DATPLYS,A1
000016EC  6000 009C               1074              BRA     .ENDDECOD
000016F0                          1075  .NUEVE
000016F0  43F9 001B5906           1076              LEA     DATPLXS,A1
000016F6  6000 0092               1077              BRA     .ENDDECOD
000016FA                          1078  
000016FA                          1079  
000016FA                          1080              
000016FA                          1081  .LOW1
000016FA  0C79 0004 00003F62      1082              CMP.W   #4,(PLCANPOS)
00001702  6500 0046               1083              BLO     .LOW211
00001706  0C79 0006 00003F62      1084              CMP.W   #6,(PLCANPOS)
0000170E  6500 001A               1085              BLO     .LOW311
00001712  6600 000C               1086              BNE     .SIETE
00001716  43F9 001BE5A6           1087              LEA     DATPLYSE,A1
0000171C  6000 006C               1088              BRA     .ENDDECOD
00001720                          1089  .SIETE
00001720  43F9 001B68A6           1090              LEA     DATPLXSE,A1
00001726  6000 0062               1091              BRA     .ENDDECOD
0000172A                          1092  .LOW311
0000172A  0C79 0004 00003F62      1093              CMP.W   #4,(PLCANPOS)
00001732  6600 000C               1094              BNE     .CINCO
00001736  43F9 001B9786           1095              LEA     DATPLYE,A1
0000173C  6000 004C               1096              BRA     .ENDDECOD
00001740                          1097  .CINCO
00001740  43F9 001B1A86           1098              LEA     DATPLXE,A1
00001746  6000 0042               1099              BRA     .ENDDECOD
0000174A                          1100  .LOW211
0000174A  0C79 0002 00003F62      1101              CMP.W   #2,(PLCANPOS)
00001752  6500 001A               1102              BLO     .LOW321
00001756  6600 000C               1103              BNE     .TRES
0000175A  43F9 001BB6C6           1104              LEA     DATPLYNE,A1
00001760  6000 0028               1105              BRA     .ENDDECOD
00001764                          1106  .TRES
00001764  43F9 001B4966           1107              LEA     DATPLXNW,A1
0000176A  6000 001E               1108              BRA     .ENDDECOD
0000176E                          1109  .LOW321
0000176E  0C79 0000 00003F62      1110              CMP.W   #0,(PLCANPOS)
00001776  6600 000C               1111              BNE     .UNO
0000177A  43F9 001BA726           1112              LEA     DATPLYN,A1
00001780  6000 0008               1113              BRA     .ENDDECOD
00001784                          1114  .UNO
00001784  43F9 001B2A26           1115              LEA     DATPLXN,A1
0000178A                          1116  .ENDDECOD           
0000178A  4CDF 00FF               1117              MOVEM.L (A7)+,D0-D7
0000178E  4E75                    1118              RTS
00001790                          1119              
00001790                          1120  ; -----------------------------------------------------------------------------
00001790                          1121  ENIMASEL
00001790                          1122  ; SELECCIONA LA POSICIÓN DEL TANQUE Y DEL CAÑÓN PARA 
00001790                          1123  ; DIBUJAR AL ENEMIGO
00001790                          1124  ; INPUT    - NONE
00001790                          1125  ; OUTPUT   - NONE
00001790                          1126  ; MODIFIES - A1
00001790                          1127  ; -----------------------------------------------------------------------------
00001790                          1128  
00001790  48E7 FF00               1129              MOVEM.L D0-D7,-(A7)
00001794  0C79 0008 00003F64      1130              CMP.W   #8,(ENCANPOS)
0000179C  6500 0096               1131              BLO     .ELOW1     
000017A0  0C79 000C 00003F64      1132              CMP.W   #12,(ENCANPOS)
000017A8  6500 0046               1133              BLO     .ELOW2
000017AC  0C79 000E 00003F64      1134              CMP.W   #14,(ENCANPOS)
000017B4  6500 001A               1135              BLO     .ELOW3
000017B8  6600 000C               1136              BNE     .EQUINCE
000017BC  43F9 001CC066           1137              LEA     DATENYNW,A1
000017C2  6000 0100               1138              BRA     .EENDDCOD
000017C6                          1139  .EQUINCE
000017C6  43F9 001C4366           1140              LEA     DATENXNW,A1
000017CC  6000 00F6               1141              BRA     .EENDDCOD
000017D0                          1142  .ELOW3
000017D0  0C79 000C 00003F64      1143              CMP.W   #12,(ENCANPOS)
000017D8  6600 000C               1144              BNE     .ETRECE
000017DC  43F9 001CFEE6           1145              LEA     DATENYW,A1
000017E2  6000 00E0               1146              BRA     .EENDDCOD
000017E6                          1147  .ETRECE
000017E6  43F9 001C4366           1148              LEA     DATENXNW,A1
000017EC  6000 00D6               1149              BRA     .EENDDCOD
000017F0                          1150  .ELOW2
000017F0  0C79 000A 00003F64      1151              CMP.W   #10,(ENCANPOS)
000017F8  6500 001A               1152              BLO     .ELOW31
000017FC  6600 000C               1153              BNE     .EONCE
00001800  43F9 001CEF46           1154              LEA     DATENYSW,A1
00001806  6000 00BC               1155              BRA     .EENDDCOD
0000180A                          1156  .EONCE
0000180A  43F9 001C4366           1157              LEA     DATENXNW,A1
00001810  6000 00B2               1158              BRA     .EENDDCOD
00001814                          1159  .ELOW31
00001814  0C79 0008 00003F64      1160              CMP.W   #8,(ENCANPOS)
0000181C  6600 000C               1161              BNE     .ENUEVE
00001820  43F9 001CD006           1162              LEA     DATENYS,A1
00001826  6000 009C               1163              BRA     .EENDDCOD
0000182A                          1164  .ENUEVE
0000182A  43F9 001C5306           1165              LEA     DATENXS,A1
00001830  6000 0092               1166              BRA     .EENDDCOD
00001834                          1167  .ELOW1
00001834  0C79 0004 00003F64      1168              CMP.W   #4,(ENCANPOS)
0000183C  6500 0046               1169              BLO     .ELOW211
00001840  0C79 0006 00003F64      1170              CMP.W   #6,(ENCANPOS)
00001848  6500 001A               1171              BLO     .ELOW311
0000184C  6600 000C               1172              BNE     .ESIETE
00001850  43F9 001CDFA6           1173              LEA     DATENYSE,A1
00001856  6000 006C               1174              BRA     .EENDDCOD
0000185A                          1175  .ESIETE
0000185A  43F9 001C62A6           1176              LEA     DATENXSE,A1
00001860  6000 0062               1177              BRA     .EENDDCOD
00001864                          1178  .ELOW311
00001864  0C79 0004 00003F64      1179              CMP.W   #4,(ENCANPOS)
0000186C  6600 000C               1180              BNE     .ECINCO
00001870  43F9 001C9186           1181              LEA     DATENYE,A1
00001876  6000 004C               1182              BRA     .EENDDCOD
0000187A                          1183  .ECINCO
0000187A  43F9 001C1486           1184              LEA     DATENXE,A1
00001880  6000 0042               1185              BRA     .EENDDCOD
00001884                          1186  .ELOW211
00001884  0C79 0002 00003F64      1187              CMP.W   #2,(ENCANPOS)
0000188C  6500 001A               1188              BLO     .ELOW321
00001890  6600 000C               1189              BNE     .ETRES
00001894  43F9 001CB0C6           1190              LEA     DATENYNE,A1
0000189A  6000 0028               1191              BRA     .EENDDCOD
0000189E                          1192  .ETRES
0000189E  43F9 001C4366           1193              LEA     DATENXNW,A1
000018A4  6000 001E               1194              BRA     .EENDDCOD
000018A8                          1195  .ELOW321
000018A8  0C79 0000 00003F64      1196              CMP.W   #0,(ENCANPOS)
000018B0  6600 000C               1197              BNE     .EUNO
000018B4  43F9 001CA126           1198              LEA     DATENYN,A1
000018BA  6000 0008               1199              BRA     .EENDDCOD
000018BE                          1200  .EUNO
000018BE  43F9 001C2426           1201              LEA     DATENXN,A1
000018C4                          1202  .EENDDCOD           
000018C4  4CDF 00FF               1203              MOVEM.L (A7)+,D0-D7
000018C8  4E75                    1204              RTS
000018CA                          1205              
000018CA                          1206  ; ----------------------------------------------------------
000018CA                          1207  IMAPLOT
000018CA                          1208  ; DIBUJA UNA IMAGEN
000018CA                          1209  ; INPUT     : A2: (A2)  CONTIENE LA DIMENSIÓN X DE LA IMAGEN (LA MITAD)
000018CA                          1210  ;           :     2(A2) CONTIENE LA DIMENSIÓN Y DE LA IMAGEN (LA MITAD)
000018CA                          1211  ;           : A0: DIRECCIÓN DE LA IMAGEN
000018CA                          1212  ; OUTPUT    : NONE
000018CA                          1213  ; MODIFIES  : NONE
000018CA                          1214  ; ----------------------------------------------------------            
000018CA                          1215              
000018CA  48E7 FEE0               1216              MOVEM.L D0-D6/A0-A2,-(A7)
000018CE                          1217              
000018CE  323C 0140               1218              MOVE.W  #SCRWIDTH/2,D1
000018D2  343C 00F0               1219              MOVE.W  #SCRHEIGH/2,D2
000018D6  9252                    1220              SUB.W   (A2),D1          ; PARA CENTRAR LA IMAGEN EN LA PANTALLA
000018D8  946A 0002               1221              SUB.W   2(A2),D2
000018DC  3601                    1222              MOVE.W  D1,D3
000018DE  3802                    1223              MOVE.W  D2,D4
000018E0  5243                    1224              ADDQ.W  #1,D3
000018E2  5244                    1225              ADDQ.W  #1,D4
000018E4                          1226  .FILA
000018E4  323C 0140               1227              MOVE.W  #SCRWIDTH/2,D1
000018E8  9252                    1228              SUB.W   (A2),D1
000018EA  3601                    1229              MOVE.W  D1,D3
000018EC                          1230              
000018EC  5242                    1231              ADDQ.W  #1,D2
000018EE  5244                    1232              ADDQ.W  #1,D4
000018F0                          1233  .COLUMNA
000018F0                          1234  
000018F0  2A01                    1235              MOVE.L  D1,D5
000018F2  2218                    1236              MOVE.L  (A0)+,D1
000018F4  103C 0050               1237              MOVE.B  #80,D0
000018F8  4E4F                    1238              TRAP    #15
000018FA  2205                    1239              MOVE.L  D5,D1
000018FC                          1240  
000018FC  5241                    1241              ADDQ.W  #1,D1
000018FE  5243                    1242              ADDQ.W  #1,D3
00001900                          1243  
00001900  103C 0054               1244              MOVE.B  #84,D0
00001904  4E4F                    1245              TRAP    #15
00001906                          1246              
00001906  3C3C 0140               1247              MOVE.W  #SCRWIDTH/2,D6
0000190A  DC52                    1248              ADD.W   (A2),D6
0000190C  B646                    1249              CMP.W   D6,D3
0000190E  6DE0                    1250              BLT     .COLUMNA
00001910                          1251              
00001910  3C3C 00F0               1252              MOVE.W  #SCRHEIGH/2,D6
00001914  DC6A 0002               1253              ADD.W   2(A2),D6
00001918  B846                    1254              CMP.W   D6,D4
0000191A  6DC8                    1255              BLT     .FILA
0000191C                          1256              
0000191C  4CDF 077F               1257              MOVEM.L (A7)+,D0-D6/A0-A2
00001920                          1258              
00001920  4E75                    1259              RTS
00001922                          1260              
00001922                          1261  ; ----------------------------------------------------------
00001922                          1262  TANKCOL
00001922                          1263  ; COLOCA EN A3 EL NÚMERO DE COLISIONES QUE TENDRÁ EL TANQUE EN EL SIGUIENTE MOVIMIENTO
00001922                          1264  ; INPUT     : D0: POSICIÓN X DEL TANQUE
00001922                          1265  ;             D1: POSICION Y DEL TANQUE 
00001922                          1266  ; OUTPUT    : A3: NÚMERO DE COLISIONES DEL TANQUE
00001922                          1267  ; MODIFIES  : POSXTEMP
00001922                          1268  ;             POSYTMP
00001922                          1269  ; ----------------------------------------------------------
00001922  48E7 FFC0               1270              MOVEM.L A0-A1/D0-D7,-(A7)
00001926  33FC 0000 00003F60      1271              MOVE.W  #0,(COLTANKP)
0000192E  367C 0000               1272              MOVE.W  #0,A3
00001932  33C0 00003F58           1273              MOVE.W  D0,(POSXTEMP)
00001938  33C1 00003F5A           1274              MOVE.W  D1,(POSYTEMP)
0000193E  3410                    1275              MOVE.W  (A0),D2                 ; PREPARE SHOT COORDINATES FOR
00001940  3628 0002               1276              MOVE.W  2(A0),D3                ; COLLISION CHECK
00001944  3A3C 0008               1277              MOVE.W  #TANWIDTH/2,D5
00001948  3E3C 0008               1278              MOVE.W  #TANHEIGH/2,D7
0000194C  2248                    1279              MOVE.L  A0,A1
0000194E  303C 0003               1280              MOVE.W  #TANENEM,D0
00001952  4EB8 105A               1281              JSR     DMMFRSTO
00001956  B1FC 00000000           1282  .LOOP       CMP.L   #0,A0
0000195C  6700 002C               1283              BEQ     .CHKPLAY
00001960  3028 0008               1284              MOVE.W  8(A0),D0
00001964  3228 000A               1285              MOVE.W  10(A0),D1
00001968  5140                    1286              SUB.W   #TANWIDTH/2,D0
0000196A  5141                    1287              SUB.W   #TANHEIGH/2,D1
0000196C  383C 0010               1288              MOVE.W  #TANWIDTH,D4
00001970  3C3C 0010               1289              MOVE.W  #TANHEIGH,D6
00001974  4EB8 15B4               1290              JSR     UTLCHCOL
00001978  4A00                    1291              TST.B   D0
0000197A  6700 0004               1292              BEQ     .NTHG
0000197E  524B                    1293              ADDQ.W  #1,A3
00001980                          1294  .NTHG
00001980  303C 0003               1295              MOVE.W  #TANENEM,D0
00001984  4EB8 107C               1296              JSR     DMMNEXTO
00001988  60CC                    1297              BRA     .LOOP
0000198A                          1298  .CHKPLAY    ; PLAYER TANK COLLISIONS
0000198A  303C 0002               1299              MOVE.W  #TANPLAY,D0
0000198E  4EB8 105A               1300              JSR     DMMFRSTO
00001992  B1FC 00000000           1301              CMP.L   #0,A0
00001998  6700 002A               1302              BEQ     .NTHG1
0000199C  3028 0008               1303              MOVE.W  8(A0),D0
000019A0  3228 000A               1304              MOVE.W  10(A0),D1
000019A4  5140                    1305              SUB.W   #TANWIDTH/2,D0
000019A6  5141                    1306              SUB.W   #TANHEIGH/2,D1
000019A8  383C 0010               1307              MOVE.W  #TANWIDTH,D4
000019AC  3C3C 0010               1308              MOVE.W  #TANHEIGH,D6
000019B0  4EB8 15B4               1309              JSR     UTLCHCOL
000019B4  4A00                    1310              TST.B   D0
000019B6  6700 000C               1311              BEQ     .NTHG1
000019BA  33FC 0001 00003F60      1312              MOVE.W  #1,(COLTANKP)
000019C2  524B                    1313              ADDQ.W  #1,A3
000019C4                          1314  .NTHG1
000019C4  4CDF 03FF               1315              MOVEM.L (A7)+,A0-A1/D0-D7
000019C8  4E75                    1316              RTS
000019CA                          1317  
000019CA                          1318  
000019CA                          1319  ; -----------------------------------------------------------------------------
000019CA                          1320  COLBYKMKZ
000019CA                          1321  ; LE QUITA AL JUGADOR LA VIDA POR COLISIÓN DE KAMIKAZE
000019CA                          1322  ; INPUT    - NONE
000019CA                          1323  ; OUTPUT   - NONE
000019CA                          1324  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000019CA                          1325  ; -----------------------------------------------------------------------------
000019CA                          1326  
000019CA  48E7 FFC0               1327              MOVEM.L D0-D7/A0-A1,-(A7)
000019CE  303C 0002               1328              MOVE.W  #TANPLAY,D0
000019D2  4EB8 105A               1329              JSR     DMMFRSTO
000019D6  B1FC 00000000           1330              CMP.L   #0,A0
000019DC  6700 001A               1331              BEQ     .NTHG1
000019E0  0468 0078 0010          1332              SUB.W   #3*BULDMG,16(A0)
000019E6  0C68 0000 0010          1333              CMP.W   #0,16(A0)
000019EC  6E00 000A               1334              BGT     .NTHG1
000019F0  33FC 0001 00003F44      1335              MOVE.W  #KILLPLYR,(PLYRDEAD)
000019F8                          1336  .NTHG1            
000019F8  4CDF 03FF               1337              MOVEM.L (A7)+,A0-A1/D0-D7
000019FC  4E75                    1338              RTS
000019FE                          1339  
000019FE                          1340  ; -----------------------------------------------------------------------------
000019FE                          1341  UTLRAND
000019FE                          1342  ; PROVIDES A PSEUDO-RANDOM BYTE
000019FE                          1343  ; INPUT    - NONE
000019FE                          1344  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000019FE                          1345  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000019FE                          1346  ; -----------------------------------------------------------------------------
000019FE  2F08                    1347              MOVE.L  A0,-(A7)
00001A00  41F9 00001A1C           1348              LEA     .RANDVEC,A0
00001A06  4280                    1349              CLR.L   D0
00001A08  1039 00003F68           1350              MOVE.B  (UTLRNDIX),D0
00001A0E  1030 0800               1351              MOVE.B  (A0,D0.L),D0
00001A12  5239 00003F68           1352              ADDQ.B  #1,(UTLRNDIX)
00001A18  205F                    1353              MOVE.L  (A7)+,A0
00001A1A  4E75                    1354              RTS
00001A1C                          1355  
00001A1C                          1356  
00001A1C= A2 EE 9A 0C F5 24 ...   1357  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001A24= 2A A3 51 26 E0 AC ...   1358              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
00001A2C= 75 51 CA FD 33 EB ...   1359              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001A34= 60 CC E7 B8 9A EB ...   1360              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
00001A3C= 1D 76 B5 95 B0 89 ...   1361              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001A44= 39 15 48 C9 6E CA ...   1362              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001A4C= 43 E7 E2 7C 37 25 ...   1363              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001A54= E9 94 CE E9 E4 52 ...   1364              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001A5C= 37 6D 9A 84 A2 28 ...   1365              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001A64= 19 E2 C6 77 80 D4 ...   1366              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001A6C= 0A 5A 32 67 33 C2 ...   1367              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001A74= 59 80 DC 0E 57 FC ...   1368              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001A7C= 8A AB BC F7 07 4D ...   1369              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001A84= EF D5 77 6E 1E BB ...   1370              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001A8C= D6 E0 2A 8F BD 28 ...   1371              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001A94= 13 4F 66 EC 0A 64 ...   1372              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001A9C= 56 52 9A 16 9B 90 ...   1373              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001AA4= 06 8A A4 F7 01 DA ...   1374              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001AAC= F2 E7 77 28 B1 76 ...   1375              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001AB4= A4 42 E3 81 B1 67 ...   1376              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001ABC= BF CE FA 16 BF 38 ...   1377              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001AC4= D1 8B 50 0C 5F 49 ...   1378              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001ACC= DE 4C 14 A2 40 DC ...   1379              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001AD4= B6 9B 0A 38 5D AB ...   1380              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001ADC= E2 1B DD 75 15 82 ...   1381              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001AE4= 8A 26 51 30 9F 47 ...   1382              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001AEC= 1E 8A BB 71 C6 6E ...   1383              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001AF4= 9F 47 E5 34 94 27 ...   1384              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001AFC= 7D 06 D6 BA 30 0F ...   1385              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001B04= EC 7F 7E 03 CF 2D ...   1386              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
00001B0C= 94 5B 23 F2 8B CD ...   1387              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001B14= 74 33 EC B9 0F D5 ...   1388              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
00001B1C                          1389              
00001B1C                          1390  
00001B1C                          1391  
00001B1C                          1392  
00001B1C                          1393  
00001B1C                          1394  
00001B1C                          1395  
00001B1C                          1396  
00001B1C                          1397  
00001B1C                          1398  
00001B1C                          1399  
00001B1C                          1400  
00001B1C                          1401  
00001B1C                          1402  
00001B1C                          1403  
00001B1C                          1404  
00001B1C                          1405  -------------------- end include --------------------
00001B1C                          1406          INCLUDE "LIB/FILELOAD.X68"
00001B1C                          1407  
00001B1C                          1408  ; ------------------------------------------------------------------------------
00001B1C                          1409  FILLOAD
00001B1C                          1410  ; LOADS AN FILE FROM DISK TO MEMORY
00001B1C                          1411  ; INPUT    : A0 - DESTINATION ADDR. WITH ENOUGH SPACE AVAILABLE.
00001B1C                          1412  ;            A1 - POINTER TO FILE NAME
00001B1C                          1413  ; OUTPUT   : NONE
00001B1C                          1414  ; MODIFIES : NONE
00001B1C                          1415  ; NOTE     : THE READ DATA LOOP READS 1 BYTE AT A TIME TO ENSURE ALL FILES CAN
00001B1C                          1416  ;            BE LOADED. HOWEVER, IF THE FILE SIZE IS KNOWN BEFOREHAND, NO LOOP
00001B1C                          1417  ;            WOULD BE NECESSARY AND A SINGLE CALL TO TRAP #15 TASK 53 WOULD READ
00001B1C                          1418  ;            THE WHOLE FILE AS LONG AS THE FILE SIZE IS PLACED INTO D2.L.
00001B1C                          1419  ; NOTE     : THE ZERO-TERMINATOR (JUST BEFORE CLOSE THE FILE) IS A REQUIREMENT
00001B1C                          1420  ;            FOR TEXT-FILES IF THE TEXT IS TO BE PRINTED. FOR OTHER USES, IT
00001B1C                          1421  ;            CAN BE REMOVED.
00001B1C                          1422  ; ------------------------------------------------------------------------------
00001B1C  48E7 E040               1423              MOVEM.L D0-D2/A1,-(A7)          ; SAVE REGISTERS
00001B20                          1424              ; CLOSE ALL FILES
00001B20  103C 0032               1425              MOVE.B  #50,D0
00001B24  4E4F                    1426              TRAP    #15
00001B26                          1427              ; OPEN FILE (ASSUMES A1 POINTS TO FILENAME)
00001B26  103C 0033               1428              MOVE.B  #51,D0
00001B2A  4E4F                    1429              TRAP    #15                     ; D1.L:=FILE HANDLER
00001B2C                          1430              ; READ DATA
00001B2C  2248                    1431              MOVE.L  A0,A1                   ; A1 MUST BE THE BUFFER ADDRESS
00001B2E  103C 0035               1432  .LOOP       MOVE.B  #53,D0                  ; READ DATA TASK
00001B32  7401                    1433              MOVE.L  #1,D2                   ; BYTES TO READ (ONE BY ONE)
00001B34  4E4F                    1434              TRAP    #15
00001B36  D3C2                    1435              ADD.L   D2,A1                   ; ADVANCE POINTER
00001B38  4A00                    1436              TST.B   D0                      ; END OF FILE OR ERROR?
00001B3A  67F2                    1437              BEQ     .LOOP                   ; NO: READ MORE
00001B3C  4211                    1438              CLR.B   (A1)                    ; PUT A ZERO-TERMINATOR.
00001B3E                          1439              ; CLOSE THE FILE
00001B3E  103C 0038               1440              MOVE.B  #56,D0
00001B42  4E4F                    1441              TRAP    #15
00001B44  4CDF 0207               1442              MOVEM.L (A7)+,D0-D2/A1          ; RESTORE REGISTERS
00001B48  4E75                    1443              RTS
00001B4A                          1444  
00001B4A                          1445  
00001B4A                          1446  -------------------- end include --------------------
00001B4A                          1447          INCLUDE "BULLET.X68"
00001B4A                          1448  
00001B4A                          1449  ; ----------------------------------------------------------
00001B4A                          1450  BULINIT
00001B4A                          1451  ; INICIALIZAR BALA
00001B4A                          1452  ; INPUT     : PUNTERO DE A0 A LAS VARIABLES DE INSTANCIA
00001B4A                          1453  ; OUTPUT    : NONE
00001B4A                          1454  ; MODIFIES  : NONE
00001B4A                          1455  ; ----------------------------------------------------------
00001B4A                          1456              
00001B4A                          1457              ; AJUSTAR POSICIÓN INICIAL PARA QUE NO APAREZCA SOBRE EL TANQUE
00001B4A  D279 00003F4E           1458              ADD.W   (BULPOSORGX),D1
00001B50  D479 00003F4C           1459              ADD.W   (BULPOSORGY),D2
00001B56                          1460  
00001B56  48A7 FC00               1461              MOVEM.W D0-D5,-(A7)
00001B5A                          1462              
00001B5A                          1463              ; CALCULAR LA POSICIÓN RELATIVA
00001B5A  3001                    1464              MOVE.W  D1,D0
00001B5C  3202                    1465              MOVE.W  D2,D1
00001B5E  43F9 00002554           1466              LEA.L   MAPDATA,A1
00001B64  4EB8 15E8               1467              JSR     RELPOS
00001B68  3401                    1468              MOVE.W  D1,D2
00001B6A  3200                    1469              MOVE.W  D0,D1
00001B6C                          1470              
00001B6C                          1471              ; ESTABLECER LA POSICIÓN INICIAL DE LA BALA
00001B6C  3081                    1472              MOVE.W  D1,(A0) 
00001B6E  3142 0002               1473              MOVE.W  D2,2(A0)
00001B72                          1474              
00001B72  4C9F 003F               1475              MOVEM.W (A7)+,D0-D5
00001B76                          1476              
00001B76                          1477              ; GUARDAR EL ID DEL PADRE DE LA BALA
00001B76  3143 0008               1478              MOVE.W  D3,8(A0)
00001B7A                          1479              
00001B7A  0C51 0001               1480              CMP.W   #$01,(A1)   ; COMPROBAR ESTADO DEL MAPA
00001B7E  6600 002A               1481              BNE     .SEGBULL
00001B82                          1482              ; LA BALA HA HECHO SPAWN ENCIMA DE UN BLOQUE
00001B82  48A7 0C00               1483              MOVEM.W D4-D5,-(A7)
00001B86                          1484              
00001B86  0C68 0000 0008          1485              CMP.W   #0,8(A0)    ; COMPROBAR SI EL PADRE DE LA BALA ES EL JUGADOR
00001B8C  6600 0012               1486              BNE     .NOTPLAYER
00001B90                          1487              
00001B90                          1488              ; EL JUGADOR ES EL PADRE DE LA BALA
00001B90  2248                    1489              MOVE.L  A0,A1
00001B92                          1490              
00001B92  303C 0002               1491              MOVE.W  #TANPLAY,D0
00001B96  4EB8 105A               1492              JSR     DMMFRSTO
00001B9A  5268 0012               1493              ADDQ.W  #1,18(A0)   ; AGREGARLE UNA BALA DISPONIBLE AL JUGADOR
00001B9E  2049                    1494              MOVE.L  A1,A0            
00001BA0                          1495  .NOTPLAYER
00001BA0  4EB8 10AC               1496              JSR     AGLKILL     ; DESTRUIR BALA
00001BA4  4C9F 0030               1497              MOVEM.W (A7)+,D4-D5
00001BA8  4E75                    1498              RTS
00001BAA                          1499               
00001BAA                          1500  .SEGBULL    ; LA BALA HA HECHO SPAWN CORRECTAMENTE                
00001BAA  317C 0003 000A          1501              MOVE.W  #MAXTOUCH,10(A0)    ; TOQUES DE LA BALA DISPONIBLES CON LAS PAREDES EMPIEZAN SIENDO EL MÁXIMO
00001BB0  3179 00003F4A 0004      1502              MOVE.W  (BULVELX),4(A0)
00001BB8  3179 00003F48 0006      1503              MOVE.W  (BULVELY),6(A0)
00001BC0  4E75                    1504              RTS
00001BC2                          1505              
00001BC2                          1506  ; ----------------------------------------------------------
00001BC2                          1507  BULUPD
00001BC2                          1508  ; ACTUALIZA LA BALA
00001BC2                          1509  ; INPUT     : PUNTERO DE A0 A LAS VARIABLES DE INSTANCIA
00001BC2                          1510  ; OUTPUT    : NONE
00001BC2                          1511  ; MODIFIES  : NONE
00001BC2                          1512  ; ----------------------------------------------------------
00001BC2                          1513              
00001BC2  48A7 F800               1514              MOVEM.W D0-D4,-(A7)            
00001BC6                          1515  
00001BC6                          1516              ; UPDATE BALL COORDINATES
00001BC6  3010                    1517              MOVE.W  (A0),D0
00001BC8  3228 0002               1518              MOVE.W  2(A0),D1
00001BCC  D068 0004               1519              ADD.W   4(A0),D0
00001BD0  D268 0006               1520              ADD.W   6(A0),D1
00001BD4                          1521              
00001BD4                          1522              ;INICIALIZAMOS
00001BD4  43F9 00002554           1523              LEA.L   MAPDATA,A1
00001BDA  3C39 00003F3A           1524              MOVE.W  (LVLNUM),D6
00001BE0  CCFC 0258               1525              MULU.W  #SIZLVL,D6
00001BE4  D3C6                    1526              ADD.L   D6,A1
00001BE6  4EB8 15E8               1527              JSR     RELPOS
00001BEA                          1528              
00001BEA  0C51 0001               1529              CMP.W   #01,(A1)
00001BEE  6600 00C8               1530              BNE .CHKTAN
00001BF2                          1531              
00001BF2  B87C 000A               1532              CMP.W   #PIESIZX/3,D4
00001BF6  6500 000E               1533              BLO     .COLX
00001BFA  B87C 0015               1534              CMP.W   #2*PIESIZX/3,D4  
00001BFE  6200 0006               1535              BHI     .COLX
00001C02  6000 000A               1536              BRA     .SVPNT
00001C06                          1537  .COLX
00001C06  343C 00FF               1538              MOVE.W  #$FF,D2
00001C0A  4468 0004               1539              NEG.W   4(A0)
00001C0E                          1540  .SVPNT            
00001C0E  BA7C 000A               1541              CMP.W   #PIESIZY/3,D5
00001C12  6500 000E               1542              BLO     .COLY
00001C16  BA7C 0015               1543              CMP.W   #2*PIESIZY/3,D5  
00001C1A  6200 0006               1544              BHI     .COLY
00001C1E  6000 000A               1545              BRA     .SVPNT2
00001C22                          1546  .COLY
00001C22  4468 0006               1547              NEG.W   6(A0)
00001C26  363C 00FF               1548              MOVE.W  #$FF,D3     
00001C2A                          1549  .SVPNT2           
00001C2A                          1550  
00001C2A  B47C 00FF               1551              CMP.W   #$FF,D2
00001C2E  6700 001C               1552              BEQ     .TRATCOL
00001C32                          1553  .TRATCOLU
00001C32  5368 000A               1554              SUBQ.W  #1,10(A0)
00001C36  0C68 0000 000A          1555              CMP.W   #0,10(A0)
00001C3C  6600 0074               1556              BNE     .BULWALL
00001C40  3628 0008               1557              MOVE.W  8(A0),D3
00001C44  4EB8 10AC               1558              JSR     AGLKILL
00001C48  6000 0024               1559              BRA     .BULFACHK
00001C4C                          1560  .TRATCOL            
00001C4C  B67C 00FF               1561              CMP.W   #$FF,D3
00001C50  66E0                    1562              BNE     .TRATCOLU
00001C52  B845                    1563              CMP.W   D5,D4
00001C54  6200 000E               1564              BHI     .GAND5
00001C58  6500 0004               1565              BLO     .GAND4
00001C5C  60D4                    1566              BRA     .TRATCOLU
00001C5E                          1567  .GAND4            
00001C5E  4468 0006               1568              NEG.W   6(A0)
00001C62  60CE                    1569              BRA     .TRATCOLU
00001C64                          1570  .GAND5
00001C64  4468 0004               1571              NEG.W   4(A0)
00001C68  60C8                    1572              BRA     .TRATCOLU
00001C6A                          1573  
00001C6A                          1574  
00001C6A  6000 004C               1575              BRA     .CHKTAN
00001C6E  4244                    1576  .BULFACHK   CLR.W   D4              ; CONTADOR
00001C70  303C 0003               1577              MOVE.W  #TANENEM,D0
00001C74  4EB8 105A               1578              JSR     DMMFRSTO
00001C78  B1FC 00000000           1579  .LOOP31     CMP.L   #0,A0
00001C7E  6700 0018               1580              BEQ     .CHKPLAY2
00001C82  5244                    1581              ADDQ.W  #1,D4
00001C84  B843                    1582              CMP.W   D3,D4
00001C86  6600 000A               1583              BNE     .LOOP32
00001C8A  5268 0012               1584              ADDQ.W  #1,18(A0)       ; AGREGAR UNA BALA DISPONIBLE AL TANQUE SI ES EL PADRE ; no llega aquí?
00001C8E  6000 001C               1585              BRA     .ENDCOLEX
00001C92  4EB8 107C               1586  .LOOP32     JSR     DMMNEXTO
00001C96  60E0                    1587              BRA     .LOOP31
00001C98                          1588  
00001C98                          1589  .CHKPLAY2   
00001C98  303C 0002               1590              MOVE.W  #TANPLAY,D0
00001C9C  4EB8 105A               1591              JSR     DMMFRSTO
00001CA0  B67C 0000               1592              CMP.W   #0,D3
00001CA4  6600 0006               1593              BNE     .ENDCOLEX
00001CA8  5268 0012               1594              ADDQ.W  #1,18(A0)
00001CAC                          1595              
00001CAC                          1596  .ENDCOLEX   ; FINAL EN EL QUE LA BALA EXPLOTA POR TENER X COLISIONES CON BLOQUES         
00001CAC  4C9F 001F               1597              MOVEM.W (A7)+,D0-D4
00001CB0  4E75                    1598              RTS 
00001CB2                          1599  
00001CB2                          1600  
00001CB2  1E3C 0002               1601  .BULWALL    MOVE.B  #SNDWALL,D7 ; BULLET WALL SOUND
00001CB6  4E43                    1602              TRAP    #SNDPLTN           
00001CB8                          1603              
00001CB8                          1604  .CHKTAN     
00001CB8                          1605              ; CHECK TANK COLLISIONS
00001CB8                          1606              ; ENEMY TANK COLLISIONS
00001CB8  48E7 FFC0               1607              MOVEM.L A0-A1/D0-D7,-(A7)
00001CBC  3410                    1608              MOVE.W  (A0),D2                 ; PREPARE SHOT COORDINATES FOR
00001CBE  3628 0002               1609              MOVE.W  2(A0),D3                ; COLLISION CHECK
00001CC2  3A3C 0004               1610              MOVE.W  #BULRAD,D5
00001CC6  3E3C 0004               1611              MOVE.W  #BULRAD,D7
00001CCA  2248                    1612              MOVE.L  A0,A1
00001CCC  303C 0003               1613              MOVE.W  #TANENEM,D0
00001CD0  4EB8 105A               1614              JSR     DMMFRSTO
00001CD4  B1FC 00000000           1615  .LOOP       CMP.L   #0,A0
00001CDA  6700 002A               1616              BEQ     .CHKPLAY
00001CDE  3028 0008               1617              MOVE.W  8(A0),D0
00001CE2  3228 000A               1618              MOVE.W  10(A0),D1
00001CE6  5140                    1619              SUB.W   #TANWIDTH/2,D0
00001CE8  5141                    1620              SUB.W   #TANHEIGH/2,D1
00001CEA  383C 0010               1621              MOVE.W  #TANWIDTH,D4
00001CEE  3C3C 0010               1622              MOVE.W  #TANHEIGH,D6
00001CF2  4EB8 15B4               1623              JSR     UTLCHCOL
00001CF6  4A00                    1624              TST.B   D0
00001CF8  6600 0040               1625              BNE     .EXPLO
00001CFC  303C 0003               1626              MOVE.W  #TANENEM,D0
00001D00  4EB8 107C               1627              JSR     DMMNEXTO
00001D04  60CE                    1628              BRA     .LOOP  
00001D06                          1629  .CHKPLAY    ; PLAYER TANK COLLISIONS
00001D06  303C 0002               1630              MOVE.W  #TANPLAY,D0
00001D0A  4EB8 105A               1631              JSR     DMMFRSTO
00001D0E  B1FC 00000000           1632              CMP.L   #0,A0
00001D14  6700 00B2               1633              BEQ     .END
00001D18  3028 0008               1634              MOVE.W  8(A0),D0
00001D1C  3228 000A               1635              MOVE.W  10(A0),D1
00001D20  5140                    1636              SUB.W   #TANWIDTH/2,D0
00001D22  5141                    1637              SUB.W   #TANHEIGH/2,D1
00001D24  383C 0010               1638              MOVE.W  #TANWIDTH,D4
00001D28  3C3C 0010               1639              MOVE.W  #TANHEIGH,D6
00001D2C  4EB8 15B4               1640              JSR     UTLCHCOL
00001D30  4A00                    1641              TST.B   D0
00001D32  6600 0006               1642              BNE     .EXPLO
00001D36  6000 0090               1643              BRA     .END
00001D3A                          1644  
00001D3A                          1645              ; TANK COLLISION (SUBSTRACT LIFE, DISSAPPEAR THE BULLET)  ; agregar part?culas?         
00001D3A                          1646  .EXPLO          
00001D3A  0468 0028 0010          1647              SUB.W   #BULDMG,16(A0)
00001D40                          1648              
00001D40  0C68 0000 0010          1649              CMP.W   #0,16(A0)
00001D46  6200 0030               1650              BHI     .ALIVE
00001D4A                          1651              ; IF TANK LIFE IS 0
00001D4A                          1652              
00001D4A  0C68 0002 000E          1653              CMP.W   #TANPLAY,14(A0)
00001D50  6600 0012               1654              BNE.W   .ENSNDKIL
00001D54                          1655              ; IF HIT TANK IS NOT A BOT (PLAYER)
00001D54  33FC 0001 00003F44      1656              MOVE.W  #KILLPLYR,(PLYRDEAD)
00001D5C  4EB8 10AC               1657              JSR     AGLKILL
00001D60  6000 001C               1658              BRA     .BULFINAL   
00001D64                          1659  .ENSNDKIL   ; IF TANK IS A BOT 
00001D64  5279 00003F38           1660              ADDQ.W  #1,(SCORE)  ; SUMAMOS 1 A LA PUNTUACI?N 
00001D6A  1E3C 0004               1661              MOVE.B  #SNDKILL,D7
00001D6E  4E43                    1662              TRAP    #SNDPLTN
00001D70  4EB8 10AC               1663              JSR     AGLKILL
00001D74  6000 0008               1664              BRA     .BULFINAL
00001D78                          1665  .ALIVE
00001D78  1E3C 0003               1666              MOVE.B  #SNDHIT,D7  ; HIT SOUND IF TANK DOESN'T DIE
00001D7C  4E43                    1667              TRAP    #SNDPLTN
00001D7E                          1668  .BULFINAL    
00001D7E  2049                    1669              MOVE.L  A1,A0
00001D80  3628 0008               1670              MOVE.W  8(A0),D3    ; ALMACENAR EL FATHER ID
00001D84                          1671       
00001D84                          1672              ; SUMARLE UNA BALA DISPONIBLE AL TANQUE
00001D84                          1673              ; COMPROBAR SI EL TANQUE PADRE DE LA BALA ES UN BOT, RECORRER TODOS Y COMPROBAR CON CU?L COINCIDE EL TANID
00001D84  303C 0003               1674              MOVE.W  #TANENEM,D0
00001D88  4242                    1675              CLR.W   D2          ; CONTADOR
00001D8A  4EB8 105A               1676              JSR     DMMFRSTO
00001D8E  B1FC 00000000           1677  .LOOP21     CMP.L   #0,A0
00001D94  6700 0018               1678              BEQ     .PLAYBULL   ; NO ENCONTRADO NING?N TANQUE ENEMIGO QUE SEA PADRE DE LA BALA, COMPROBAR JUGADOR
00001D98  5242                    1679              ADDQ.W  #1,D2       ; AGREGAR 1 AL CONTADOR
00001D9A                          1680              
00001D9A  B642                    1681              CMP.W   D2,D3
00001D9C  6600 000A               1682              BNE     .LOOP22     
00001DA0  5268 0012               1683              ADDQ.W  #1,18(A0)   ; SI ES EL PADRE LE SUMAMOS UNA BALA DISPONIBLE
00001DA4  6000 001C               1684              BRA     .KILLBULL
00001DA8                          1685  
00001DA8  4EB8 107C               1686  .LOOP22     JSR     DMMNEXTO
00001DAC  60E0                    1687              BRA     .LOOP21     ; SEGUIR CON EL BUCLE YA QUE NO ES EL PADRE            
00001DAE                          1688  
00001DAE                          1689  
00001DAE                          1690  .PLAYBULL   ; EL TANQUE PADRE DE LA BALA ES EL JUGADOR (O ES UN ENEMIGO QUE HA MUERTO)
00001DAE  303C 0002               1691              MOVE.W  #TANPLAY,D0
00001DB2  4EB8 105A               1692              JSR     DMMFRSTO
00001DB6  B67C 0000               1693              CMP.W   #0,D3
00001DBA  6600 0006               1694              BNE     .KILLBULL
00001DBE  5268 0012               1695              ADDQ.W  #1,18(A0)
00001DC2                          1696              
00001DC2                          1697  .KILLBULL
00001DC2  2049                    1698              MOVE.L  A1,A0             
00001DC4  4EB8 10AC               1699              JSR     AGLKILL 
00001DC8                          1700              
00001DC8  4CDF 03FF               1701  .END        MOVEM.L (A7)+,A0-A1/D0-D7
00001DCC  6000 0002               1702              BRA     .DONE   
00001DD0                          1703                
00001DD0                          1704              ; STORE POSITION
00001DD0  3080                    1705  .DONE       MOVE.W  D0,(A0)
00001DD2  3141 0002               1706              MOVE.W  D1,2(A0)
00001DD6                          1707              
00001DD6  4C9F 001F               1708              MOVEM.W (A7)+,D0-D4
00001DDA                          1709              
00001DDA  4E75                    1710              RTS     
00001DDC                          1711              
00001DDC                          1712  ; ----------------------------------------------------------
00001DDC                          1713  BULPLOT
00001DDC                          1714  ; DIBUJA LA BALA
00001DDC                          1715  ; INPUT     : PUNTERO DE A0 A LAS VARIABLES DE INSTANCIA
00001DDC                          1716  ; OUTPUT    : NONE
00001DDC                          1717  ; MODIFIES  : NONE
00001DDC                          1718  ; ----------------------------------------------------------
00001DDC  48E7 F800               1719              MOVEM.L D0-D4,-(A7)            
00001DE0                          1720  
00001DE0                          1721              ; SET PEN COLOR
00001DE0  103C 0050               1722              MOVE.B  #80,D0
00001DE4  223C 0031494D           1723              MOVE.L  #BULPCOL,D1
00001DEA  4E4F                    1724              TRAP    #15
00001DEC                          1725              
00001DEC                          1726              ; SET FILL COLOR
00001DEC  103C 0051               1727              MOVE.B  #81,D0
00001DF0  223C 007CB4BA           1728              MOVE.L  #BULFCOL,D1
00001DF6  4E4F                    1729              TRAP    #15
00001DF8                          1730              
00001DF8                          1731              ; DEFINE COORDINATES
00001DF8  3210                    1732              MOVE.W  (A0),D1
00001DFA  5941                    1733              SUB.W   #BULRAD,D1
00001DFC  3428 0002               1734              MOVE.W  2(A0),D2
00001E00  5942                    1735              SUB.W   #BULRAD,D2
00001E02  3601                    1736              MOVE.W  D1,D3
00001E04  5043                    1737              ADD.W   #2*BULRAD,D3
00001E06  3802                    1738              MOVE.W  D2,D4
00001E08  5044                    1739              ADD.W   #2*BULRAD,D4
00001E0A                          1740              
00001E0A                          1741              ; DRAW CIRCLE
00001E0A  103C 0058               1742              MOVE.B  #88,D0
00001E0E  4E4F                    1743              TRAP    #15 
00001E10                          1744              
00001E10  4CDF 001F               1745              MOVEM.L (A7)+,D0-D4 
00001E14                          1746  
00001E14  4E75                    1747              RTS
00001E16                          1748              
00001E16                          1749  
00001E16                          1750  
00001E16                          1751  
00001E16                          1752  
00001E16                          1753  
00001E16                          1754  
00001E16                          1755  
00001E16                          1756  
00001E16                          1757  
00001E16                          1758  
00001E16                          1759  
00001E16                          1760  
00001E16                          1761  
00001E16                          1762  
00001E16                          1763  
00001E16                          1764  
00001E16                          1765  
00001E16                          1766  
00001E16                          1767  
00001E16                          1768  
00001E16                          1769  
00001E16                          1770  
00001E16                          1771  
00001E16                          1772  
00001E16                          1773  
00001E16                          1774  
00001E16                          1775  
00001E16                          1776  
00001E16                          1777  
00001E16                          1778  
00001E16                          1779  
00001E16                          1780  
00001E16                          1781  -------------------- end include --------------------
00001E16                          1782          INCLUDE "TANK.X68"
00001E16                          1783  
00001E16                          1784  ; ----------------------------------------------------------
00001E16                          1785  TANINIT
00001E16                          1786  ; INITIALITZE TANK
00001E16                          1787  ; INPUT     : A0 POINTER TO THE INSTANCE VARIABLES
00001E16                          1788  ; OUTPUT    : NONE
00001E16                          1789  ; MODIFIES  : NONE
00001E16                          1790  ; ----------------------------------------------------------
00001E16                          1791              
00001E16  3081                    1792              MOVE.W  D1,(A0)
00001E18  3142 0002               1793              MOVE.W  D2,2(A0)
00001E1C                          1794  
00001E1C  B07C 0002               1795              CMP.W   #TANPLAY,D0
00001E20  6600 0048               1796              BNE.W   .BOT
00001E24                          1797              
00001E24  33C1 00003F50           1798              MOVE.W  D1,(PLAYPOSX)
00001E2A  33C2 00003F52           1799              MOVE.W  D2,(PLAYPOSY)
00001E30                          1800              
00001E30                          1801              ; IF TANK IS NOT A BOT (PLAYER)
00001E30  33FC 0000 00003F44      1802              MOVE.W  #PLYRALIV,(PLYRDEAD)    ; EL JUGADOR NO EST? MUERTO
00001E38  317C 0002 0004          1803              MOVE.W  #PLRSPEED,4(A0)         
00001E3E  317C 0002 0006          1804              MOVE.W  #TANPLAY,6(A0)          ; EL TANQUE ES EL JUGADOR 
00001E44  317C 0190 0008          1805              MOVE.W  #PLRINILF,8(A0)         ; VIDA INICIAL DEL TANQUE JUGADOR
00001E4A  317C 0003 000A          1806              MOVE.W  #PLMAXBUL,10(A0)        ; M?XIMAS BALAS DISPONIBLES PARA DISPARAR
00001E50  317C 0000 000C          1807              MOVE.W  #0,12(A0)               ; TANID DEL JUGADOR SER? 0
00001E56  0C79 0001 00003F66      1808              CMP.W   #1,(DEMO)
00001E5E  6600 0008               1809              BNE     .NOTDEMO
00001E62  317C 0064 000E          1810              MOVE.W  #ENEMYRTF,14(A0)        ; CUANDO SEA 0 PODR? VOLVER A DISPARAR
00001E68                          1811  .NOTDEMO            
00001E68  4E75                    1812              RTS 
00001E6A                          1813              
00001E6A                          1814              ; ELSE (TANK IS A BOT)
00001E6A                          1815  .BOT
00001E6A  317C 0001 0004          1816              MOVE.W  #ENESPEED,4(A0)
00001E70  317C 0003 0006          1817              MOVE.W  #TANENEM,6(A0)         ; EL TANQUE ES UN BOT
00001E76  317C 0078 0008          1818              MOVE.W  #ENEINILF,8(A0)        ; VIDA INICIAL DEL TANQUE ENEMIGO
00001E7C  3143 000C               1819              MOVE.W  D3,12(A0)              ; IDENTIFICADOR DEL TANQUE ENEMIGO
00001E80  317C 0064 000E          1820              MOVE.W  #ENEMYRTF,14(A0)       ; CUANDO SEA 0 PODR? VOLVER A DISPARAR
00001E86  4E75                    1821              RTS
00001E88                          1822  
00001E88                          1823  ; ----------------------------------------------------------            
00001E88                          1824  TANUPD
00001E88                          1825  ; UPDATE THE TANK
00001E88                          1826  ; INPUT     : A0 POINTER TO THE INSTANCE VARIABLES
00001E88                          1827  ; OUTPUT    : NONE
00001E88                          1828  ; MODIFIES  : NONE
00001E88                          1829  ; ----------------------------------------------------------
00001E88                          1830  
00001E88  48E7 FF40               1831              MOVEM.L D0-D7/A1,-(A7)
00001E8C                          1832              
00001E8C                          1833              ; UPDATE COORDINATES
00001E8C  3010                    1834              MOVE.W  (A0),D0
00001E8E  3228 0002               1835              MOVE.W  2(A0),D1
00001E92                          1836              
00001E92  0C68 0002 0006          1837              CMP.W   #TANPLAY,6(A0)
00001E98  6600 00E2               1838              BNE.W   .BOT2
00001E9C                          1839              
00001E9C                          1840              ; TANK IS NOT A BOT (PLAYER)
00001E9C  0C79 0001 00003F66      1841              CMP.W   #1,(DEMO)
00001EA4  6700 00D6               1842              BEQ     .BOT2            
00001EA8                          1843  
00001EA8                          1844              ; ITS NOT DEMO
00001EA8  4EB8 12AC               1845              JSR     MOUUPD
00001EAC  3E3C 0000               1846              MOVE.W  #0,D7
00001EB0  4EB8 1308               1847              JSR     APUNTADOR
00001EB4                          1848              
00001EB4  33FC 0000 00003F5C      1849              MOVE.W  #0,(MOVXTEMP)
00001EBC  33FC 0000 00003F5E      1850              MOVE.W  #0,(MOVYTEMP)
00001EC4  0839 0000 00003F6A      1851              BTST.B  #0,(KBDVAL)
00001ECC  6700 0014               1852              BEQ     .CHKLEFT
00001ED0  9068 0004               1853              SUB.W   4(A0),D0  ;RESTAMOS LA VELOCIDAD AL EJE X
00001ED4  5279 00003F62           1854              ADDQ.W  #1,(PLCANPOS)
00001EDA  33FC FFFF 00003F5C      1855              MOVE.W  #-1,(MOVXTEMP)
00001EE2  0839 0002 00003F6A      1856  .CHKLEFT    BTST.B  #2,(KBDVAL)
00001EEA  6700 0014               1857              BEQ     .CONT1
00001EEE  D068 0004               1858              ADD.W   4(A0),D0  ;SUMAMOS LA VELOCIDAD AL EJE X
00001EF2  5279 00003F62           1859              ADDQ.W  #1,(PLCANPOS)
00001EF8  33FC 0001 00003F5C      1860              MOVE.W  #1,(MOVXTEMP)
00001F00                          1861  .CONT1            
00001F00  0839 0001 00003F6A      1862              BTST.B  #1,(KBDVAL)
00001F08  6700 000E               1863              BEQ     .CHKDWN 
00001F0C  9268 0004               1864              SUB.W   4(A0),D1  ;RESTAMOS LA VELOCIDAD AL EJE Y
00001F10  33FC FFFF 00003F5E      1865              MOVE.W  #-1,(MOVYTEMP)
00001F18  0839 0003 00003F6A      1866  .CHKDWN     BTST.B  #3,(KBDVAL)
00001F20  6700 000E               1867              BEQ     .DISP
00001F24  D268 0004               1868              ADD.W   4(A0),D1  ;SUMAMOS LA VELOCIDAD AL EJE Y
00001F28                          1869              
00001F28  33FC 0001 00003F5E      1870              MOVE.W  #1,(MOVYTEMP)
00001F30                          1871  .DISP          
00001F30                          1872              ; COMPROBAR SI EST? DISPARANDO  
00001F30                          1873              
00001F30  1439 00003F6C           1874              MOVE.B  (MOUEDGE),D2   
00001F36                          1875              
00001F36  B43C 0001               1876              CMP.B   #1,D2
00001F3A  6600 01E0               1877              BNE     .CONT2
00001F3E                          1878              
00001F3E  0C68 0000 000A          1879              CMP.W   #0,10(A0)
00001F44  6700 01D6               1880              BEQ     .CONT2                  ; NO QUEDAN BALAS DISPONIBLES 
00001F48                          1881  
00001F48  1E3C 0005               1882              MOVE.B  #SNDDISP,D7             ; SONIDO DISPARO
00001F4C  4E43                    1883              TRAP    #SNDPLTN  
00001F4E                          1884  
00001F4E  3800                    1885              MOVE.W  D0,D4
00001F50  3A01                    1886              MOVE.W  D1,D5
00001F52                          1887                     
00001F52  43F8 1B4A               1888              LEA     BULINIT,A1
00001F56  45F8 1BC2               1889              LEA     BULUPD,A2
00001F5A  47F8 1DDC               1890              LEA     BULPLOT,A3            
00001F5E  303C 0001               1891              MOVE.W  #BULTYPE,D0
00001F62  3210                    1892              MOVE.W  (A0),D1
00001F64  3428 0002               1893              MOVE.W  2(A0),D2
00001F68  3628 000C               1894              MOVE.W  12(A0),D3
00001F6C  4EB8 1508               1895              JSR     AGLADD
00001F70                          1896                              
00001F70  3004                    1897              MOVE.W  D4,D0
00001F72  3205                    1898              MOVE.W  D5,D1
00001F74  5368 000A               1899              SUBQ.W  #1,10(A0)               ; UNA BALA DISPONIBLE MENOS
00001F78  6000 01A2               1900              BRA     .CONT2
00001F7C                          1901  
00001F7C                          1902  .BOT2       ; ELSE (TANK IS A BOT)
00001F7C  33FC 0000 00003F5C      1903              MOVE.W  #0,(MOVXTEMP)
00001F84  33FC 0000 00003F5E      1904              MOVE.W  #0,(MOVYTEMP)
00001F8C  3210                    1905              MOVE.W  (A0),D1
00001F8E  3428 0002               1906              MOVE.W  2(A0),D2
00001F92  3628 0004               1907              MOVE.W  4(A0),D3                ; guardo la velocidad del tanque enemigo aunque no har?a falta (por si la velocidad en un futuro la cambiamos a variable seg?n el tanque)
00001F96                          1908              
00001F96  0C79 0001 00003F66      1909              CMP.W   #1,(DEMO)
00001F9E  6700 000C               1910              BEQ     .DEMOPLAY
00001FA2  0C68 003C 000E          1911              CMP.W   #60,14(A0)              (EL MOVIMIENTO ALEATORIO DEL TANQUE ENEMIGO DEPENDE DEL RTF, POR AHORA ESO NO NOS AFECTA)              
00001FA8  6200 00AC               1912              BHI     .FLLOWPLR               ; EN ESTA ITERACI?N MOVERSE HACIA EL JUGADOR
00001FAC                          1913  .DEMOPLAY            
00001FAC                          1914              ; EN CASO DE NO SEGUIR AL JUGADOR, HACEMOS UN MOVIMIENTO RANDOM
00001FAC                          1915  
00001FAC  0C68 0000 000E          1916              CMP.W   #0,14(A0)
00001FB2  6200 0020               1917              BHI     .DIRASIGN
00001FB6  48E7 8040               1918              MOVEM.L D0/A1,-(A7)
00001FBA  4EB8 19FE               1919              JSR     UTLRAND
00001FBE  C0BC 00000006           1920              AND.L   #$00000006,D0      ; M?SCARA PARA OBTENER M?LTIPLOS DE 2 (ALEATORIOS)
00001FC4  43F9 000023A6           1921              LEA     .MOVVEC,A1
00001FCA  2171 0000 0010          1922              MOVE.L  (A1,D0),16(A0)     ; RANDOM MOVEMENT   
00001FD0  4CDF 0201               1923              MOVEM.L (A7)+,D0/A1
00001FD4                          1924              
00001FD4                          1925  .DIRASIGN           
00001FD4  0C28 0000 0010          1926              CMP.B   #0,16(A0)
00001FDA  6700 002C               1927              BEQ     .CASOCERO
00001FDE  0C28 0001 0010          1928              CMP.B   #1,16(A0)
00001FE4  6700 003E               1929              BEQ     .CASOUNO
00001FE8  0C28 0002 0010          1930              CMP.B   #2,16(A0)
00001FEE  6700 0050               1931              BEQ     .CASODOS
00001FF2                          1932              
00001FF2                          1933              ; CASO TRES
00001FF2  33FC FFFF 00003F5C      1934              MOVE.W  #-1,(MOVXTEMP)
00001FFA  33FC FFFF 00003F5E      1935              MOVE.W  #-1,(MOVYTEMP)
00002002  9443                    1936              SUB.W   D3,D2
00002004  6000 00AC               1937              BRA     .ENDALG2
00002008                          1938              
00002008                          1939              ; CASO CERO
00002008  D243                    1940  .CASOCERO   ADD.W   D3,D1
0000200A  5279 00003F62           1941              ADDQ.W  #1,(PLCANPOS)
00002010  33FC 0001 00003F5C      1942              MOVE.W  #1,(MOVXTEMP)
00002018  33FC 0001 00003F5E      1943              MOVE.W  #1,(MOVYTEMP)
00002020  6000 0090               1944              BRA     .ENDALG2
00002024                          1945           
00002024                          1946              ; CASO UNO
00002024  9243                    1947  .CASOUNO    SUB.W   D3,D1
00002026  5279 00003F62           1948              ADDQ.W  #1,(PLCANPOS)
0000202C  33FC 0001 00003F5C      1949              MOVE.W  #1,(MOVXTEMP)
00002034  33FC FFFF 00003F5E      1950              MOVE.W  #-1,(MOVYTEMP)
0000203C  6000 0074               1951              BRA     .ENDALG2       
00002040                          1952    
00002040                          1953              ; CASO DOS
00002040  D443                    1954  .CASODOS    ADD.W   D3,D2   
00002042  33FC FFFF 00003F5C      1955              MOVE.W  #-1,(MOVXTEMP)
0000204A  33FC 0001 00003F5E      1956              MOVE.W  #1,(MOVYTEMP) 
00002052  6000 005E               1957              BRA     .ENDALG2   
00002056                          1958  .FLLOWPLR               
00002056  2248                    1959              MOVE.L  A0,A1
00002058  303C 0002               1960              MOVE.W  #TANPLAY,D0
0000205C  4EB8 105A               1961              JSR     DMMFRSTO
00002060                          1962           
00002060  B268 0008               1963              CMP.W   8(A0),D1
00002064  6200 000A               1964              BHI     .NEGVELX                ; XENEM > XPLAY
00002068  6500 0014               1965              BLO     .POSVELX                ; XENEM < XPLAY
0000206C  6000 001A               1966              BRA     .VELY                   ; XENEM = XPLAY
00002070                          1967              
00002070  9243                    1968  .NEGVELX    SUB.W   D3,D1
00002072  33FC FFFF 00003F5C      1969              MOVE.W  #-1,(MOVXTEMP)
0000207A  6000 000C               1970              BRA     .VELY
0000207E  D243                    1971  .POSVELX    ADD.W   D3,D1
00002080  33FC 0001 00003F5C      1972              MOVE.W  #1,(MOVXTEMP)
00002088                          1973  
00002088  B468 000A               1974  .VELY       CMP.W   10(A0),D2
0000208C  6200 000A               1975              BHI     .NEGVELY                ; YENEM > YPLAY
00002090  6500 0014               1976              BLO     .POSVELY                ; YENEM < YPLAY                  
00002094  6000 001A               1977              BRA     .ENDALG                 ; YENEM = YPLAY
00002098                          1978  
00002098  9443                    1979  .NEGVELY    SUB.W   D3,D2
0000209A  33FC FFFF 00003F5E      1980              MOVE.W  #-1,(MOVYTEMP)
000020A2  6000 000C               1981              BRA     .ENDALG
000020A6  D443                    1982  .POSVELY    ADD.W   D3,D2   
000020A8  33FC 0001 00003F5E      1983              MOVE.W  #1,(MOVYTEMP)         
000020B0                          1984  
000020B0  2049                    1985  .ENDALG     MOVE.L  A1,A0       
000020B2                          1986  .ENDALG2
000020B2                          1987              ;MOVE.W  D1,(A0)
000020B2                          1988              ;MOVE.W  D2,2(A0)
000020B2                          1989              
000020B2  3001                    1990              MOVE.W  D1,D0
000020B4  3202                    1991              MOVE.W  D2,D1
000020B6                          1992              
000020B6                          1993              ; DISPARO
000020B6  3800                    1994              MOVE.W  D0,D4
000020B8  3A01                    1995              MOVE.W  D1,D5
000020BA                          1996              
000020BA  0C68 0000 000E          1997              CMP.W   #0,14(A0)               
000020C0  6200 0056               1998              BHI     .SUBRTF                 ; ENEMIGO A?N NO TIENE DISPONIBLE DISPARAR  
000020C4  317C 0064 000E          1999              MOVE.W  #ENEMYRTF,14(A0)        ; REINICIAR CONTADOR   
000020CA                          2000              
000020CA  0C68 0002 0006          2001              CMP.W   #2,6(A0)
000020D0  6600 000E               2002              BNE     .ENEDISP                ; SALTAR SI ES EL ENEMIGO (EL JUGADOR PUEDE ESTAR AQU? SI ES LA DEMO)
000020D4                          2003  
000020D4  3E3C 0001               2004              MOVE.W  #1,D7
000020D8  4EB8 1308               2005              JSR     APUNTADOR
000020DC                          2006              
000020DC  6000 0012               2007              BRA     .ENEDISP2
000020E0                          2008  
000020E0                          2009  .ENEDISP
000020E0  3E3C 0002               2010              MOVE.W  #2,D7
000020E4  4EB8 1308               2011              JSR     APUNTADOR  
000020E8  3179 00003F64 0012      2012              MOVE.W  (ENCANPOS),18(A0)  
000020F0                          2013  .ENEDISP2
000020F0  1E3C 0005               2014              MOVE.B  #SNDDISP,D7             ; SONIDO DISPARO
000020F4  4E43                    2015              TRAP    #SNDPLTN  
000020F6                          2016  
000020F6  43F8 1B4A               2017              LEA     BULINIT,A1
000020FA  45F8 1BC2               2018              LEA     BULUPD,A2
000020FE  47F8 1DDC               2019              LEA     BULPLOT,A3            
00002102  303C 0001               2020              MOVE.W  #BULTYPE,D0
00002106  3210                    2021              MOVE.W  (A0),D1                 
00002108  3428 0002               2022              MOVE.W  2(A0),D2                
0000210C  3628 000C               2023              MOVE.W  12(A0),D3
00002110  4EB8 1508               2024              JSR     AGLADD
00002114                          2025              
00002114  3004                    2026              MOVE.W  D4,D0
00002116  3205                    2027              MOVE.W  D5,D1
00002118                          2028  .SUBRTF            
00002118  5368 000E               2029              SUBQ.W  #1,14(A0)               ; RESTARLE 1 AL RTF DEL TANQUE  
0000211C                          2030  .CONT2 
0000211C  4EB8 1922               2031              JSR     TANKCOL
00002120  B6FC 0001               2032              CMP.W   #1,A3
00002124  6300 008C               2033              BLS     .SEG                    ;SALTA SI NO HAY COLISI?N
00002128  0C79 0001 00003F60      2034              CMP.W   #1,(COLTANKP)
00002130  6600 0024               2035              BNE     .NTRAT                  ;SI NO SE HAN CHOCADO CON EL JUGADOR, SEGUIMOS CON EL TRATAMIENTO NORMAL
00002134                          2036              
00002134  0C68 0002 0006          2037              CMP.W   #TANPLAY,6(A0)
0000213A  6700 001A               2038              BEQ     .NTRAT
0000213E                          2039              
0000213E  4EB8 10AC               2040              JSR     AGLKILL
00002142  1E3C 0008               2041              MOVE.B  #SNDEXPLO,D7             ; SONIDO EXPLOSI?N
00002146  4E43                    2042              TRAP    #SNDPLTN  
00002148  5279 00003F38           2043              ADDQ.W  #1,(SCORE)
0000214E  4EB8 19CA               2044              JSR     COLBYKMKZ
00002152  6000 024C               2045              BRA     .FINISH
00002156                          2046              
00002156                          2047  .NTRAT            
00002156  0C79 0000 00003F5C      2048              CMP.W   #0,(MOVXTEMP)
0000215E  6700 0022               2049              BEQ     .NXTEJE
00002162  0C79 0001 00003F5C      2050              CMP.W   #1,(MOVXTEMP)
0000216A  6600 000E               2051              BNE     .TENX
0000216E  9068 0004               2052              SUB.W   4(A0),D0
00002172  9068 0004               2053              SUB.W   4(A0),D0
00002176  6000 000A               2054              BRA     .NXTEJE
0000217A                          2055  .TENX 
0000217A  D068 0004               2056              ADD.W   4(A0),D0
0000217E  D068 0004               2057              ADD.W   4(A0),D0
00002182                          2058  .NXTEJE
00002182  0C79 0000 00003F5E      2059              CMP.W   #0,(MOVYTEMP)
0000218A  6700 0022               2060              BEQ     .NXTEJE2
0000218E  0C79 0001 00003F5E      2061              CMP.W   #1,(MOVYTEMP)
00002196  6600 000E               2062              BNE     .TENY
0000219A  9268 0004               2063              SUB.W   4(A0),D1
0000219E  9268 0004               2064              SUB.W   4(A0),D1            
000021A2  6000 000A               2065              BRA     .NXTEJE2
000021A6                          2066  .TENY 
000021A6  D268 0004               2067              ADD.W   4(A0),D1
000021AA  D268 0004               2068              ADD.W   4(A0),D1
000021AE                          2069  .NXTEJE2
000021AE  6000 01C4               2070              BRA     .DONE
000021B2                          2071  
000021B2                          2072  .SEG        
000021B2                          2073              ;INICIALIZAMOS
000021B2  43F9 00002554           2074              LEA.L   MAPDATA,A1
000021B8  3C39 00003F3A           2075              MOVE.W  (LVLNUM),D6
000021BE  CCFC 0258               2076              MULU.W  #SIZLVL,D6
000021C2  D3C6                    2077              ADD.L   D6,A1
000021C4                          2078  
000021C4  4EB8 15E8               2079              JSR     RELPOS
000021C8                          2080              
000021C8                          2081              ;DERECHA : 1 
000021C8                          2082              ;IZQUIERDA : 2
000021C8                          2083              ;ABAJO : 3
000021C8                          2084              ;ARRIBA : 5
000021C8  4286                    2085              CLR.L   D6
000021CA                          2086              
000021CA                          2087              ; CHECK HORIZONTAL COLLISIONS
000021CA  B87C 0018               2088              CMP.W   #PIESIZX-TANWIDTH/2,D4
000021CE  6E00 001E               2089              BGT     .COLRGT
000021D2  B87C 0008               2090              CMP.W   #TANWIDTH/2,D4            
000021D6  6D00 0030               2091              BLT     .COLLFT                 
000021DA                          2092              
000021DA                          2093              ; CHECK VERTICAL COLLISIONS
000021DA  BA7C 0018               2094  .CHKVERT    CMP.W   #PIESIZY-TANHEIGH/2,D5
000021DE  6E00 0042               2095              BGT     .COLBOT            
000021E2  BA7C 0008               2096              CMP.W   #TANHEIGH/2,D5
000021E6  6D00 00E6               2097              BLT     .COLTOP                
000021EA  6000 0188               2098              BRA     .DONE   
000021EE                          2099              
000021EE                          2100              ; RIGHT SIDE COLLISION    
000021EE                          2101  .COLRGT     
000021EE  5489                    2102              ADDQ.L  #2,A1
000021F0  0C51 0001               2103              CMP.W   #$01,(A1)
000021F4  6600 000C               2104              BNE     .FARSC
000021F8  303C 0018               2105              MOVE.W  #PIESIZX-TANWIDTH/2,D0
000021FC  D042                    2106              ADD.W   D2,D0
000021FE  5589                    2107              SUBQ.L  #2,A1
00002200  60D8                    2108              BRA     .CHKVERT
00002202                          2109  .FARSC
00002202  5246                    2110              ADDQ.W  #1,D6
00002204  5589                    2111              SUBQ.L  #2,A1
00002206  60D2                    2112              BRA     .CHKVERT
00002208                          2113  
00002208                          2114              ; LEFT SIDE COLLISION
00002208                          2115  .COLLFT     
00002208  5589                    2116              SUBQ.L  #2,A1
0000220A  0C51 0001               2117              CMP.W   #$01,(A1)
0000220E  6600 000C               2118              BNE     .FALSC
00002212  303C 0008               2119              MOVE.W  #TANWIDTH/2,D0
00002216  D042                    2120              ADD.W   D2,D0 
00002218  5489                    2121              ADDQ.L  #2,A1
0000221A  60BE                    2122              BRA     .CHKVERT                  
0000221C                          2123  .FALSC
0000221C  5446                    2124              ADDQ.W  #2,D6
0000221E  5489                    2125              ADDQ.L  #2,A1
00002220  60B8                    2126              BRA     .CHKVERT  
00002222                          2127  
00002222                          2128              ; BOTTOM COLLISION
00002222                          2129  .COLBOT     
00002222  D3FC 00000028           2130              ADD.L   #40,A1
00002228  0C51 0001               2131              CMP.W   #$01,(A1)
0000222C  6600 0012               2132              BNE     .FABSC
00002230  323C 0018               2133              MOVE.W  #PIESIZY-TANHEIGH/2,D1
00002234  D243                    2134              ADD.W   D3,D1
00002236  93FC 00000028           2135              SUB.L   #40,A1            
0000223C  6000 0136               2136              BRA     .DONE
00002240                          2137  .FABSC
00002240  BC7C 0001               2138              CMP.W   #1,D6
00002244  6600 003E               2139              BNE     .IB
00002248  5489                    2140              ADDQ.L  #2,A1
0000224A  0C51 0001               2141              CMP.W   #$01,(A1)
0000224E  6600 002E               2142              BNE     .FDB
00002252  323C 0018               2143              MOVE.W  #PIESIZY-TANHEIGH/2,D1
00002256  D243                    2144              ADD.W   D3,D1
00002258  303C 0018               2145              MOVE.W  #PIESIZX-TANWIDTH/2,D0
0000225C  D042                    2146              ADD.W   D2,D0
0000225E  0839 0000 00003F6A      2147              BTST.B  #0,(KBDVAL)
00002266  6700 0006               2148              BEQ     .NOADVR
0000226A  D068 0004               2149              ADD.W   4(A0),D0
0000226E                          2150  .NOADVR            
0000226E  0839 0001 00003F6A      2151              BTST.B  #1,(KBDVAL)
00002276  6700 0006               2152              BEQ     .FDB 
0000227A  D268 0004               2153              ADD.W   4(A0),D1
0000227E                          2154  .FDB            
0000227E  5589                    2155              SUBQ.L  #2,A1
00002280  6000 0042               2156              BRA     .NNB         
00002284                          2157  .IB            
00002284  BC7C 0002               2158              CMP.W   #2,D6
00002288  6600 003A               2159              BNE     .NNB
0000228C  5589                    2160              SUBQ.L  #2,A1
0000228E  0C51 0001               2161              CMP.W   #$01,(A1)
00002292  6600 002E               2162              BNE     .FIB
00002296  323C 0018               2163              MOVE.W  #PIESIZY-TANHEIGH/2,D1
0000229A  D243                    2164              ADD.W   D3,D1
0000229C  303C 0008               2165              MOVE.W  #TANWIDTH/2,D0
000022A0  D042                    2166              ADD.W   D2,D0
000022A2                          2167              
000022A2  0839 0002 00003F6A      2168              BTST.B  #2,(KBDVAL)
000022AA  6700 0006               2169              BEQ     .NOADVL
000022AE  9068 0004               2170              SUB.W   4(A0),D0
000022B2                          2171  .NOADVL            
000022B2  0839 0001 00003F6A      2172              BTST.B  #1,(KBDVAL)
000022BA  6700 0006               2173              BEQ     .FIB 
000022BE  D268 0004               2174              ADD.W   4(A0),D1        
000022C2                          2175  .FIB            
000022C2  5489                    2176              ADDQ.L  #2,A1         
000022C4                          2177  .NNB            
000022C4  93FC 00000028           2178              SUB.L  #40,A1            
000022CA  6000 00A8               2179              BRA     .DONE
000022CE                          2180  
000022CE                          2181              ; TOP COLLISION
000022CE                          2182  .COLTOP     
000022CE  93FC 00000028           2183              SUB.L   #40,A1
000022D4  0C51 0001               2184              CMP.W   #$01,(A1)
000022D8  6600 000C               2185              BNE     .FATSC
000022DC  323C 0008               2186              MOVE.W  #TANHEIGH/2,D1
000022E0  D243                    2187              ADD.W   D3,D1 
000022E2  6000 0090               2188              BRA     .DONE        
000022E6                          2189  .FATSC       
000022E6  BC7C 0001               2190              CMP.W   #1,D6
000022EA  6600 003E               2191              BNE     .IA
000022EE  5489                    2192              ADDQ.L  #2,A1
000022F0  0C51 0001               2193              CMP.W   #$01,(A1)
000022F4  6600 002E               2194              BNE     .FDA
000022F8  323C 0008               2195              MOVE.W  #TANHEIGH/2,D1
000022FC  D243                    2196              ADD.W   D3,D1
000022FE  303C 0018               2197              MOVE.W  #PIESIZX-TANWIDTH/2,D0
00002302  D042                    2198              ADD.W   D2,D0
00002304  0839 0000 00003F6A      2199              BTST.B  #0,(KBDVAL)
0000230C  6700 0006               2200              BEQ     .NOADVRA
00002310  D068 0004               2201              ADD.W   4(A0),D0
00002314                          2202  .NOADVRA            
00002314  0839 0003 00003F6A      2203              BTST.B  #3,(KBDVAL)
0000231C  6700 0006               2204              BEQ     .FDA 
00002320  D268 0004               2205              ADD.W   4(A0),D1
00002324                          2206  .FDA           
00002324  5589                    2207              SUBQ.L  #2,A1
00002326  6000 0042               2208              BRA     .NNA         
0000232A                          2209  .IA            
0000232A  BC7C 0002               2210              CMP.W   #2,D6
0000232E  6600 003A               2211              BNE     .NNA
00002332  5589                    2212              SUBQ.L  #2,A1
00002334  0C51 0001               2213              CMP.W   #$01,(A1)
00002338  6600 002E               2214              BNE     .FIA
0000233C  323C 0008               2215              MOVE.W  #TANHEIGH/2,D1
00002340  D243                    2216              ADD.W   D3,D1
00002342  303C 0008               2217              MOVE.W  #TANWIDTH/2,D0
00002346  D042                    2218              ADD.W   D2,D0
00002348                          2219              
00002348  0839 0002 00003F6A      2220              BTST.B  #2,(KBDVAL)
00002350  6700 0006               2221              BEQ     .NOADVLA
00002354  9068 0004               2222              SUB.W   4(A0),D0
00002358                          2223  .NOADVLA            
00002358  0839 0003 00003F6A      2224              BTST.B  #3,(KBDVAL)
00002360  6700 0006               2225              BEQ     .FIA 
00002364  D268 0004               2226              ADD.W   4(A0),D1        
00002368                          2227  .FIA            
00002368  5489                    2228              ADDQ.L  #2,A1         
0000236A                          2229  .NNA            
0000236A  93FC 00000028           2230              SUB.L  #40,A1            
00002370  6000 0002               2231              BRA     .DONE
00002374                          2232             
00002374                          2233              ; STORE POSITION
00002374  3080                    2234  .DONE       MOVE.W  D0,(A0)
00002376  3141 0002               2235              MOVE.W  D1,2(A0)
0000237A                          2236              
0000237A  0C68 0002 0006          2237              CMP.W   #2,6(A0)
00002380  6600 0012               2238              BNE     .ENEMPOS
00002384  33C0 00003F50           2239              MOVE.W  D0,(PLAYPOSX)
0000238A  33C1 00003F52           2240              MOVE.W  D1,(PLAYPOSY)
00002390  6000 000E               2241              BRA     .FINISH
00002394                          2242  .ENEMPOS    
00002394  33C0 00003F54           2243              MOVE.W  D0,(ENEMPOSX)
0000239A  33C1 00003F56           2244              MOVE.W  D1,(ENEMPOSY)
000023A0                          2245  .FINISH   
000023A0  4CDF 02FF               2246              MOVEM.L (A7)+,D0-D7/A1
000023A4  4E75                    2247              RTS
000023A6                          2248              
000023A6                          2249              ; 4 posibilidades aleatorias
000023A6= 00                      2250  .MOVVEC     DC.B    0  ; 0
000023A7= 01                      2251              DC.B    1  ; 2
000023A8= 02                      2252              DC.B    2  ; 4
000023A9= 03                      2253              DC.B    3  ; 6         
000023AA                          2254            
000023AA                          2255  ; ----------------------------------------------------------            
000023AA                          2256  TANPLOT
000023AA                          2257  ; PLOT THE TANK
000023AA                          2258  ; INPUT     : A0 POINTER TO THE INSTANCE VARIABLES
000023AA                          2259  ; OUTPUT    : NONE
000023AA                          2260  ; MODIFIES  : NONE
000023AA                          2261  ; ----------------------------------------------------------
000023AA                          2262              
000023AA  48E7 FE40               2263              MOVEM.L D0-D6/A1,-(A7)
000023AE                          2264              
000023AE                          2265              ; DRAW TANK
000023AE  0C68 0002 0006          2266              CMP.W   #2,6(A0)
000023B4  6700 0012               2267              BEQ     .DRAWPLAY
000023B8  33E8 0012 00003F64      2268              MOVE.W  18(A0),(ENCANPOS)
000023C0  4EB8 1790               2269              JSR     ENIMASEL
000023C4  6000 0006               2270              BRA     .DRAW
000023C8                          2271  .DRAWPLAY
000023C8  4EB8 1656               2272              JSR     PLIMASEL
000023CC                          2273  .DRAW                        
000023CC                          2274              ;MOVE.W  (A0),D1
000023CC  3428 0002               2275              MOVE.W  2(A0),D2
000023D0                          2276              ;SUB.W   #TANWIDTH/2,D1
000023D0  5142                    2277              SUB.W   #TANHEIGH/2,D2
000023D2                          2278              ;MOVE.W  D1,D3
000023D2  3802                    2279              MOVE.W  D2,D4
000023D4                          2280              ;ADDQ.W  #1,D3
000023D4                          2281              ;ADDQ.W  #1,D4
000023D4  5342                    2282              SUBQ.W  #1,D2
000023D6                          2283  .FILA
000023D6  3210                    2284              MOVE.W  (A0),D1
000023D8  5141                    2285              SUB.W   #TANWIDTH/2,D1
000023DA  3601                    2286              MOVE.W  D1,D3
000023DC                          2287              
000023DC  5242                    2288              ADDQ.W  #1,D2
000023DE  5244                    2289              ADDQ.W  #1,D4
000023E0                          2290  .COLUMNA
000023E0  2A01                    2291              MOVE.L  D1,D5
000023E2  2219                    2292              MOVE.L  (A1)+,D1
000023E4  103C 0050               2293              MOVE.B  #80,D0
000023E8  4E4F                    2294              TRAP    #15
000023EA  2205                    2295              MOVE.L  D5,D1
000023EC                          2296  
000023EC  5241                    2297              ADDQ.W  #1,D1
000023EE  5243                    2298              ADDQ.W  #1,D3
000023F0                          2299  
000023F0  103C 0054               2300              MOVE.B  #84,D0
000023F4  4E4F                    2301              TRAP    #15
000023F6                          2302              
000023F6  3C10                    2303              MOVE.W  (A0),D6
000023F8  5046                    2304              ADD.W   #TANWIDTH/2,D6
000023FA  B646                    2305              CMP.W   D6,D3
000023FC  6DE2                    2306              BLT     .COLUMNA
000023FE                          2307              
000023FE  3C28 0002               2308              MOVE.W  2(A0),D6
00002402  5046                    2309              ADD.W   #TANHEIGH/2,D6
00002404  B846                    2310              CMP.W   D6,D4
00002406  6DCE                    2311              BLT     .FILA
00002408                          2312          
00002408                          2313              ; PLOT LIFE
00002408                          2314              ; IF TANK IS NOT A BOT (PLAYER)
00002408  0C68 0002 0006          2315              CMP.W   #TANPLAY,6(A0)
0000240E  6600 0052               2316              BNE.W   .END
00002412                          2317              
00002412  0C68 0078 0008          2318              CMP.W   #BULDMG*3,8(A0)
00002418  6200 000E               2319              BHI     .PLOTLIFE
0000241C  0839 0004 00003F79      2320              BTST.B  #4,(SCRCYCCT)           ; PARPADEO VIDA EN CASO DE QUE QUEDEN TRES GOLPES O MENOS
00002424  6700 003C               2321              BEQ     .END
00002428                          2322  .PLOTLIFE
00002428                          2323m             UTLSPEN #$00FFFFFF 
00002428                          2324m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00002428                          2325m ; INPUT    - #$00FFFFFF COLOR IN FORMAT $00BBGGRR
00002428                          2326m ; OUTPUT   - NONE
00002428                          2327m ; MODIFIES - D0,D1
00002428                          2328m ; -----------------------------------------------------------------------------
00002434                          2329m             UTLSFIL #PLRLIFEC
00002434                          2330m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00002434                          2331m ; INPUT    - #PLRLIFEC COLOR IN FORMAT $00BBGGRR
00002434                          2332m ; OUTPUT   - NONE
00002434                          2333m ; MODIFIES - D0,D1
00002434                          2334m ; -----------------------------------------------------------------------------
00002440  323C 0078               2335              MOVE.W  #(SCRWIDTH-PLRINILF)/2,D1
00002444  343C 01C6               2336              MOVE.W  #PLRLIFEY,D2
00002448  3628 0008               2337              MOVE.W  8(A0),D3
0000244C  D641                    2338              ADD.W   D1,D3
0000244E  383C 01DA               2339              MOVE.W  #PLRLIFEY+PLRLIFEH,D4
00002452  103C 0057               2340              MOVE.B  #87,D0
00002456  4E4F                    2341              TRAP    #15
00002458  363C 0208               2342              MOVE.W  #(SCRWIDTH+PLRINILF)/2,D3
0000245C  103C 005A               2343              MOVE.B  #90,D0
00002460  4E4F                    2344              TRAP    #15
00002462                          2345  .END            
00002462  4CDF 027F               2346              MOVEM.L (A7)+,D0-D6/A1
00002466                          2347              
00002466  4E75                    2348              RTS    
00002468                          2349  
00002468                          2350  
00002468                          2351  
00002468                          2352  -------------------- end include --------------------
00002468                          2353          INCLUDE "SCORE.X68"
00002468                          2354  
00002468                          2355  ; ----------------------------------------------------------
00002468                          2356  SCOINIT
00002468                          2357  ; INITIALITZE SCOREBOARD
00002468                          2358  ; INPUT     : NONE
00002468                          2359  ; OUTPUT    : NONE
00002468                          2360  ; MODIFIES  : NONE
00002468                          2361  ; ----------------------------------------------------------
00002468  4279 00003F38           2362              CLR.W   (SCORE)
0000246E  4E75                    2363              RTS
00002470                          2364  
00002470                          2365  ; ----------------------------------------------------------
00002470                          2366  SCOPLOT
00002470                          2367  ; PLOT THE SCOREBOARD
00002470                          2368  ; INPUT     : NONE
00002470                          2369  ; OUTPUT    : NONE
00002470                          2370  ; MODIFIES  : NONE
00002470                          2371  ; ----------------------------------------------------------
00002470                          2372  
00002470  48E7 C040               2373              MOVEM.L D0-D1/A1,-(A7)
00002474                          2374  
00002474                          2375              ; SET BACKGROUND COLOR
00002474  103C 0051               2376              MOVE.B  #81,D0
00002478  7200                    2377              MOVE.L  #SCOFCOL,D1
0000247A  4E4F                    2378              TRAP    #15
0000247C                          2379              
0000247C                          2380              ; SET LINE POSITION
0000247C  103C 000B               2381              MOVE.B  #11,D0
00002480  323C 0000               2382              MOVE.W  #SCOLINE,D1
00002484  4E4F                    2383              TRAP    #15
00002486                          2384  
00002486                          2385              ; PRINT LINE
00002486  43F9 000024A0           2386              LEA     .TXT,A1
0000248C  4281                    2387              CLR.L   D1
0000248E  3239 00003F38           2388              MOVE.W  (SCORE),D1
00002494  103C 0011               2389              MOVE.B  #17,D0
00002498  4E4F                    2390              TRAP    #15    
0000249A                          2391  
0000249A  4CDF 0203               2392              MOVEM.L (A7)+,D0-D1/A1          
0000249E                          2393  
0000249E  4E75                    2394              RTS
000024A0= 50 55 4E 54 55 41 ...   2395  .TXT        DC.B    'PUNTUACIÓN: ',0   
000024AE                          2396              DS.W    0                   ; PARA QUE LAS INSTRUCCIONES ESTÉN ALINEADAS
000024AE                          2397  
000024AE                          2398  
000024AE                          2399  -------------------- end include --------------------
000024AE                          2400          INCLUDE "MAP.X68"         
000024AE                          2401  ; =============================================================================
000024AE                          2402  ; MAPA MAPEACIÓN
000024AE                          2403  ; =============================================================================
000024AE                          2404  
000024AE                          2405  ; -----------------------------------------------------------------------------
000024AE                          2406  MAPINIT
000024AE                          2407  ; INITALIZES THE MAP
000024AE                          2408  ; INPUT    - NONE
000024AE                          2409  ; OUTPUT   - NONE
000024AE                          2410  ; MODIFIES - NONE
000024AE                          2411  ; -----------------------------------------------------------------------------
000024AE                          2412  
000024AE  4E75                    2413              RTS
000024B0                          2414  
000024B0                          2415  ; -----------------------------------------------------------------------------
000024B0                          2416  MAPUPD
000024B0                          2417  ; UPDATES THE MAP IF PLAYER CHANGES SCREEN
000024B0                          2418  ; INPUT    - NONE
000024B0                          2419  ; OUTPUT   - NONE
000024B0                          2420  ; MODIFIES - NONE
000024B0                          2421  ; -----------------------------------------------------------------------------
000024B0                          2422              
000024B0  4E75                    2423              RTS
000024B2                          2424  
000024B2                          2425  ; -----------------------------------------------------------------------------
000024B2                          2426  MAPPLOT
000024B2                          2427  ; PLOTS THE MAP
000024B2                          2428  ; INPUT    - NONE
000024B2                          2429  ; OUTPUT   - NONE
000024B2                          2430  ; MODIFIES - NONE
000024B2                          2431  ; -----------------------------------------------------------------------------
000024B2                          2432  
000024B2  48E7 8080               2433              MOVEM.L D0/A0,-(A7)
000024B6                          2434              
000024B6  41F9 00002554           2435              LEA.L   MAPDATA, A0
000024BC  3C39 00003F3A           2436              MOVE.W  (LVLNUM),D6
000024C2  CCFC 0258               2437              MULU.W  #SIZLVL,D6
000024C6  D1C6                    2438              ADD.L   D6,A0
000024C8                          2439                          
000024C8                          2440              ;INICIO BUCLE MATRICIAL DE PINTURA
000024C8  3C3C 000E               2441              MOVE.W #MAPPIEY-1, D6
000024CC  343C FFE0               2442              MOVE.W  #-PIESIZY, D2
000024D0  4283                    2443              CLR.L   D3
000024D2  4284                    2444              CLR.L   D4
000024D4                          2445  .LINEY      ;PARA TODAS LAS FILAS
000024D4  3A3C 0013               2446              MOVE.W  #MAPPIEX-1, D5
000024D8  3E3C FFE0               2447              MOVE.W  #-PIESIZX, D7
000024DC  0642 0020               2448              ADD.W   #PIESIZY,D2
000024E0                          2449  .LINEX      ;PINTAMOS SU CUADRADO
000024E0                          2450  
000024E0                          2451              ;MIRAMOS SI ES PARED O SUELO
000024E0  3018                    2452              MOVE.W  (A0)+,D0
000024E2  B07C 0001               2453              CMP.W   #$01, D0
000024E6                          2454              
000024E6  6700 0032               2455              BEQ    .PARED
000024EA                          2456              ; SET CONTOUR COLOR
000024EA  103C 0050               2457              MOVE.B  #80,D0
000024EE  223C 0042C0FF           2458              MOVE.L  #$0042C0FF,D1
000024F4  4E4F                    2459              TRAP    #15
000024F6                          2460              
000024F6                          2461              ; SET FILL COLOR
000024F6  103C 0051               2462              MOVE.B  #81,D0
000024FA  223C 0042C0FF           2463              MOVE.L  #$0042C0FF,D1
00002500  4E4F                    2464              TRAP    #15
00002502                          2465              
00002502                          2466              ; DEFINE COORDINATES (D2 ESTÁ ARRIBA)
00002502  0647 0020               2467              ADD.W  #PIESIZX, D7
00002506  3207                    2468              MOVE.W  D7, D1
00002508  0643 0020               2469              ADD.W   #PIESIZX, D3
0000250C  0644 0020               2470              ADD.W   #PIESIZY, D4 
00002510                          2471              
00002510                          2472              ; DRAW RECTANGLE (CASILLA)
00002510  103C 0057               2473              MOVE.B  #87,D0
00002514  4E4F                    2474              TRAP    #15
00002516                          2475              
00002516  6000 002E               2476              BRA     .SOLEADO
0000251A                          2477  
0000251A                          2478  .PARED                   
0000251A                          2479              ; SET CONTOUR COLOR
0000251A  103C 0050               2480              MOVE.B  #80,D0
0000251E  223C 000076AC           2481              MOVE.L  #$000076AC,D1
00002524  4E4F                    2482              TRAP    #15
00002526                          2483              
00002526                          2484              ; SET FILL COLOR
00002526  103C 0051               2485              MOVE.B  #81,D0
0000252A  223C 000076AC           2486              MOVE.L  #$000076AC,D1
00002530  4E4F                    2487              TRAP    #15
00002532                          2488              
00002532                          2489              ; DEFINE COORDINATES (D2 ESTÁ ARRIBA)
00002532  0647 0020               2490              ADD.W  #PIESIZX, D7
00002536  3207                    2491              MOVE.W  D7, D1
00002538  0643 0020               2492              ADD.W   #PIESIZX, D3
0000253C  0644 0020               2493              ADD.W   #PIESIZY, D4 
00002540                          2494              
00002540                          2495              ; DRAW RECTANGLE (CASILLA)
00002540  103C 0057               2496              MOVE.B  #87,D0
00002544  4E4F                    2497              TRAP    #15
00002546                          2498              
00002546                          2499              ;JSR     CASPLOT
00002546                          2500  
00002546                          2501  .SOLEADO
00002546                          2502  
00002546                          2503                          
00002546  51CD FF98               2504              DBRA D5, .LINEX
0000254A  51CE FF88               2505              DBRA D6, .LINEY
0000254E                          2506              
0000254E  4CDF 0101               2507              MOVEM.L (A7)+,D0/A0
00002552                          2508  
00002552  4E75                    2509              RTS
00002554                          2510  
00002554                          2511  
00002554                          2512  
00002554                          2513  
00002554                          2514  
00002554                          2515  
00002554                          2516  
00002554                          2517  
00002554                          2518  
00002554                          2519  
00002554                          2520  
00002554                          2521  
00002554                          2522  
00002554                          2523  
00002554                          2524  
00002554                          2525  
00002554                          2526  
00002554                          2527  
00002554                          2528  -------------------- end include --------------------
00002554                          2529          INCLUDE "DATA/MAPDATA.X68"
00002554                          2530  
00002554                          2531  MAPDATA     ;-------------------------------------- MAPA 1 ----------------------------------------
00002554= 0001 0001 0001 0...     2532              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
0000257C= 0001 0000 0000 0...     2533              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
000025A4= 0001 0000 0000 0...     2534              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
000025CC= 0001 0000 0000 0...     2535              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$00,$00,$00,$00,$01
000025F4= 0001 0000 0000 0...     2536              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$01,$01,$01,$00,$00,$00,$00,$00,$00,$00,$01
0000261C= 0001 0000 0000 0...     2537              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002644= 0001 0000 0000 0...     2538              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
0000266C= 0001 0000 0000 0...     2539              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002694= 0001 0000 0000 0...     2540              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
000026BC= 0001 0000 0000 0...     2541              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
000026E4= 0001 0000 0000 0...     2542              DC.W    $01,$00,$00,$00,$00,$00,$01,$00,$00,$01,$01,$01,$00,$00,$00,$00,$00,$00,$00,$01
0000270C= 0001 0000 0000 0...     2543              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$00,$00,$00,$00,$01
00002734= 0001 0000 0000 0...     2544              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
0000275C= 0001 0000 0000 0...     2545              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002784= 0001 0001 0001 0...     2546              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
000027AC                          2547              ;-------------------------------------- MAPA 2 ----------------------------------------
000027AC= 0001 0001 0001 0...     2548              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
000027D4= 0001 0000 0000 0...     2549              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
000027FC= 0001 0000 0000 0...     2550              DC.W    $01,$00,$00,$01,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$00,$00,$01
00002824= 0001 0000 0000 0...     2551              DC.W    $01,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01,$00,$00,$01
0000284C= 0001 0000 0000 0...     2552              DC.W    $01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01
00002874= 0001 0000 0001 0...     2553              DC.W    $01,$00,$01,$01,$00,$00,$00,$00,$01,$01,$01,$01,$00,$00,$00,$00,$01,$01,$00,$01
0000289C= 0001 0000 0000 0...     2554              DC.W    $01,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$00,$00,$00,$00,$00,$00,$01
000028C4= 0001 0000 0000 0...     2555              DC.W    $01,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01,$00,$00,$00,$00,$00,$01
000028EC= 0001 0000 0000 0...     2556              DC.W    $01,$00,$00,$01,$00,$00,$00,$01,$01,$01,$01,$01,$01,$00,$00,$00,$01,$00,$00,$01
00002914= 0001 0000 0000 0...     2557              DC.W    $01,$00,$00,$01,$01,$00,$00,$00,$01,$01,$01,$01,$00,$00,$00,$01,$01,$00,$00,$01
0000293C= 0001 0000 0000 0...     2558              DC.W    $01,$00,$00,$01,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$00,$00,$01
00002964= 0001 0000 0000 0...     2559              DC.W    $01,$00,$00,$00,$01,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$01,$00,$00,$00,$01
0000298C= 0001 0001 0000 0...     2560              DC.W    $01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01
000029B4= 0001 0001 0001 0...     2561              DC.W    $01,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01
000029DC= 0001 0001 0001 0...     2562              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
00002A04                          2563              ;-------------------------------------- MAPA 3 ----------------------------------------
00002A04= 0001 0001 0001 0...     2564              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
00002A2C= 0001 0000 0000 0...     2565              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002A54= 0001 0000 0001 0...     2566              DC.W    $01,$00,$01,$01,$00,$00,$00,$01,$01,$00,$00,$00,$01,$01,$00,$00,$00,$01,$00,$01
00002A7C= 0001 0000 0001 0...     2567              DC.W    $01,$00,$01,$00,$00,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$00,$00,$01,$00,$01
00002AA4= 0001 0000 0001 0...     2568              DC.W    $01,$00,$01,$00,$00,$01,$01,$01,$00,$00,$00,$00,$01,$01,$01,$00,$00,$01,$00,$01
00002ACC= 0001 0000 0000 0...     2569              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002AF4= 0001 0000 0000 0...     2570              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002B1C= 0001 0000 0001 0...     2571              DC.W    $01,$00,$01,$01,$00,$00,$01,$01,$00,$00,$00,$00,$01,$01,$00,$00,$01,$01,$00,$01
00002B44= 0001 0000 0001 0...     2572              DC.W    $01,$00,$01,$00,$00,$00,$01,$00,$00,$00,$00,$00,$01,$00,$00,$00,$01,$00,$00,$01
00002B6C= 0001 0000 0001 0...     2573              DC.W    $01,$00,$01,$00,$00,$00,$01,$01,$01,$00,$00,$01,$01,$01,$00,$00,$01,$00,$00,$01
00002B94= 0001 0000 0000 0...     2574              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002BBC= 0001 0000 0000 0...     2575              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002BE4= 0001 0000 0001 0...     2576              DC.W    $01,$00,$01,$01,$00,$00,$01,$01,$00,$00,$00,$00,$01,$01,$00,$00,$01,$01,$00,$01
00002C0C= 0001 0000 0000 0...     2577              DC.W    $01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$01
00002C34= 0001 0001 0001 0...     2578              DC.W    $01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01,$01
00002C5C                          2579  
00002C5C                          2580  
00002C5C                          2581  
00002C5C                          2582  
00002C5C                          2583  
00002C5C                          2584  
00002C5C                          2585  -------------------- end include --------------------
00002C5C                          2586          INCLUDE "LEVEL.X68"
00002C5C                          2587  
00002C5C                          2588  ; ----------------------------------------------------------
00002C5C                          2589  LVL1INIT
00002C5C                          2590  ; INITIALIZES LEVEL 1
00002C5C                          2591  ; INPUT    : NONE
00002C5C                          2592  ; OUTPUT   : NONE
00002C5C                          2593  ; MODIFIES : NONE
00002C5C                          2594  ; ----------------------------------------------------------
00002C5C                          2595  
00002C5C  48E7 E070               2596              MOVEM.L D0-D2/A1-A3,-(A7)
00002C60                          2597              
00002C60  4279 00003F3C           2598              CLR.W   (TANID)
00002C66                          2599              
00002C66  43F8 1E16               2600              LEA     TANINIT,A1
00002C6A  45F8 1E88               2601              LEA     TANUPD,A2
00002C6E  47F8 23AA               2602              LEA     TANPLOT,A3
00002C72  303C 0002               2603              MOVE.W  #TANPLAY,D0   ; AGENTE TIPO 2 (TANQUE JUGADOR)
00002C76  323C 0032               2604              MOVE.W  #PLRINITX,D1
00002C7A  343C 00F0               2605              MOVE.W  #PLRINITY,D2
00002C7E  4EB8 1508               2606              JSR     AGLADD
00002C82                          2607  
00002C82  303C 0003               2608              MOVE.W  #TANENEM,D0         ; ENEMIGO 1
00002C86  323C 021C               2609              MOVE.W  #SCRWIDTH-100,D1    
00002C8A  343C 017C               2610              MOVE.W  #SCRHEIGH-100,D2
00002C8E  5279 00003F3C           2611              ADDQ.W  #1,(TANID)
00002C94  3639 00003F3C           2612              MOVE.W  (TANID),D3
00002C9A  4EB8 1508               2613              JSR     AGLADD
00002C9E                          2614              
00002C9E  323C 021C               2615              MOVE.W  #SCRWIDTH-100,D1    ; ENEMIGO 2
00002CA2  343C 00B4               2616              MOVE.W  #SCRHEIGH-300,D2
00002CA6  5279 00003F3C           2617              ADDQ.W  #1,(TANID)
00002CAC  3639 00003F3C           2618              MOVE.W  (TANID),D3
00002CB2  4EB8 1508               2619              JSR     AGLADD
00002CB6                          2620              
00002CB6  4CDF 0E07               2621              MOVEM.L (A7)+,D0-D2/A1-A3
00002CBA                          2622              
00002CBA  4E75                    2623              RTS
00002CBC                          2624  
00002CBC                          2625  
00002CBC                          2626  ; ----------------------------------------------------------
00002CBC                          2627  LVL2INIT
00002CBC                          2628  ; INITIALIZES LEVEL 2
00002CBC                          2629  ; INPUT    : NONE
00002CBC                          2630  ; OUTPUT   : NONE
00002CBC                          2631  ; MODIFIES : NONE
00002CBC                          2632  ; ----------------------------------------------------------
00002CBC                          2633  
00002CBC  48E7 E0F0               2634              MOVEM.L D0-D2/A0-A3,-(A7)
00002CC0                          2635              
00002CC0  33FC 0001 00003F3C      2636              MOVE.W  #1,(TANID)
00002CC8                          2637              
00002CC8  303C 0002               2638              MOVE.W  #TANPLAY,D0
00002CCC  4EB8 105A               2639              JSR     DMMFRSTO
00002CD0                          2640              
00002CD0  317C 0140 0008          2641              MOVE.W  #320,8(A0)
00002CD6  317C 0168 000A          2642              MOVE.W  #360,10(A0)
00002CDC  317C 0003 0012          2643              MOVE.W  #PLMAXBUL,18(A0)    ; DEVOLVERLE LAS BALAS AL JUGADOR
00002CE2                          2644              
00002CE2  43F8 1E16               2645              LEA     TANINIT,A1
00002CE6  45F8 1E88               2646              LEA     TANUPD,A2
00002CEA  47F8 23AA               2647              LEA     TANPLOT,A3
00002CEE                          2648              
00002CEE  303C 0003               2649              MOVE.W  #TANENEM,D0         ; ENEMIGO 1
00002CF2  323C 0240               2650              MOVE.W  #SCRWIDTH-64,D1    
00002CF6  343C 0040               2651              MOVE.W  #SCRHEIGH-416,D2
00002CFA  5279 00003F3C           2652              ADDQ.W  #1,(TANID)
00002D00  3639 00003F3C           2653              MOVE.W  (TANID),D3
00002D06  4EB8 1508               2654              JSR     AGLADD
00002D0A                          2655              
00002D0A  323C 0040               2656              MOVE.W  #SCRWIDTH-576,D1    ; ENEMIGO 2 
00002D0E  343C 0040               2657              MOVE.W  #SCRHEIGH-416,D2
00002D12  5279 00003F3C           2658              ADDQ.W  #1,(TANID)
00002D18  3639 00003F3C           2659              MOVE.W  (TANID),D3
00002D1E  4EB8 1508               2660              JSR     AGLADD
00002D22                          2661              
00002D22  323C 00C0               2662              MOVE.W  #SCRWIDTH-448,D1    ; ENEMIGO 3
00002D26  343C 00A0               2663              MOVE.W  #SCRHEIGH-320,D2
00002D2A  5279 00003F3C           2664              ADDQ.W  #1,(TANID)
00002D30  3639 00003F3C           2665              MOVE.W  (TANID),D3
00002D36  4EB8 1508               2666              JSR     AGLADD
00002D3A                          2667              
00002D3A  323C 01C0               2668              MOVE.W  #SCRWIDTH-192,D1    ; ENEMIGO 4
00002D3E  343C 00A0               2669              MOVE.W  #SCRHEIGH-320,D2
00002D42  5279 00003F3C           2670              ADDQ.W  #1,(TANID)
00002D48  3639 00003F3C           2671              MOVE.W  (TANID),D3
00002D4E  4EB8 1508               2672              JSR     AGLADD
00002D52                          2673              
00002D52  4CDF 0F07               2674              MOVEM.L (A7)+,D0-D2/A0-A3
00002D56                          2675              
00002D56  4E75                    2676              RTS
00002D58                          2677              
00002D58                          2678  ; ----------------------------------------------------------
00002D58                          2679  LVL3INIT
00002D58                          2680  ; INITIALIZES LEVEL 3
00002D58                          2681  ; INPUT    : NONE
00002D58                          2682  ; OUTPUT   : NONE
00002D58                          2683  ; MODIFIES : NONE
00002D58                          2684  ; ----------------------------------------------------------
00002D58                          2685              
00002D58  48E7 E0F0               2686              MOVEM.L D0-D2/A0-A3,-(A7)
00002D5C                          2687              
00002D5C  33FC 0001 00003F3C      2688              MOVE.W  #1,(TANID)
00002D64                          2689              
00002D64  303C 0002               2690              MOVE.W  #TANPLAY,D0
00002D68  4EB8 105A               2691              JSR     DMMFRSTO
00002D6C  317C 0140 0008          2692              MOVE.W  #320,8(A0)
00002D72  317C 0190 000A          2693              MOVE.W  #400,10(A0)
00002D78  317C 0003 0012          2694              MOVE.W  #PLMAXBUL,18(A0)    ; DEVOLVERLE LAS BALAS AL JUGADOR
00002D7E                          2695              
00002D7E  43F8 1E16               2696              LEA     TANINIT,A1
00002D82  45F8 1E88               2697              LEA     TANUPD,A2
00002D86  47F8 23AA               2698              LEA     TANPLOT,A3
00002D8A                          2699              
00002D8A  303C 0003               2700              MOVE.W  #TANENEM,D0         ; ENEMIGO 1
00002D8E  323C 0240               2701              MOVE.W  #SCRWIDTH-64,D1    
00002D92  343C 0040               2702              MOVE.W  #SCRHEIGH-416,D2
00002D96  5279 00003F3C           2703              ADDQ.W  #1,(TANID)
00002D9C  3639 00003F3C           2704              MOVE.W  (TANID),D3
00002DA2  4EB8 1508               2705              JSR     AGLADD
00002DA6                          2706              
00002DA6  323C 0040               2707              MOVE.W  #SCRWIDTH-576,D1    ; ENEMIGO 2 
00002DAA  343C 0040               2708              MOVE.W  #SCRHEIGH-416,D2
00002DAE  5279 00003F3C           2709              ADDQ.W  #1,(TANID)
00002DB4  3639 00003F3C           2710              MOVE.W  (TANID),D3
00002DBA  4EB8 1508               2711              JSR     AGLADD
00002DBE                          2712  
00002DBE  323C 00C0               2713              MOVE.W  #SCRWIDTH-448,D1    ; ENEMIGO 3
00002DC2  343C 00A0               2714              MOVE.W  #SCRHEIGH-320,D2
00002DC6  5279 00003F3C           2715              ADDQ.W  #1,(TANID)
00002DCC  3639 00003F3C           2716              MOVE.W  (TANID),D3
00002DD2  4EB8 1508               2717              JSR     AGLADD
00002DD6                          2718  
00002DD6  4CDF 0F07               2719              MOVEM.L (A7)+,D0-D2/A0-A3
00002DDA                          2720              
00002DDA  4E75                    2721              RTS
00002DDC                          2722  
00002DDC                          2723  
00002DDC                          2724  
00002DDC                          2725  
00002DDC                          2726  
00002DDC                          2727  
00002DDC                          2728  
00002DDC                          2729  
00002DDC                          2730  
00002DDC                          2731  -------------------- end include --------------------
00002DDC                          2732          INCLUDE "FPS.X68"
00002DDC                          2733  ; ----------------------------------------------------------
00002DDC                          2734  FPSINIT
00002DDC                          2735  ; INICIALIZAR EL CONTADOR DE FPS
00002DDC                          2736  ; INPUT    : NONE
00002DDC                          2737  ; OUTPUT   : NONE
00002DDC                          2738  ; MODIFIES : ACTFPS
00002DDC                          2739  ; ----------------------------------------------------------
00002DDC                          2740  
00002DDC  4279 00003F82           2741              CLR.W   (ACTFPS)    ; INICIALIZA EL CONTADOR DE FPS
00002DE2  4E75                    2742              RTS
00002DE4                          2743  
00002DE4                          2744  ; ----------------------------------------------------------
00002DE4                          2745  FPSUPD     
00002DE4                          2746  ; ACTUALIZAR LOS FPS
00002DE4                          2747  ; INPUT    : NONE
00002DE4                          2748  ; OUTPUT   : NONE
00002DE4                          2749  ; MODIFIES : ACTFPS, SHWFPS, TIEMPO, D0-D2
00002DE4                          2750  ; ----------------------------------------------------------   
00002DE4                          2751              
00002DE4                          2752              ; INCREMENTAR EL CONTADOR DE FPS
00002DE4  5279 00003F82           2753              ADDQ.W      #1,ACTFPS
00002DEA                          2754              ; INVOCAR LA TAREA 8 PARA MEDIR EL TIEMPO EN CENTÉSIMAS DE SEGUNDO
00002DEA  303C 0008               2755              MOVE.W      #8,D0           
00002DEE  4E4F                    2756              TRAP        #15
00002DF0                          2757              ; COMPARAR EL TIEMPO DE LA INTERRUPCIÓN ANTERIOR Y LA ACTUAL
00002DF0  2401                    2758              MOVE.L  D1,D2           ; D2 = TIEMPO ACTUAL          
00002DF2  2039 00003F7A           2759              MOVE.L  TIEMPO,D0       ; D0 = TIEMPO ANTERIOR     
00002DF8  0680 00000064           2760              ADD.L   #100,D0         ; D0 += 100 CENTÉSIMAS (1 SEGUNDO)     
00002DFE  9280                    2761              SUB.L   D0,D1           ; D1 = D2 - (D0 + 100)     
00002E00                          2762              ; VERIFICAR SI HA PASADO AL MENOS 1 SEGUNDO
00002E00  B2BC 00000000           2763              CMP.L   #0,D1            
00002E06  6D00 001A               2764              BLT     .END
00002E0A                          2765              ; SI ES NECESARIO, ACTUALIZAR LOS FPS EN PANTALLA
00002E0A  33F9 00003F82 00003F84  2766              MOVE.W  ACTFPS,SHWFPS   ; MUEVE EL VALOR ACTUAL DE FPS
00002E14  33FC 0000 00003F82      2767              MOVE.W  #0,ACTFPS       ; REINICIA EL CONTADOR DE FPS
00002E1C  23C2 00003F7A           2768              MOVE.L  D2,TIEMPO       ; ACTUALIZA EL TIEMPO
00002E22                          2769  .END
00002E22  4E75                    2770              RTS
00002E24                          2771              
00002E24                          2772  ; ----------------------------------------------------------
00002E24                          2773  FPSPLOT     
00002E24                          2774  ; MOSTRAR LOS FPS EN PANTALLA
00002E24                          2775  ; INPUT    : NONE
00002E24                          2776  ; OUTPUT   : NONE
00002E24                          2777  ; MODIFIES : NONE
00002E24                          2778  ; ----------------------------------------------------------
00002E24                          2779  
00002E24  48E7 C040               2780              MOVEM.L D0-D1/A1,-(A7)
00002E28                          2781                          
00002E28                          2782              ; ESTABLECER COORDENADAS PARA MOSTRAR LOS FPS OBJETIVO
00002E28  103C 000B               2783              MOVE.B  #11,D0
00002E2C  323C 4000               2784              MOVE.W  #FPSLINE1,D1
00002E30  4E4F                    2785              TRAP    #15
00002E32                          2786              
00002E32                          2787              ; MOSTRAR TEXTO
00002E32  43F9 00002E68           2788              LEA     .GOALFPS, A1
00002E38  4281                    2789              CLR.L   D1
00002E3A  323C 0032               2790              MOVE.W  #SCRFPS,D1
00002E3E  103C 0011               2791              MOVE.B  #17,D0
00002E42  4E4F                    2792              TRAP    #15
00002E44                          2793              
00002E44                          2794              ; MOSTRAR LOS FPS ACTUALES
00002E44  103C 000B               2795              MOVE.B  #11,D0
00002E48  323C 4001               2796              MOVE.W  #FPSLINE2,D1        ; COORDENADAS
00002E4C  4E4F                    2797              TRAP    #15
00002E4E  43F9 00002E77           2798              LEA     .ACTUALFPS,A1
00002E54  4281                    2799              CLR.L   D1
00002E56  3239 00003F84           2800              MOVE.W  (SHWFPS),D1         ; CARGAR FPS ACTUALES
00002E5C  103C 0011               2801              MOVE.B  #17,D0              ; MOSTRAR TEXTO
00002E60  4E4F                    2802              TRAP    #15
00002E62                          2803              
00002E62  4CDF 0203               2804              MOVEM.L (A7)+,D0-D1/A1
00002E66                          2805              
00002E66  4E75                    2806              RTS
00002E68                          2807              
00002E68= 46 50 53 20 45 53 ...   2808  .GOALFPS         DC.B   'FPS ESPERADOS:',0
00002E77= 46 50 53 20 41 43 ...   2809  .ACTUALFPS       DC.B   'FPS ACTUALES :',0
00002E86                          2810                   DS.W   0
00002E86                          2811  
00002E86                          2812  
00002E86                          2813  
00002E86                          2814  
00002E86                          2815  
00002E86                          2816  
00002E86                          2817  
00002E86                          2818  
00002E86                          2819  
00002E86                          2820  
00002E86                          2821  
00002E86                          2822  
00002E86                          2823  
00002E86                          2824  
00002E86                          2825  
00002E86                          2826  -------------------- end include --------------------
00002E86                          2827          INCLUDE "GAME.X68"
00002E86                          2828  
00002E86                          2829  ; ----------------------------------------------------------
00002E86                          2830  GAMINIT
00002E86                          2831  ; INITIALIZES GAME
00002E86                          2832  ; INPUT    : NONE
00002E86                          2833  ; OUTPUT   : NONE
00002E86                          2834  ; MODIFIES : NONE
00002E86                          2835  ; ----------------------------------------------------------
00002E86                          2836              
00002E86  4280                    2837              CLR.L   D0
00002E88  4281                    2838              CLR.L   D1
00002E8A  4282                    2839              CLR.L   D2
00002E8C  4283                    2840              CLR.L   D3
00002E8E  4284                    2841              CLR.L   D4
00002E90  4285                    2842              CLR.L   D5
00002E92  4286                    2843              CLR.L   D6
00002E94  4287                    2844              CLR.L   D7
00002E96                          2845              
00002E96  42B9 00003F4E           2846              CLR.L   (BULPOSORGX)
00002E9C  42B9 00003F4C           2847              CLR.L   (BULPOSORGY)
00002EA2                          2848              
00002EA2  4EB8 1000               2849              JSR     DMMINIT
00002EA6  4EB8 2468               2850              JSR     SCOINIT 
00002EAA  4EB8 2C5C               2851              JSR     LVL1INIT
00002EAE                          2852              
00002EAE  33FC 0001 00003F46      2853              MOVE.W  #1,(DOPLOT)
00002EB6  33FC 0000 00003F3A      2854              MOVE.W  #0,(LVLNUM)
00002EBE                          2855  
00002EBE  4E75                    2856              RTS           
00002EC0                          2857  
00002EC0                          2858  ; ----------------------------------------------------------
00002EC0                          2859  GAMUPD
00002EC0                          2860  ; UPDATES THE GAME
00002EC0                          2861  ; INPUT    : NONE
00002EC0                          2862  ; OUTPUT   : NONE
00002EC0                          2863  ; MODIFIES : NONE
00002EC0                          2864  ; ----------------------------------------------------------
00002EC0                          2865  
00002EC0  4EB8 1522               2866              JSR     AGLUPD
00002EC4                          2867              
00002EC4                          2868              ; RECORDAR QUE EL NIVEL ES CONCEPTUALMENTE UN NÚMERO MAYOR QUE SU PROPIO CÓDIGO (EL CÓDIGO DEL NIVEL 1 ES 0, DEL NIVEL 2 ES 1, ...)
00002EC4                          2869              ; ESTO ES DEBIDO A QUE MULTIPLICAMOS EL NIVEL POR LO QUE OCUPA CADA MAPA (EL MAPA DEL NIVEL 1 TIENE QUE ESTAR EN LA POSICIÓN 0)
00002EC4                          2870              
00002EC4  0C79 0002 00003F3A      2871              CMP.W   #2,(LVLNUM) ; COMPROBAR SI YA ESTAMOS EN EL NIVEL 3
00002ECC  6C00 007E               2872              BGE     .CHKWIN     
00002ED0  0C79 0001 00003F3A      2873              CMP.W   #1,(LVLNUM) ; COMPROBAR SI YA ESTAMOS EN EL NIVEL 2
00002ED8  6600 0020               2874              BNE     .LVL1
00002EDC                          2875  
00002EDC  0C79 0006 00003F38      2876              CMP.W   #ENEMLVL2,(SCORE)   ; ESTAMOS EN EL NIVEL 2, COMPROBAR SI LO HEMOS ACABADO
00002EE4  6D00 008C               2877              BLT     .CHKLOSS
00002EE8  5279 00003F3A           2878              ADDQ.W  #1,(LVLNUM)
00002EEE  4EB8 1622               2879              JSR     KILLBULS
00002EF2  4EB8 2D58               2880              JSR     LVL3INIT
00002EF6  6000 00A8               2881              BRA     .DONE
00002EFA                          2882  .LVL1       
00002EFA  0C79 0001 00003F66      2883              CMP.W   #1,(DEMO)
00002F02  6600 000E               2884              BNE     .CONTLVL1
00002F06                          2885              ; SI ESTAMOS EN LA DEMO, COMPROBAR SI HAN PULSADO AL ESPACIO PARA VOLVER AL MENÚ
00002F06  0839 0004 00003F6B      2886              BTST.B  #4,(KBDEDGE)
00002F0E  6600 002A               2887              BNE     .DEMOEND
00002F12                          2888  .CONTLVL1     
00002F12  0C79 0002 00003F38      2889              CMP.W   #ENEMLVL1,(SCORE)   ; ESTAMOS EN EL NIVEL 1, COMPROBAR SI LO HEMOS ACABADO
00002F1A  6D00 0056               2890              BLT     .CHKLOSS
00002F1E  0C79 0001 00003F66      2891              CMP.W   #1,(DEMO)
00002F26  6700 0012               2892              BEQ     .DEMOEND
00002F2A  5279 00003F3A           2893              ADDQ.W  #1,(LVLNUM)
00002F30  4EB8 1622               2894              JSR     KILLBULS
00002F34  4EB8 2CBC               2895              JSR     LVL2INIT
00002F38  4E75                    2896              RTS
00002F3A                          2897  .DEMOEND                                ; EN LA DEMO SOLO SE MUESTRA EL PRIMER NIVEL
00002F3A  33FC 0000 00003F66      2898              MOVE.W  #0,(DEMO)
00002F42  33FC 0000 00003F42      2899              MOVE.W  #0,(STANEXT)
00002F4A  4E75                    2900              RTS         
00002F4C                          2901  .CHKWIN            
00002F4C  0C79 0009 00003F38      2902              CMP.W   #ENEMLVL3,(SCORE)
00002F54  6D00 001C               2903              BLT     .CHKLOSS
00002F58  4EB8 1622               2904              JSR     KILLBULS
00002F5C  303C 0002               2905              MOVE.W  #TANPLAY,D0
00002F60  4EB8 105A               2906              JSR     DMMFRSTO
00002F64  4EB8 10AC               2907              JSR     AGLKILL
00002F68  33FC 0003 00003F42      2908              MOVE.W  #3,(STANEXT)
00002F70  4E75                    2909              RTS
00002F72                          2910  .CHKLOSS    
00002F72  0C79 0001 00003F44      2911              CMP.W   #KILLPLYR,(PLYRDEAD)    
00002F7A  6600 0024               2912              BNE     .DONE
00002F7E  4EB8 1622               2913              JSR     KILLBULS
00002F82  303C 0002               2914              MOVE.W  #TANPLAY,D0
00002F86  4EB8 105A               2915              JSR     DMMFRSTO
00002F8A  4EB8 10AC               2916              JSR     AGLKILL
00002F8E  0C79 0001 00003F66      2917              CMP.W   #1,(DEMO)
00002F96  67A2                    2918              BEQ     .DEMOEND
00002F98                          2919              
00002F98                          2920              ; SI EL JUGADOR TIENE 0 DE VIDA Y NO ES UNA DEMO, IR A LA PANTALLA DE DERROTA
00002F98  33FC 0004 00003F42      2921              MOVE.W  #4,(STANEXT)
00002FA0                          2922  .DONE
00002FA0  4E75                    2923              RTS      
00002FA2                          2924        
00002FA2                          2925  ; ----------------------------------------------------------
00002FA2                          2926  GAMPLOT
00002FA2                          2927  ; PLOTS THE GAME
00002FA2                          2928  ; INPUT    : NONE
00002FA2                          2929  ; OUTPUT   : NONE
00002FA2                          2930  ; MODIFIES : NONE
00002FA2                          2931  ; ----------------------------------------------------------
00002FA2                          2932  
00002FA2  4EB8 24B2               2933              JSR     MAPPLOT
00002FA6  4EB8 1546               2934              JSR     AGLPLOT
00002FAA                          2935               
00002FAA  0C79 0001 00003F66      2936              CMP.W   #1,(DEMO)
00002FB2  6600 0034               2937              BNE     .NODEMO
00002FB6                          2938              
00002FB6  4281                    2939              CLR.L   D1
00002FB8  103C 0051               2940              MOVE.B  #81,D0
00002FBC  4E4F                    2941              TRAP    #15
00002FBE  41F9 00002FEC           2942              LEA     .TXT1,A0                ; TEXTO DEMO
00002FC4  103C 000F               2943              MOVE.B  #15,D0
00002FC8  4EB8 1582               2944              JSR     UTLPRINT
00002FCC  41F9 00002FF5           2945              LEA     .TXT2,A0                
00002FD2  103C 0010               2946              MOVE.B  #16,D0
00002FD6  4EB8 1582               2947              JSR     UTLPRINT
00002FDA  41F9 00003005           2948              LEA     .TXT3,A0                
00002FE0  103C 0019               2949              MOVE.B  #25,D0
00002FE4  4EB8 1582               2950              JSR     UTLPRINT
00002FE8                          2951  .NODEMO        
00002FE8  6000 F486               2952              BRA     SCOPLOT
00002FEC                          2953  
00002FEC= 50 41 4E 54 41 4C ...   2954  .TXT1       DC.B    'PANTALLA',0
00002FF5= 44 45 20 44 45 4D ...   2955  .TXT2       DC.B    'DE DEMOSTRACIÓN',0
00003005= 50 55 4C 53 41 20 ...   2956  .TXT3       DC.B    'PULSA LA BARRA ESPACIADORA PARA VOLVER AL MENÚ PRINCIPAL',0
0000303E                          2957              DS.W    0
0000303E                          2958  
0000303E                          2959  
0000303E                          2960  
0000303E                          2961  
0000303E                          2962  
0000303E                          2963  
0000303E                          2964  
0000303E                          2965  
0000303E                          2966  
0000303E                          2967  
0000303E                          2968  
0000303E                          2969  
0000303E                          2970  
0000303E                          2971  
0000303E                          2972  
0000303E                          2973  
0000303E                          2974  
0000303E                          2975  
0000303E                          2976  
0000303E                          2977  
0000303E                          2978  
0000303E                          2979  
0000303E                          2980  
0000303E                          2981  
0000303E                          2982  
0000303E                          2983  -------------------- end include --------------------
0000303E                          2984          INCLUDE "INTRO.X68"
0000303E                          2985  ; ==============================================================================
0000303E                          2986  ; INTRO SCREEN
0000303E                          2987  ; ==============================================================================
0000303E                          2988  
0000303E                          2989  ; ------------------------------------------------------------------------------
0000303E                          2990  ISCINIT
0000303E                          2991  ; INTRO SCREEN INIT
0000303E                          2992  ; INPUT    : NONE
0000303E                          2993  ; OUTPUT   : NONE
0000303E                          2994  ; MODIFIES : NONE
0000303E                          2995  ; ------------------------------------------------------------------------------
0000303E  48E7 FCE0               2996              MOVEM.L D0-D5/A0-A2,-(A7)
00003042                          2997  
00003042  33FC 0000 00003F46      2998              MOVE.W  #0,(DOPLOT)
0000304A                          2999  
0000304A  103C 005C               3000              MOVE.B  #92,D0                  ;DESACTIVAR DOBLE BUFFER
0000304E  123C 0010               3001              MOVE.B  #16,D1
00003052  4E4F                    3002              TRAP    #15
00003054                          3003              
00003054  223C 00054B17           3004              MOVE.L  #$00054B17,D1           ; COLOR FONDO
0000305A  103C 0051               3005              MOVE.B  #81,D0
0000305E  4E4F                    3006              TRAP    #15
00003060                          3007              
00003060  7200                    3008              MOVE.L  #0,D1
00003062  7400                    3009              MOVE.L  #0,D2
00003064  263C 00000280           3010              MOVE.L  #SCRWIDTH,D3
0000306A  283C 000001E0           3011              MOVE.L  #SCRHEIGH,D4
00003070  103C 0057               3012              MOVE.B  #87,D0
00003074  4E4F                    3013              TRAP    #15
00003076                          3014              
00003076  4279 00003F3E           3015              CLR.W   (ISCTIMER) 
0000307C                          3016              
0000307C  4285                    3017              CLR.L   D5
0000307E                          3018              
0000307E  41F9 00003F86           3019              LEA     FILEDATA,A0
00003084  34BC 0100               3020              MOVE.W  #IMAWIDTH/2,(A2)
00003088  357C 00C0 0002          3021              MOVE.W  #IMAHEIGH/2,2(A2)
0000308E                          3022              
0000308E  4EB8 18CA               3023              JSR     IMAPLOT
00003092                          3024              
00003092  223C 00054B17           3025              MOVE.L  #$00054B17,D1
00003098  103C 0051               3026              MOVE.B  #81,D0
0000309C  4E4F                    3027              TRAP    #15
0000309E                          3028   
0000309E  41F9 000030D8           3029              LEA     .TXT1,A0                ; TEXTO 1
000030A4  103C 0019               3030              MOVE.B  #25,D0
000030A8  4EB8 1582               3031              JSR     UTLPRINT
000030AC                          3032              
000030AC  41F9 00003105           3033              LEA     .TXT2,A0                ; TEXTO 2
000030B2  103C 001C               3034              MOVE.B  #28,D0
000030B6  4EB8 1582               3035              JSR     UTLPRINT
000030BA                          3036              
000030BA  41F9 00003120           3037              LEA     .TXT3,A0                ; TEXTO 3
000030C0  103C 001D               3038              MOVE.B  #29,D0
000030C4  4EB8 1582               3039              JSR     UTLPRINT
000030C8                          3040            
000030C8  123C 0011               3041              MOVE.B  #17,D1                    ; ACTIVAR DOUBLE BUFFER
000030CC  103C 005C               3042              MOVE.B  #92,D0
000030D0  4E4F                    3043              TRAP    #15
000030D2                          3044              
000030D2  4CDF 073F               3045              MOVEM.L (A7)+,D0-D5/A0-A2
000030D6                          3046              
000030D6  4E75                    3047              RTS  
000030D8                          3048  
000030D8= A1 50 52 45 53 49 ...   3049  .TXT1       DC.B    '¡PRESIONA LA BARRA ESPACIADORA PARA EMPEZAR!',0
00003105= 50 52 45 53 49 4F ...   3050  .TXT2       DC.B    'PRESIONA LA TECLA "i" PARA',0 
00003120= 56 49 53 49 54 41 ...   3051  .TXT3       DC.B    'VISITAR EL MENÚ DE INSTRUCCIONES',0
00003142                          3052              DS.W    0
00003142                          3053                                
00003142                          3054  
00003142                          3055  ; ------------------------------------------------------------------------------
00003142                          3056  ISCUPD
00003142                          3057  ; INTRO SCREEN UPDATE
00003142                          3058  ; INPUT    : NONE
00003142                          3059  ; OUTPUT   : NONE
00003142                          3060  ; MODIFIES : NONE
00003142                          3061  ; ------------------------------------------------------------------------------
00003142                          3062              
00003142  0839 0004 00003F6B      3063              BTST.B  #4,(KBDEDGE)
0000314A  6700 000C               3064              BEQ     .CONT1
0000314E  33FC 0002 00003F42      3065              MOVE.W  #2,(STANEXT)
00003156  4E75                    3066              RTS
00003158                          3067              
00003158  0839 0005 00003F6B      3068  .CONT1      BTST.B  #5,(KBDEDGE)
00003160  6700 000C               3069              BEQ     .CONT2
00003164  33FC 0001 00003F42      3070              MOVE.W  #1,(STANEXT)
0000316C  4E75                    3071              RTS
0000316E                          3072              
0000316E  5279 00003F3E           3073  .CONT2      ADDQ.W  #1,(ISCTIMER)
00003174  0C79 01F4 00003F3E      3074              CMP.W   #ISCMAXTM,(ISCTIMER)
0000317C  6D00 0014               3075              BLT     .DONE
00003180  33FC 0001 00003F66      3076              MOVE.W  #1,(DEMO)
00003188  33FC 0002 00003F42      3077              MOVE.W  #2,(STANEXT)
00003190  4E75                    3078              RTS
00003192                          3079       
00003192  1E3C 0000               3080  .DONE       MOVE.B  #SNDINTRO,D7
00003196  4E43                    3081              TRAP    #SNDPLTN
00003198  4E75                    3082              RTS
0000319A                          3083  
0000319A                          3084  
0000319A                          3085  
0000319A                          3086  
0000319A                          3087  
0000319A                          3088  
0000319A                          3089  
0000319A                          3090  
0000319A                          3091  
0000319A                          3092  
0000319A                          3093  
0000319A                          3094  
0000319A                          3095  
0000319A                          3096  
0000319A                          3097  
0000319A                          3098  
0000319A                          3099  
0000319A                          3100  
0000319A                          3101  
0000319A                          3102  
0000319A                          3103  
0000319A                          3104  -------------------- end include --------------------
0000319A                          3105          INCLUDE "INSTRUCTIONS.X68"
0000319A                          3106  ; ==============================================================================
0000319A                          3107  ; INSTRUCTIONS SCREEN
0000319A                          3108  ; ==============================================================================
0000319A                          3109  
0000319A                          3110  ; ------------------------------------------------------------------------------
0000319A                          3111  INSINIT
0000319A                          3112  ; INSTRUCTIONS SCREEN INIT
0000319A                          3113  ; INPUT    : NONE
0000319A                          3114  ; OUTPUT   : NONE
0000319A                          3115  ; MODIFIES : NONE
0000319A                          3116  ; ------------------------------------------------------------------------------
0000319A                          3117              
0000319A  123C 0011               3118              MOVE.B  #17,D1                    ; ACTIVAR DOUBLE BUFFER
0000319E  103C 005C               3119              MOVE.B  #92,D0
000031A2  4E4F                    3120              TRAP    #15
000031A4  4E40                    3121              TRAP    #SCRUPTN
000031A6                          3122              
000031A6  48E7 C0C0               3123              MOVEM.L D0-D1/A0-A1,-(A7)
000031AA  223C 00054B17           3124              MOVE.L  #$00054B17,D1           ; COLOR FONDO
000031B0  103C 0051               3125              MOVE.B  #81,D0
000031B4  4E4F                    3126              TRAP    #15
000031B6                          3127  
000031B6  7200                    3128              MOVE.L  #0,D1
000031B8  7400                    3129              MOVE.L  #0,D2
000031BA  263C 00000280           3130              MOVE.L  #SCRWIDTH,D3
000031C0  283C 000001E0           3131              MOVE.L  #SCRHEIGH,D4
000031C6  103C 0057               3132              MOVE.B  #87,D0
000031CA  4E4F                    3133              TRAP    #15
000031CC                          3134  
000031CC  41F9 00003208           3135              LEA     .TXT1,A0
000031D2  103C 0005               3136              MOVE.B  #5,D0
000031D6  4EB8 1582               3137              JSR     UTLPRINT
000031DA                          3138              
000031DA  103C 000B               3139              MOVE.B  #11,D0
000031DE  43F9 00003372           3140              LEA     .TXTLST,A1
000031E4  2219                    3141  .LOOP       MOVE.L  (A1)+,D1
000031E6  6700 000A               3142              BEQ     .LOOPEND
000031EA  2041                    3143              MOVE.L  D1,A0
000031EC  4EB8 1582               3144              JSR     UTLPRINT
000031F0  60F2                    3145              BRA     .LOOP
000031F2                          3146  .LOOPEND           
000031F2  41F9 00003342           3147              LEA     .TXT9,A0
000031F8  103C 0019               3148              MOVE.B  #25,D0
000031FC  4EB8 1582               3149              JSR     UTLPRINT
00003200                          3150  
00003200  4CDF 0303               3151              MOVEM.L (A7)+,D0-D1/A0-A1
00003204                          3152  
00003204  4E40                    3153              TRAP    #SCRUPTN
00003206  4E75                    3154              RTS
00003208                          3155              
00003208= A1 42 49 45 4E 56 ...   3156  .TXT1       DC.B    '¡BIENVENIDO A TANKS 68K!',0
00003221= 54 55 20 4F 42 4A ...   3157  .TXT2       DC.B    'TU OBJETIVO ES SUPERAR TODOS LOS NIVELES.',0
0000324B= 50 41 52 41 20 45 ...   3158  .TXT3       DC.B    'PARA ELLO, DEBES DERROTAR A TODOS LOS TANQUES ENEMIGOS',0
00003282= 53 49 4E 20 51 55 ...   3159  .TXT4       DC.B    'SIN QUE ELLOS AGOTEN TU BARRA DE VIDA.',0
000032A9= 50 41 52 41 20 4D ...   3160  .TXT5       DC.B    'PARA MOVERTE UTILIZA LAS TECLAS WASD,',0
000032CF= 50 41 52 41 20 41 ...   3161  .TXT6       DC.B    'PARA APUNTAR UTILIZA EL RATÓN,',0
000032EE= 50 41 52 41 20 44 ...   3162  .TXT7       DC.B    'PARA DISPARAR PRESIONA EL CLICK IZQUIERDO,',0
00003319= 54 49 45 4E 45 53 ...   3163  .TXT8       DC.B    'TIENES UN MÁXIMO DE 3 BALAS SIMULTÁNEAS.',0
00003342= 50 55 4C 53 41 20 ...   3164  .TXT9       DC.B    'PULSA ESPACIO PARA REGRESAR AL MENÚ PRINCIPAL',0
00003370= 00                      3165  .VOIDTXT    DC.B    '',0
00003372                          3166              DS.W    0
00003372= 00003221 0000324B ...   3167  .TXTLST     DC.L    .TXT2,.TXT3,.TXT4,.VOIDTXT,.VOIDTXT,.TXT5,.TXT6,.TXT7,.TXT8,0            
0000339A                          3168  
0000339A                          3169  ; ------------------------------------------------------------------------------
0000339A                          3170  INSUPD
0000339A                          3171  ; INSTRUCTIONS SCREEN UPDATE
0000339A                          3172  ; INPUT    : NONE
0000339A                          3173  ; OUTPUT   : NONE
0000339A                          3174  ; MODIFIES : NONE
0000339A                          3175  ; ------------------------------------------------------------------------------
0000339A  0839 0004 00003F6B      3176              BTST.B  #4,(KBDEDGE)
000033A2  6700 000A               3177              BEQ     .CONT
000033A6  4279 00003F42           3178              CLR.W   (STANEXT)
000033AC  4E75                    3179              RTS
000033AE                          3180  .CONT       
000033AE  1E3C 0001               3181              MOVE.B  #SNDINSTR,D7
000033B2  4E43                    3182              TRAP    #SNDPLTN
000033B4  4E75                    3183              RTS
000033B6                          3184  
000033B6                          3185  
000033B6                          3186  
000033B6                          3187  
000033B6                          3188  
000033B6                          3189  
000033B6                          3190  
000033B6                          3191  
000033B6                          3192  
000033B6                          3193  -------------------- end include --------------------
000033B6                          3194          INCLUDE "WIN.X68"
000033B6                          3195  ; ==============================================================================
000033B6                          3196  ; VICTORY SCREEN
000033B6                          3197  ; ==============================================================================
000033B6                          3198  
000033B6                          3199  ; ------------------------------------------------------------------------------
000033B6                          3200  WININIT
000033B6                          3201  ; VICTORY SCREEN INIT
000033B6                          3202  ; INPUT    : NONE
000033B6                          3203  ; OUTPUT   : NONE
000033B6                          3204  ; MODIFIES : NONE
000033B6                          3205  ; ------------------------------------------------------------------------------
000033B6                          3206  
000033B6  33FC 0000 00003F46      3207              MOVE.W  #0,(DOPLOT)
000033BE  48E7 C0E0               3208              MOVEM.L D0-D1/A0-A2,-(A7)
000033C2                          3209              
000033C2  223C 000098AD           3210              MOVE.L  #$000098AD,D1           ; COLOR FONDO
000033C8  103C 0051               3211              MOVE.B  #81,D0
000033CC  4E4F                    3212              TRAP    #15
000033CE                          3213  
000033CE  7200                    3214              MOVE.L  #0,D1
000033D0  7400                    3215              MOVE.L  #0,D2
000033D2  263C 00000280           3216              MOVE.L  #SCRWIDTH,D3
000033D8  283C 000001E0           3217              MOVE.L  #SCRHEIGH,D4
000033DE  103C 0057               3218              MOVE.B  #87,D0
000033E2  4E4F                    3219              TRAP    #15
000033E4                          3220              
000033E4  41F9 0018A986           3221              LEA     WINDATA,A0
000033EA                          3222              
000033EA  34BC 0032               3223              MOVE.W  #WINWIDTH/2,(A2)
000033EE  357C 0028 0002          3224              MOVE.W  #WINHEIGH/2,2(A2)
000033F4                          3225              
000033F4  4EB8 18CA               3226              JSR     IMAPLOT
000033F8                          3227              
000033F8  41F9 0000341C           3228              LEA     .TXT1,A0
000033FE  103C 000A               3229              MOVE.B  #10,D0
00003402  4EB8 1582               3230              JSR     UTLPRINT
00003406                          3231  
00003406  41F9 00003429           3232              LEA     .TXT2,A0
0000340C  103C 0014               3233              MOVE.B  #20,D0
00003410  4EB8 1582               3234              JSR     UTLPRINT
00003414                          3235              
00003414  4CDF 0703               3236              MOVEM.L (A7)+,D0-D1/A0-A2
00003418                          3237              
00003418  4E40                    3238              TRAP    #SCRUPTN
0000341A                          3239  
0000341A  4E75                    3240              RTS
0000341C                          3241              
0000341C= A1 48 41 53 20 47 ...   3242  .TXT1       DC.B    '¡HAS GANADO!',0
00003429= A1 50 52 45 53 49 ...   3243  .TXT2       DC.B    '¡PRESIONA LA BARRA ESPACIADORA PARA VOLVER AL MENÚ PRINCIPAL!',0
00003468                          3244              DS.W    0
00003468                          3245  
00003468                          3246  ; ------------------------------------------------------------------------------
00003468                          3247  WINUPD
00003468                          3248  ; VICTORY SCREEN UPDATE
00003468                          3249  ; INPUT    : NONE
00003468                          3250  ; OUTPUT   : NONE
00003468                          3251  ; MODIFIES : NONE
00003468                          3252  ; ------------------------------------------------------------------------------
00003468                          3253              
00003468  0839 0004 00003F6B      3254              BTST.B  #4,(KBDEDGE)
00003470  6700 000A               3255              BEQ     .CONT
00003474  4279 00003F42           3256              CLR.W   (STANEXT)
0000347A  4E75                    3257              RTS
0000347C                          3258  
0000347C  1E3C 0007               3259  .CONT       MOVE.B  #SNDWIN,D7
00003480  4E43                    3260              TRAP    #SNDPLTN
00003482  4E75                    3261              RTS
00003484                          3262  
00003484                          3263  
00003484                          3264  
00003484                          3265  
00003484                          3266  
00003484                          3267  
00003484                          3268  
00003484                          3269  
00003484                          3270  
00003484                          3271  
00003484                          3272  
00003484                          3273  
00003484                          3274  -------------------- end include --------------------
00003484                          3275          INCLUDE "GOVER.X68"
00003484                          3276  ; ==============================================================================
00003484                          3277  ; GAME OVER SCREEN
00003484                          3278  ; ==============================================================================
00003484                          3279  
00003484                          3280  ; ------------------------------------------------------------------------------
00003484                          3281  GOVINIT
00003484                          3282  ; GAME OVER SCREEN INIT
00003484                          3283  ; INPUT    : NONE
00003484                          3284  ; OUTPUT   : NONE
00003484                          3285  ; MODIFIES : NONE
00003484                          3286  ; ------------------------------------------------------------------------------
00003484                          3287  
00003484  33FC 0000 00003F46      3288              MOVE.W  #0,(DOPLOT)
0000348C  48E7 C080               3289              MOVEM.L D0-D1/A0,-(A7)
00003490                          3290              
00003490  223C 00101060           3291              MOVE.L  #$00101060,D1           ; COLOR FONDO
00003496  103C 0051               3292              MOVE.B  #81,D0
0000349A  4E4F                    3293              TRAP    #15
0000349C                          3294  
0000349C  7200                    3295              MOVE.L  #0,D1
0000349E  7400                    3296              MOVE.L  #0,D2
000034A0  263C 00000280           3297              MOVE.L  #SCRWIDTH,D3
000034A6  283C 000001E0           3298              MOVE.L  #SCRHEIGH,D4
000034AC  103C 0057               3299              MOVE.B  #87,D0
000034B0  4E4F                    3300              TRAP    #15
000034B2                          3301  
000034B2  41F9 000034D6           3302              LEA     .TXT1,A0
000034B8  103C 000A               3303              MOVE.B  #10,D0
000034BC  4EB8 1582               3304              JSR     UTLPRINT
000034C0                          3305              
000034C0  41F9 000034E3           3306              LEA     .TXT2,A0
000034C6  103C 0019               3307              MOVE.B  #25,D0
000034CA  4EB8 1582               3308              JSR     UTLPRINT
000034CE                          3309              
000034CE  4CDF 0103               3310              MOVEM.L (A7)+,D0-D1/A0
000034D2  4E40                    3311              TRAP    #SCRUPTN
000034D4                          3312  
000034D4  4E75                    3313              RTS
000034D6                          3314              
000034D6= 47 41 4D 45 20 4F ...   3315  .TXT1       DC.B    'GAME OVER :(',0
000034E3= A1 50 52 45 53 49 ...   3316  .TXT2       DC.B    '¡PRESIONA LA BARRA ESPACIADORA PARA CONTINUAR!',0
00003512                          3317              DS.W    0
00003512                          3318  
00003512                          3319  ; ------------------------------------------------------------------------------
00003512                          3320  GOVUPD
00003512                          3321  ; GAME OVER SCREEN UPDATE
00003512                          3322  ; INPUT    : NONE
00003512                          3323  ; OUTPUT   : NONE
00003512                          3324  ; MODIFIES : NONE
00003512                          3325  ; ------------------------------------------------------------------------------
00003512                          3326              
00003512  1E3C 0006               3327              MOVE.B  #SNDGVR1,D7
00003516  4E43                    3328              TRAP    #SNDPLTN
00003518  0839 0004 00003F6B      3329              BTST.B  #4,(KBDEDGE)
00003520  6700 000A               3330              BEQ     .CONT
00003524  4279 00003F42           3331              CLR.W   (STANEXT)
0000352A  4E75                    3332              RTS
0000352C                          3333  
0000352C                          3334  .CONT       ;MOVE.B  #SNDGVR2,D7
0000352C                          3335              ;TRAP    #SNDPLTN
0000352C  4E75                    3336              RTS
0000352E                          3337  
0000352E                          3338  
0000352E                          3339  
0000352E                          3340  
0000352E                          3341  
0000352E                          3342  
0000352E                          3343  
0000352E                          3344  
0000352E                          3345  -------------------- end include --------------------
0000352E                          3346          INCLUDE "STATES.X68"
0000352E                          3347  ; =============================================================================
0000352E                          3348  ; GAME STATE MANAGEMENT
0000352E                          3349  ; =============================================================================
0000352E                          3350  
0000352E                          3351  ; -----------------------------------------------------------------------------
0000352E                          3352  STAINIT
0000352E                          3353  ; INITALIZES THE STATE MANAGER
0000352E                          3354  ; INPUT    - NONE
0000352E                          3355  ; OUTPUT   - NONE
0000352E                          3356  ; MODIFIES - NONE
0000352E                          3357  ; -----------------------------------------------------------------------------
0000352E  33FC 0000 00003F66      3358              MOVE.W  #0,(DEMO)
00003536  33FC FFFF 00003F40      3359              MOVE.W  #STANONE,(STACUR)
0000353E  4279 00003F42           3360              CLR.W   (STANEXT)
00003544  4E75                    3361              RTS
00003546                          3362  
00003546                          3363  ; -----------------------------------------------------------------------------
00003546                          3364  STAUPD
00003546                          3365  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00003546                          3366  ; INPUT    - NONE
00003546                          3367  ; OUTPUT   - NONE
00003546                          3368  ; MODIFIES - NONE
00003546                          3369  ; -----------------------------------------------------------------------------
00003546  48E7 8080               3370              MOVEM.L D0/A0,-(A7)
0000354A  4280                    3371              CLR.L   D0
0000354C  3039 00003F42           3372              MOVE.W  (STANEXT),D0
00003552  B079 00003F40           3373              CMP.W   (STACUR),D0
00003558  6700 0012               3374              BEQ     .DOUPD
0000355C  33C0 00003F40           3375              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00003562  E588                    3376              LSL.L   #2,D0
00003564  2040                    3377              MOVE.L  D0,A0
00003566  2068 3584               3378              MOVE.L  .INITBL(A0),A0
0000356A  4E90                    3379              JSR     (A0)
0000356C  4280                    3380  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000356E  3039 00003F40           3381              MOVE.W  (STACUR),D0
00003574  E588                    3382              LSL.L   #2,D0
00003576  2040                    3383              MOVE.L  D0,A0
00003578  2068 3598               3384              MOVE.L  .UPDTBL(A0),A0
0000357C  4E90                    3385              JSR     (A0)
0000357E  4CDF 0101               3386              MOVEM.L (A7)+,D0/A0
00003582  4E75                    3387              RTS
00003584= 0000303E 0000319A ...   3388  .INITBL     DC.L    ISCINIT,INSINIT,GAMINIT,WININIT,GOVINIT
00003598= 00003142 0000339A ...   3389  .UPDTBL     DC.L    ISCUPD,INSUPD,GAMUPD,WINUPD,GOVUPD
000035AC                          3390  
000035AC                          3391  ; -----------------------------------------------------------------------------
000035AC                          3392  STAPLOT
000035AC                          3393  ; PERFORMS STATE PLOT
000035AC                          3394  ; INPUT    - NONE
000035AC                          3395  ; OUTPUT   - NONE
000035AC                          3396  ; MODIFIES - NONE
000035AC                          3397  ; -----------------------------------------------------------------------------
000035AC  48E7 8080               3398              MOVEM.L D0/A0,-(A7)
000035B0  4280                    3399              CLR.L   D0
000035B2  3039 00003F40           3400              MOVE.W  (STACUR),D0
000035B8  E588                    3401              LSL.L   #2,D0
000035BA  2040                    3402              MOVE.L  D0,A0
000035BC  2068 35C8               3403              MOVE.L  .PLTTBL(A0),A0
000035C0  4E90                    3404              JSR     (A0)
000035C2  4CDF 0101               3405              MOVEM.L (A7)+,D0/A0
000035C6  4E75                    3406              RTS
000035C8= 000035DC 000035DC ...   3407  .PLTTBL     DC.L    STAEMPTY,STAEMPTY,GAMPLOT,STAEMPTY,STAEMPTY
000035DC                          3408  
000035DC                          3409  ; -----------------------------------------------------------------------------
000035DC                          3410  STAEMPTY
000035DC                          3411  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000035DC                          3412  ; INPUT    - NONE
000035DC                          3413  ; OUTPUT   - NONE
000035DC                          3414  ; MODIFIES - NONE
000035DC                          3415  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000035DC                          3416  ; -----------------------------------------------------------------------------
000035DC  4E75                    3417              RTS
000035DE                          3418  
000035DE                          3419  
000035DE                          3420  
000035DE                          3421  
000035DE                          3422  
000035DE                          3423  
000035DE                          3424  
000035DE                          3425  
000035DE                          3426  
000035DE                          3427  
000035DE                          3428  
000035DE                          3429  -------------------- end include --------------------
000035DE                          3430          INCLUDE "LOADFILES.X68"
000035DE                          3431  ; ------------------------------------------------------------------------------
000035DE                          3432  LOADFILES
000035DE                          3433  ; CARGA TODOS LOS ARCHIVOS NECESARIOS DEL JUEGO. EL PRIMERO ES LA IMAGEN DE LA
000035DE                          3434  ; PANTALLA PRINCIPAL, LOS 16 CONSECUTIVOS SON LAS IMÁGENES DEL JUGADOR Y LOS 16
000035DE                          3435  ; SIGUIENTES SON LAS IMÁGENES DEL ENEMIGO
000035DE                          3436  ; INPUT    : NONE
000035DE                          3437  ; OUTPUT   : NONE
000035DE                          3438  ; MODIFIES : NONE
000035DE                          3439  ; ------------------------------------------------------------------------------
000035DE  48E7 00C0               3440              MOVEM.L  A0-A1,-(A7)            
000035E2                          3441  
000035E2  41F9 00003F86           3442              LEA     FILEDATA,A0             ; DIRECCIÓN DE DESTINO
000035E8  43F9 00003808           3443              LEA     .FILENAME,A1            ; NOMBRE DEL ARCHIVO
000035EE  4EB8 1B1C               3444              JSR     FILLOAD
000035F2                          3445              
000035F2  41F9 0018A986           3446              LEA     WINDATA,A0
000035F8  43F9 0000382B           3447              LEA     .FILEWIN,A1
000035FE  4EB8 1B1C               3448              JSR     FILLOAD
00003602                          3449              
00003602  41F9 001B1A86           3450              LEA     DATPLXE,A0       
00003608  43F9 0000384D           3451              LEA     .FILPLXE,A1           
0000360E  4EB8 1B1C               3452              JSR     FILLOAD
00003612                          3453              
00003612  41F9 001B2A26           3454              LEA     DATPLXN,A0
00003618  43F9 0000387F           3455              LEA     .FILPLXN,A1
0000361E  4EB8 1B1C               3456              JSR     FILLOAD
00003622                          3457              
00003622  41F9 001B39C6           3458              LEA     DATPLXNE,A0
00003628  43F9 000038B1           3459              LEA     .FILPLXNE,A1           
0000362E  4EB8 1B1C               3460              JSR     FILLOAD
00003632                          3461              
00003632  41F9 001B4966           3462              LEA     DATPLXNW,A0 
00003638  43F9 000038E4           3463              LEA     .FILPLXNW,A1
0000363E  4EB8 1B1C               3464              JSR     FILLOAD
00003642                          3465              
00003642  41F9 001B5906           3466              LEA     DATPLXS,A0            
00003648  43F9 00003917           3467              LEA     .FILPLXS,A1           
0000364E  4EB8 1B1C               3468              JSR     FILLOAD
00003652                          3469              
00003652  41F9 001B68A6           3470              LEA     DATPLXSE,A0            
00003658  43F9 00003949           3471              LEA     .FILPLXSE,A1           
0000365E  4EB8 1B1C               3472              JSR     FILLOAD
00003662                          3473              
00003662  41F9 001B7846           3474              LEA     DATPLXSW,A0            
00003668  43F9 0000397C           3475              LEA     .FILPLXSW,A1           
0000366E  4EB8 1B1C               3476              JSR     FILLOAD
00003672                          3477              
00003672  41F9 001B87E6           3478              LEA     DATPLXW,A0            
00003678  43F9 000039AF           3479              LEA     .FILPLXW,A1           
0000367E  4EB8 1B1C               3480              JSR     FILLOAD
00003682                          3481              
00003682  41F9 001B9786           3482              LEA     DATPLYE,A0            
00003688  43F9 000039E1           3483              LEA     .FILPLYE,A1           
0000368E  4EB8 1B1C               3484              JSR     FILLOAD
00003692                          3485              
00003692  41F9 001BA726           3486              LEA     DATPLYN,A0            
00003698  43F9 00003A13           3487              LEA     .FILPLYN,A1           
0000369E  4EB8 1B1C               3488              JSR     FILLOAD
000036A2                          3489              
000036A2  41F9 001BB6C6           3490              LEA     DATPLYNE,A0            
000036A8  43F9 00003A45           3491              LEA     .FILPLYNE,A1           
000036AE  4EB8 1B1C               3492              JSR     FILLOAD
000036B2                          3493              
000036B2  41F9 001BC666           3494              LEA     DATPLYNW,A0            
000036B8  43F9 00003A78           3495              LEA     .FILPLYNW,A1           
000036BE  4EB8 1B1C               3496              JSR     FILLOAD
000036C2                          3497              
000036C2  41F9 001BD606           3498              LEA     DATPLYS,A0            
000036C8  43F9 00003AAB           3499              LEA     .FILPLYS,A1           
000036CE  4EB8 1B1C               3500              JSR     FILLOAD
000036D2                          3501              
000036D2  41F9 001BE5A6           3502              LEA     DATPLYSE,A0            
000036D8  43F9 00003ADD           3503              LEA     .FILPLYSE,A1           
000036DE  4EB8 1B1C               3504              JSR     FILLOAD
000036E2                          3505              
000036E2  41F9 001BF546           3506              LEA     DATPLYSW,A0            
000036E8  43F9 00003B10           3507              LEA     .FILPLYSW,A1           
000036EE  4EB8 1B1C               3508              JSR     FILLOAD
000036F2                          3509              
000036F2  41F9 001C04E6           3510              LEA     DATPLYW,A0           
000036F8  43F9 00003B43           3511              LEA     .FILPLYW,A1           
000036FE  4EB8 1B1C               3512              JSR     FILLOAD
00003702                          3513              
00003702  41F9 001C1486           3514              LEA     DATENXE,A0            
00003708  43F9 00003B75           3515              LEA     .FILENXE,A1           
0000370E  4EB8 1B1C               3516              JSR     FILLOAD
00003712                          3517              
00003712  41F9 001C2426           3518              LEA     DATENXN,A0            
00003718  43F9 00003BA5           3519              LEA     .FILENXN,A1           
0000371E  4EB8 1B1C               3520              JSR     FILLOAD
00003722                          3521              
00003722  41F9 001C33C6           3522              LEA     DATENXNE,A0            
00003728  43F9 00003BD5           3523              LEA     .FILENXNE,A1           
0000372E  4EB8 1B1C               3524              JSR     FILLOAD
00003732                          3525              
00003732  41F9 001C4366           3526              LEA     DATENXNW,A0            
00003738  43F9 00003C06           3527              LEA     .FILENXNW,A1           
0000373E  4EB8 1B1C               3528              JSR     FILLOAD
00003742                          3529              
00003742  41F9 001C5306           3530              LEA     DATENXS,A0           
00003748  43F9 00003C37           3531              LEA     .FILENXS,A1           
0000374E  4EB8 1B1C               3532              JSR     FILLOAD
00003752                          3533              
00003752  41F9 001C62A6           3534              LEA     DATENXSE,A0            
00003758  43F9 00003C67           3535              LEA     .FILENXSE,A1           
0000375E  4EB8 1B1C               3536              JSR     FILLOAD
00003762                          3537              
00003762  41F9 001C7246           3538              LEA     DATENXSW,A0            
00003768  43F9 00003C98           3539              LEA     .FILENXSW,A1           
0000376E  4EB8 1B1C               3540              JSR     FILLOAD
00003772                          3541              
00003772  41F9 001C81E6           3542              LEA     DATENXW,A0            
00003778  43F9 00003CC9           3543              LEA     .FILENXW,A1           
0000377E  4EB8 1B1C               3544              JSR     FILLOAD
00003782                          3545              
00003782  41F9 001C9186           3546              LEA     DATENYE,A0            
00003788  43F9 00003CF9           3547              LEA     .FILENYE,A1           
0000378E  4EB8 1B1C               3548              JSR     FILLOAD
00003792                          3549              
00003792  41F9 001CA126           3550              LEA     DATENYN,A0           
00003798  43F9 00003D29           3551              LEA     .FILENYN,A1          
0000379E  4EB8 1B1C               3552              JSR     FILLOAD
000037A2                          3553              
000037A2  41F9 001CB0C6           3554              LEA     DATENYNE,A0           
000037A8  43F9 00003D59           3555              LEA     .FILENYNE,A1           
000037AE  4EB8 1B1C               3556              JSR     FILLOAD
000037B2                          3557              
000037B2  41F9 001CC066           3558              LEA     DATENYNW,A0            
000037B8  43F9 00003D8A           3559              LEA     .FILENYNW,A1           
000037BE  4EB8 1B1C               3560              JSR     FILLOAD
000037C2                          3561              
000037C2  41F9 001CD006           3562              LEA     DATENYS,A0            
000037C8  43F9 00003DBB           3563              LEA     .FILENYS,A1           
000037CE  4EB8 1B1C               3564              JSR     FILLOAD
000037D2                          3565              
000037D2  41F9 001CDFA6           3566              LEA     DATENYSE,A0           
000037D8  43F9 00003DEB           3567              LEA     .FILENYSE,A1           
000037DE  4EB8 1B1C               3568              JSR     FILLOAD
000037E2                          3569              
000037E2  41F9 001CEF46           3570              LEA     DATENYSW,A0            
000037E8  43F9 00003E1C           3571              LEA     .FILENYSW,A1           
000037EE  4EB8 1B1C               3572              JSR     FILLOAD
000037F2                          3573              
000037F2  41F9 001CFEE6           3574              LEA     DATENYW,A0            
000037F8  43F9 00003E4D           3575              LEA     .FILENYW,A1           
000037FE  4EB8 1B1C               3576              JSR     FILLOAD
00003802                          3577  
00003802  4CDF 0300               3578              MOVEM.L  (A7)+,A0-A1
00003806                          3579              
00003806  4E75                    3580              RTS
00003808                          3581              
00003808= 70 79 74 68 6F 6E ...   3582  .FILENAME       DC.B    'pythonProject/OUTPUT/MENUIMAGE.bin',0 
0000382B= 70 79 74 68 6F 6E ...   3583  .FILEWIN        DC.B    'pythonProject/OUTPUT/WINIMAGE.bin',0
0000384D= 70 79 74 68 6F 6E ...   3584  .FILPLXE        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_E.bin',0
0000387F= 70 79 74 68 6F 6E ...   3585  .FILPLXN        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_N.bin',0
000038B1= 70 79 74 68 6F 6E ...   3586  .FILPLXNE       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_NE.bin',0
000038E4= 70 79 74 68 6F 6E ...   3587  .FILPLXNW       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_NW.bin',0
00003917= 70 79 74 68 6F 6E ...   3588  .FILPLXS        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_S.bin',0
00003949= 70 79 74 68 6F 6E ...   3589  .FILPLXSE       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_SE.bin',0
0000397C= 70 79 74 68 6F 6E ...   3590  .FILPLXSW       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_SW.bin',0
000039AF= 70 79 74 68 6F 6E ...   3591  .FILPLXW        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_X_W.bin',0
000039E1= 70 79 74 68 6F 6E ...   3592  .FILPLYE        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_E.bin',0
00003A13= 70 79 74 68 6F 6E ...   3593  .FILPLYN        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_N.bin',0
00003A45= 70 79 74 68 6F 6E ...   3594  .FILPLYNE       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_NE.bin',0
00003A78= 70 79 74 68 6F 6E ...   3595  .FILPLYNW       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_NW.bin',0
00003AAB= 70 79 74 68 6F 6E ...   3596  .FILPLYS        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_S.bin',0
00003ADD= 70 79 74 68 6F 6E ...   3597  .FILPLYSE       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_SE.bin',0
00003B10= 70 79 74 68 6F 6E ...   3598  .FILPLYSW       DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_SW.bin',0
00003B43= 70 79 74 68 6F 6E ...   3599  .FILPLYW        DC.B    'pythonProject/OUTPUT/PLAYER_OUTPUT/PLAYER_Y_W.bin',0
00003B75= 70 79 74 68 6F 6E ...   3600  .FILENXE        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_E.bin',0
00003BA5= 70 79 74 68 6F 6E ...   3601  .FILENXN        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_N.bin',0
00003BD5= 70 79 74 68 6F 6E ...   3602  .FILENXNE       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_NE.bin',0
00003C06= 70 79 74 68 6F 6E ...   3603  .FILENXNW       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_NW.bin',0
00003C37= 70 79 74 68 6F 6E ...   3604  .FILENXS        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_S.bin',0
00003C67= 70 79 74 68 6F 6E ...   3605  .FILENXSE       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_SE.bin',0
00003C98= 70 79 74 68 6F 6E ...   3606  .FILENXSW       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_SW.bin',0
00003CC9= 70 79 74 68 6F 6E ...   3607  .FILENXW        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_X_W.bin',0
00003CF9= 70 79 74 68 6F 6E ...   3608  .FILENYE        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_E.bin',0
00003D29= 70 79 74 68 6F 6E ...   3609  .FILENYN        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_N.bin',0
00003D59= 70 79 74 68 6F 6E ...   3610  .FILENYNE       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_NE.bin',0
00003D8A= 70 79 74 68 6F 6E ...   3611  .FILENYNW       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_NW.bin',0
00003DBB= 70 79 74 68 6F 6E ...   3612  .FILENYS        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_S.bin',0
00003DEB= 70 79 74 68 6F 6E ...   3613  .FILENYSE       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_SE.bin',0
00003E1C= 70 79 74 68 6F 6E ...   3614  .FILENYSW       DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_SW.bin',0
00003E4D= 70 79 74 68 6F 6E ...   3615  .FILENYW        DC.B    'pythonProject/OUTPUT/ENEMY_OUTPUT/ENEMY_Y_W.bin',0
00003E7E                          3616                  DS.W    0
00003E7E                          3617              
00003E7E                          3618  
00003E7E                          3619  
00003E7E                          3620  -------------------- end include --------------------
00003E7E                          3621          
00003E7E                          3622  START:
00003E7E                          3623  
00003E7E                          3624  ; --- INITIALIZATION ---------------------------------------
00003E7E                          3625  
00003E7E  007C 0700               3626              ORI.W   #$0700,SR               ; DESHABILITAR INTERRUPCIONES
00003E82                          3627              
00003E82  4EB8 10C2               3628              JSR     SYSINIT
00003E86  4EB8 2DDC               3629              JSR     FPSINIT
00003E8A  4EB8 156C               3630              JSR     UTLINIT
00003E8E                          3631              
00003E8E  223C 00054B17           3632              MOVE.L  #$00054B17,D1           ; COLOR FONDO
00003E94  103C 0051               3633              MOVE.B  #81,D0
00003E98  4E4F                    3634              TRAP    #15
00003E9A                          3635  
00003E9A  7200                    3636              MOVE.L  #0,D1
00003E9C  7400                    3637              MOVE.L  #0,D2
00003E9E  263C 00000280           3638              MOVE.L  #SCRWIDTH,D3
00003EA4  283C 000001E0           3639              MOVE.L  #SCRHEIGH,D4
00003EAA  103C 0057               3640              MOVE.B  #87,D0
00003EAE  4E4F                    3641              TRAP    #15
00003EB0                          3642  
00003EB0  41F9 00003F28           3643              LEA     .TXT,A0                 ; TEXTO DE LA PANTALLA DE CARGA
00003EB6  103C 000F               3644              MOVE.B  #15,D0
00003EBA  4EB8 1582               3645              JSR     UTLPRINT
00003EBE                          3646              
00003EBE  4EB8 35DE               3647              JSR     LOADFILES
00003EC2                          3648              
00003EC2  4EB8 352E               3649              JSR     STAINIT    
00003EC6                          3650  
00003EC6                          3651  ; --- UPDATE -----------------------------------------------
00003EC6                          3652  
00003EC6                          3653  .LOOP
00003EC6                          3654  
00003EC6                          3655  ; LEER DISPOSITIVOS DE ENTRADA
00003EC6  4E41                    3656              TRAP    #KBDUPTN
00003EC8                          3657  
00003EC8                          3658  ; ACTUALIZAR LÓGICA DEL JUEGO
00003EC8  4EB8 3546               3659              JSR     STAUPD
00003ECC  4EB8 2DE4               3660              JSR     FPSUPD
00003ED0                          3661              
00003ED0                          3662  ; --- SYNC -------------------------------------------------
00003ED0                          3663  
00003ED0  4A39 00003F78           3664  .WINT       TST.B   (SCRINTCT)
00003ED6  67F8                    3665              BEQ     .WINT
00003ED8  4239 00003F78           3666              CLR.B   (SCRINTCT)
00003EDE                          3667  
00003EDE                          3668  
00003EDE                          3669  ; --- PLOT -------------------------------------------------
00003EDE                          3670              
00003EDE  0C79 0000 00003F46      3671              CMP.W   #0,(DOPLOT)
00003EE6  6700 003E               3672              BEQ     .NOTPLOT 
00003EEA                          3673  
00003EEA  3C39 00003F84           3674              MOVE.W  SHWFPS,D6
00003EF0  BC7C 0014               3675              CMP.W   #20,D6
00003EF4  6200 0026               3676              BHI     .DOPLOT
00003EF8                          3677              
00003EF8                          3678              ; LOW FPS (FPS <= 20)
00003EF8  BC7C 000F               3679              CMP.W   #15,D6
00003EFC  6300 0012               3680              BLS     .SOLOWFPS
00003F00  0839 0010 00003F79      3681              BTST    #16,(SCRCYCCT)
00003F08  6700 001C               3682              BEQ     .NOTPLOT
00003F0C  6600 000E               3683              BNE     .DOPLOT   
00003F10                          3684              
00003F10                          3685  .SOLOWFPS   ; SO LOW FPS (FPS <= 15)
00003F10  0839 0008 00003F79      3686              BTST    #8,(SCRCYCCT)    
00003F18  6700 000C               3687              BEQ     .NOTPLOT        
00003F1C                          3688  .DOPLOT            
00003F1C  4EB8 35AC               3689              JSR     STAPLOT
00003F20  4EB8 2E24               3690              JSR     FPSPLOT 
00003F24                          3691   
00003F24  4E40                    3692              TRAP    #SCRUPTN                ; ACTUALIZAR DOUBLE BUFFER
00003F26                          3693  .NOTPLOT
00003F26                          3694  
00003F26  609E                    3695              BRA     .LOOP   
00003F28                          3696  
00003F28= 43 41 52 47 41 4E ...   3697  .TXT        DC.B    'CARGANDO...',0
00003F34                          3698              DS.W    0         
00003F34                          3699  
00003F34  FFFF FFFF               3700              SIMHALT
00003F38                          3701      
00003F38                          3702              INCLUDE "VARS.X68"  
00003F38                          3703  
00003F38                          3704  ; --- VARIABLES RELACIONADAS CON EL MARCADOR ---------------
00003F38                          3705  
00003F38                          3706  SCORE       DS.W    1       ; NÚMERO DE TANQUES DESTRUIDOS // (cuidado con si llega a superar 255) // podríamos hacer que se multiplique cada puntuación de tanque destruido con una cte relacionada con el tanque (diferentes tipos de tanque?)
00003F3A                          3707  
00003F3A                          3708  ; --- VARIABLES RELACIONADAS CON EL MAPA -------------------
00003F3A                          3709  
00003F3A                          3710  LVLNUM      DS.W    1       ; NÚMERO DEL NIVEL
00003F3C                          3711  
00003F3C                          3712  ; --- VARIABLES RELACIONADAS CON EL TANQUE -----------------
00003F3C                          3713  
00003F3C                          3714  TANID       DS.W    1
00003F3E                          3715  
00003F3E                          3716  ; -- VARIABLES RELACIONADAS CON EL ESTADO DE INTRODUCCIÓN --
00003F3E                          3717  
00003F3E                          3718  ISCTIMER    DS.W    1       ; INTRO TIMER
00003F40                          3719  
00003F40                          3720  ; --- VARIABLES RELACIONADAS CON LOS ESTADOS ---------------
00003F40                          3721  
00003F40                          3722  STACUR      DS.W    1       ; ESTADO ACTUAL
00003F42                          3723  STANEXT     DS.W    1       ; SIGUIENTE ESTADO
00003F44                          3724  
00003F44                          3725  ; --- VARIABLES RELACIONADAS CON LA DERROTA ----------------
00003F44                          3726  
00003F44                          3727  PLYRDEAD    DS.W    1       ; PLAYER MUERTO
00003F46                          3728  
00003F46                          3729  ; --- VARIABLES RELACIONADAS CON EL PLOT -------------------
00003F46                          3730  
00003F46                          3731  DOPLOT      DS.W    1
00003F48                          3732  
00003F48                          3733  ; --- VARIABLES RELACIONADAS CON LA BALA -------------------
00003F48                          3734  
00003F48                          3735  BULVELY     DS.W    1
00003F4A                          3736  BULVELX     DS.W    1
00003F4C                          3737  BULPOSORGY  DS.W    1
00003F4E                          3738  BULPOSORGX  DS.W    1
00003F50                          3739  
00003F50                          3740  ; --- VARIABLES RELACIONADAS CON POSICIONES DE TANQUES -----
00003F50                          3741  
00003F50                          3742  PLAYPOSX    DS.W    1
00003F52                          3743  PLAYPOSY    DS.W    1
00003F54                          3744  ENEMPOSX    DS.W    1
00003F56                          3745  ENEMPOSY    DS.W    1
00003F58                          3746  POSXTEMP    DS.W    1       ; POSICIÓN TEMPORAL DE UN TANQUE
00003F5A                          3747  POSYTEMP    DS.W    1
00003F5C                          3748  MOVXTEMP    DS.W    1
00003F5E                          3749  MOVYTEMP    DS.W    1
00003F60                          3750  COLTANKP    DS.W    1
00003F62                          3751  
00003F62                          3752  ; --- VARIABLES RELACIONADAS CON EL DIBUJADO DEL TANQUE ----
00003F62                          3753  
00003F62                          3754  PLCANPOS    DS.W    1       ; TANK AND CANNON POSITION OF PLAYER
00003F64                          3755  ENCANPOS    DS.W    1       ; TANK AND CANNON POSITION OF ENEMY
00003F66                          3756  
00003F66                          3757  ; --- VARIABLES RELACIONADAS CON LA DEMO -------------------
00003F66                          3758  
00003F66                          3759  DEMO        DS.W    1       ; SI VALE 1, ESTAMOS EN LA DEMO, SI VALE 0 NO
00003F68                          3760  
00003F68                          3761  
00003F68                          3762  
00003F68                          3763  
00003F68                          3764  
00003F68                          3765  
00003F68                          3766  
00003F68                          3767  
00003F68                          3768  
00003F68                          3769  
00003F68                          3770  
00003F68                          3771  
00003F68                          3772  
00003F68                          3773  
00003F68                          3774  
00003F68                          3775  -------------------- end include --------------------
00003F68                          3776              INCLUDE "LIB/UTLVARS.X68"
00003F68                          3777  ; =============================================================================
00003F68                          3778  ; UTILITY VARIABLES
00003F68                          3779  ; =============================================================================
00003F68                          3780  
00003F68                          3781  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00003F6A                          3782              DS.W    0
00003F6A                          3783  -------------------- end include --------------------
00003F6A                          3784              INCLUDE "SYSVARS.X68"
00003F6A                          3785  
00003F6A                          3786  
00003F6A                          3787  ; --- KEYBOARD RELATED VARIABLES ---------------------------
00003F6A                          3788  
00003F6A                          3789  KBDVAL      DS.B    1       ; KEY STATE (1 BYTE -> 8 TECLAS MAX)
00003F6B                          3790  KBDEDGE     DS.B    1       ; KEY EDGE
00003F6C                          3791  
00003F6C                          3792  ; --- MOUSE RELATED VARIABLES ------------------------------
00003F6C                          3793  
00003F6C                          3794  MOUEDGE     DS.L    1       ; MOUSE EDGE
00003F70                          3795  MOUBUT      DS.L    1       ; MOUSE LEFT BUTTON
00003F74                          3796  MOUPOS      DS.L    1       ; MOUSE POSITION
00003F78                          3797  
00003F78                          3798  ; --- TIMED INTERRUPT RELATED VARIABLES --------------------
00003F78                          3799  
00003F78                          3800  SCRINTCT    DS.B    1       ; INTERRUPT COUNTER
00003F79                          3801  SCRCYCCT    DS.B    1       ; CYCLE COUNTER
00003F7A                          3802              DS.W    0
00003F7A                          3803  
00003F7A                          3804  ; --- TIME RELATED VARIABLES -------------------------------
00003F7A                          3805  
00003F7A                          3806  TIEMPO      DS.L    2       ; CONTADOR DE TIEMPO
00003F82                          3807  
00003F82                          3808  ; --- FPS RELATED VARIABLES --------------------------------
00003F82                          3809  
00003F82                          3810  ACTFPS      DS.W    1       ; FPS ACTUALES
00003F84                          3811  SHWFPS      DS.W    1       ; FPS PARA MOSTRAR
00003F86                          3812              
00003F86                          3813              
00003F86                          3814  ; --- FILE RELATED VARIABLES -------------------------------
00003F86                          3815  
00003F86                          3816  FILEDATA    DS.L    400000
0018A986                          3817  WINDATA     DS.L    40000
001B1A86                          3818  
001B1A86                          3819  DATPLXE     DS.L    1000    ; IMÁGENES JUGADOR
001B2A26                          3820  DATPLXN     DS.L    1000
001B39C6                          3821  DATPLXNE    DS.L    1000
001B4966                          3822  DATPLXNW    DS.L    1000
001B5906                          3823  DATPLXS     DS.L    1000
001B68A6                          3824  DATPLXSE    DS.L    1000
001B7846                          3825  DATPLXSW    DS.L    1000
001B87E6                          3826  DATPLXW     DS.L    1000
001B9786                          3827  DATPLYE     DS.L    1000
001BA726                          3828  DATPLYN     DS.L    1000
001BB6C6                          3829  DATPLYNE    DS.L    1000
001BC666                          3830  DATPLYNW    DS.L    1000
001BD606                          3831  DATPLYS     DS.L    1000
001BE5A6                          3832  DATPLYSE    DS.L    1000
001BF546                          3833  DATPLYSW    DS.L    1000
001C04E6                          3834  DATPLYW     DS.L    1000
001C1486                          3835  
001C1486                          3836  DATENXE     DS.L    1000    ; IMÁGENES ENEMIGO
001C2426                          3837  DATENXN     DS.L    1000
001C33C6                          3838  DATENXNE    DS.L    1000
001C4366                          3839  DATENXNW    DS.L    1000
001C5306                          3840  DATENXS     DS.L    1000
001C62A6                          3841  DATENXSE    DS.L    1000
001C7246                          3842  DATENXSW    DS.L    1000
001C81E6                          3843  DATENXW     DS.L    1000
001C9186                          3844  DATENYE     DS.L    1000
001CA126                          3845  DATENYN     DS.L    1000
001CB0C6                          3846  DATENYNE    DS.L    1000
001CC066                          3847  DATENYNW    DS.L    1000
001CD006                          3848  DATENYS     DS.L    1000
001CDFA6                          3849  DATENYSE    DS.L    1000
001CEF46                          3850  DATENYSW    DS.L    1000
001CFEE6                          3851  DATENYW     DS.L    1000
001D0E86                          3852  
001D0E86                          3853  
001D0E86                          3854  
001D0E86                          3855  
001D0E86                          3856  
001D0E86                          3857  
001D0E86                          3858  
001D0E86                          3859  
001D0E86                          3860  
001D0E86                          3861  
001D0E86                          3862  
001D0E86                          3863  
001D0E86                          3864  
001D0E86                          3865  -------------------- end include --------------------
001D0E86                          3866              INCLUDE "LIB/DMMVARS.X68"
001D0E86                          3867  ; =============================================================================
001D0E86                          3868  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
001D0E86                          3869  ; =============================================================================
001D0E86                          3870  
001D0EC0                          3871              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
001D0EC0                          3872  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
001D1B40                          3873              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
001D1B40                          3874  -------------------- end include --------------------
001D1B40                          3875  
001D1B40                          3876              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
ACTFPS              3F82
AGLADD              1508
AGLADD:END          151E
AGLKILL             10AC
AGLPLOT             1546
AGLPLOT:END         1566
AGLPLOT:LOOP        154E
AGLUPD              1522
AGLUPD:END          1540
AGLUPD:LOOP         152A
APUNTADOR           1308
APUNTADOR:CONT      1356
APUNTADOR:DEMOPLAY  134A
APUNTADOR:DWRECTES  1402
APUNTADOR:DWRECTSI  13A4
APUNTADOR:DWRECTSS  13CC
APUNTADOR:ENEMY     133A
APUNTADOR:FINAPU    14EA
APUNTADOR:FINENE    1502
APUNTADOR:FINPLY    14FC
APUNTADOR:UPRECTEI  142A
APUNTADOR:UPRECTES  14C6
APUNTADOR:UPRECTSI  1468
APUNTADOR:UPRECTSS  1490
BULDMG              28
BULFCOL             7CB4BA
BULINIT             1B4A
BULINIT:NOTPLAYER   1BA0
BULINIT:SEGBULL     1BAA
BULPCOL             31494D
BULPLOT             1DDC
BULPOSORGX          3F4E
BULPOSORGY          3F4C
BULRAD              4
BULSPEED            7
BULTYPE             1
BULUPD              1BC2
BULUPD:ALIVE        1D78
BULUPD:BULFACHK     1C6E
BULUPD:BULFINAL     1D7E
BULUPD:BULWALL      1CB2
BULUPD:CHKPLAY      1D06
BULUPD:CHKPLAY2     1C98
BULUPD:CHKTAN       1CB8
BULUPD:COLX         1C06
BULUPD:COLY         1C22
BULUPD:DONE         1DD0
BULUPD:END          1DC8
BULUPD:ENDCOLEX     1CAC
BULUPD:ENSNDKIL     1D64
BULUPD:EXPLO        1D3A
BULUPD:GAND4        1C5E
BULUPD:GAND5        1C64
BULUPD:KILLBULL     1DC2
BULUPD:LOOP         1CD4
BULUPD:LOOP21       1D8E
BULUPD:LOOP22       1DA8
BULUPD:LOOP31       1C78
BULUPD:LOOP32       1C92
BULUPD:PLAYBULL     1DAE
BULUPD:SVPNT        1C0E
BULUPD:SVPNT2       1C2A
BULUPD:TRATCOL      1C4C
BULUPD:TRATCOLU     1C32
BULVELX             3F4A
BULVELY             3F48
COLBYKMKZ           19CA
COLBYKMKZ:NTHG1     19F8
COLTANKP            3F60
DATENXE             1C1486
DATENXN             1C2426
DATENXNE            1C33C6
DATENXNW            1C4366
DATENXS             1C5306
DATENXSE            1C62A6
DATENXSW            1C7246
DATENXW             1C81E6
DATENYE             1C9186
DATENYN             1CA126
DATENYNE            1CB0C6
DATENYNW            1CC066
DATENYS             1CD006
DATENYSE            1CDFA6
DATENYSW            1CEF46
DATENYW             1CFEE6
DATPLXE             1B1A86
DATPLXN             1B2A26
DATPLXNE            1B39C6
DATPLXNW            1B4966
DATPLXS             1B5906
DATPLXSE            1B68A6
DATPLXSW            1B7846
DATPLXW             1B87E6
DATPLYE             1B9786
DATPLYN             1BA726
DATPLYNE            1BB6C6
DATPLYNW            1BC666
DATPLYS             1BD606
DATPLYSE            1BE5A6
DATPLYSW            1BF546
DATPLYW             1C04E6
DEMO                3F66
DMMALLOC            1092
DMMALLOC:END        10AA
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1D0EC0
DMMFCOM             106C
DMMFFND             107A
DMMFIRST            1022
DMMFLOOP            1060
DMMFRCOM            1034
DMMFREE             10AC
DMMFRFND            1042
DMMFRLOP            1028
DMMFRSTO            105A
DMMINIT             1000
DMMINIT:LOOP        100E
DMMNEXT             1044
DMMNEXTO            107C
DMMSYSID            0
DOPLOT              3F46
ENCANPOS            3F64
ENEINILF            78
ENEMLVL1            2
ENEMLVL2            6
ENEMLVL3            9
ENEMPOSX            3F54
ENEMPOSY            3F56
ENEMYRTF            64
ENESPEED            1
ENIMASEL            1790
ENIMASEL:ECINCO     187A
ENIMASEL:EENDDCOD   18C4
ENIMASEL:ELOW1      1834
ENIMASEL:ELOW2      17F0
ENIMASEL:ELOW211    1884
ENIMASEL:ELOW3      17D0
ENIMASEL:ELOW31     1814
ENIMASEL:ELOW311    1864
ENIMASEL:ELOW321    18A8
ENIMASEL:ENUEVE     182A
ENIMASEL:EONCE      180A
ENIMASEL:EQUINCE    17C6
ENIMASEL:ESIETE     185A
ENIMASEL:ETRECE     17E6
ENIMASEL:ETRES      189E
ENIMASEL:EUNO       18BE
FILEDATA            3F86
FILLOAD             1B1C
FILLOAD:LOOP        1B2E
FPSINIT             2DDC
FPSLINE1            4000
FPSLINE2            4001
FPSPLOT             2E24
FPSPLOT:ACTUALFPS   2E77
FPSPLOT:GOALFPS     2E68
FPSUPD              2DE4
FPSUPD:END          2E22
GAMINIT             2E86
GAMPLOT             2FA2
GAMPLOT:NODEMO      2FE8
GAMPLOT:TXT1        2FEC
GAMPLOT:TXT2        2FF5
GAMPLOT:TXT3        3005
GAMUPD              2EC0
GAMUPD:CHKLOSS      2F72
GAMUPD:CHKWIN       2F4C
GAMUPD:CONTLVL1     2F12
GAMUPD:DEMOEND      2F3A
GAMUPD:DONE         2FA0
GAMUPD:LVL1         2EFA
GOVINIT             3484
GOVINIT:TXT1        34D6
GOVINIT:TXT2        34E3
GOVUPD              3512
GOVUPD:CONT         352C
IMAHEIGH            180
IMAPLOT             18CA
IMAPLOT:COLUMNA     18F0
IMAPLOT:FILA        18E4
IMAWIDTH            200
INSINIT             319A
INSINIT:LOOP        31E4
INSINIT:LOOPEND     31F2
INSINIT:TXT1        3208
INSINIT:TXT2        3221
INSINIT:TXT3        324B
INSINIT:TXT4        3282
INSINIT:TXT5        32A9
INSINIT:TXT6        32CF
INSINIT:TXT7        32EE
INSINIT:TXT8        3319
INSINIT:TXT9        3342
INSINIT:TXTLST      3372
INSINIT:VOIDTXT     3370
INSUPD              339A
INSUPD:CONT         33AE
ISCINIT             303E
ISCINIT:TXT1        30D8
ISCINIT:TXT2        3105
ISCINIT:TXT3        3120
ISCMAXTM            1F4
ISCTIMER            3F3E
ISCUPD              3142
ISCUPD:CONT1        3158
ISCUPD:CONT2        316E
ISCUPD:DONE         3192
KBDDOWN             53
KBDEDGE             3F6B
KBDFIRE             20
KBDINIT             1242
KBDINSTR            49
KBDLEFT             41
KBDRIGHT            44
KBDUP               57
KBDUPD              1250
KBDUPD:LOOP         1294
KBDUPD:PACK         1290
KBDUPTN             1
KBDVAL              3F6A
KILLBULS            1622
KILLBULS:BULLOOP    162E
KILLBULS:NOBULS     1650
KILLPLYR            1
LOADFILES           35DE
LOADFILES:FILENAME  3808
LOADFILES:FILENXE   3B75
LOADFILES:FILENXN   3BA5
LOADFILES:FILENXNE  3BD5
LOADFILES:FILENXNW  3C06
LOADFILES:FILENXS   3C37
LOADFILES:FILENXSE  3C67
LOADFILES:FILENXSW  3C98
LOADFILES:FILENXW   3CC9
LOADFILES:FILENYE   3CF9
LOADFILES:FILENYN   3D29
LOADFILES:FILENYNE  3D59
LOADFILES:FILENYNW  3D8A
LOADFILES:FILENYS   3DBB
LOADFILES:FILENYSE  3DEB
LOADFILES:FILENYSW  3E1C
LOADFILES:FILENYW   3E4D
LOADFILES:FILEWIN   382B
LOADFILES:FILPLXE   384D
LOADFILES:FILPLXN   387F
LOADFILES:FILPLXNE  38B1
LOADFILES:FILPLXNW  38E4
LOADFILES:FILPLXS   3917
LOADFILES:FILPLXSE  3949
LOADFILES:FILPLXSW  397C
LOADFILES:FILPLXW   39AF
LOADFILES:FILPLYE   39E1
LOADFILES:FILPLYN   3A13
LOADFILES:FILPLYNE  3A45
LOADFILES:FILPLYNW  3A78
LOADFILES:FILPLYS   3AAB
LOADFILES:FILPLYSE  3ADD
LOADFILES:FILPLYSW  3B10
LOADFILES:FILPLYW   3B43
LVL1INIT            2C5C
LVL2INIT            2CBC
LVL3INIT            2D58
LVLNUM              3F3A
MAPDATA             2554
MAPINIT             24AE
MAPINIX             0
MAPINIY             0
MAPPIEX             14
MAPPIEY             F
MAPPLOT             24B2
MAPPLOT:LINEX       24E0
MAPPLOT:LINEY       24D4
MAPPLOT:PARED       251A
MAPPLOT:SOLEADO     2546
MAPUPD              24B0
MAXTOUCH            3
MOUBUT              3F70
MOUEDGE             3F6C
MOUINIT             129E
MOUPOS              3F74
MOUUPD              12AC
MOUUPTN             2
MOVXTEMP            3F5C
MOVYTEMP            3F5E
PIESIZX             20
PIESIZY             20
PLAYPOSX            3F50
PLAYPOSY            3F52
PLCANPOS            3F62
PLIMASEL            1656
PLIMASEL:CINCO      1740
PLIMASEL:ENDDECOD   178A
PLIMASEL:LOW1       16FA
PLIMASEL:LOW2       16B6
PLIMASEL:LOW211     174A
PLIMASEL:LOW3       1696
PLIMASEL:LOW31      16DA
PLIMASEL:LOW311     172A
PLIMASEL:LOW321     176E
PLIMASEL:NUEVE      16F0
PLIMASEL:ONCE       16D0
PLIMASEL:QUINCE     168C
PLIMASEL:SIETE      1720
PLIMASEL:TRECE      16AC
PLIMASEL:TRES       1764
PLIMASEL:UNO        1784
PLMAXBUL            3
PLRINILF            190
PLRINITX            32
PLRINITY            F0
PLRLIFEC            FF
PLRLIFEH            14
PLRLIFEY            1C6
PLRSPEED            2
PLYRALIV            0
PLYRDEAD            3F44
POSXTEMP            3F58
POSYTEMP            3F5A
READMOU             12E0
READMOU:NOCLICKED   1302
RELPOS              15E8
RELPOS:CHKX         1602
RELPOS:CHKY         161A
RELPOS:NOORGX       15F8
RELPOS:NOORGY       160C
SCOFCOL             0
SCOINIT             2468
SCOLINE             0
SCOPLOT             2470
SCOPLOT:TXT         24A0
SCORE               3F38
SCRCYCCT            3F79
SCRFPS              32
SCRHEIGH            1E0
SCRINIT             11E0
SCRINTCT            3F78
SCRINTN             1
SCRPLOT             121A
SCRTIM              1234
SCRUPTN             0
SCRWIDTH            280
SHWFPS              3F84
SIZLVL              258
SNDDISP             5
SNDEXPLO            8
SNDGVR1             6
SNDHIT              3
SNDINIT             1106
SNDINIT:DONE        1124
SNDINIT:LOOP        1112
SNDINIT:SNDDISP     1170
SNDINIT:SNDEXPLO    1198
SNDINIT:SNDGVR1     117D
SNDINIT:SNDHIT      1153
SNDINIT:SNDINSTR    1138
SNDINIT:SNDINTRO    112A
SNDINIT:SNDKILL     115F
SNDINIT:SNDLIST     11A6
SNDINIT:SNDWALL     1146
SNDINIT:SNDWIN      118C
SNDINSTR            1
SNDINTRO            0
SNDKILL             4
SNDPLAY             11CE
SNDPLTN             3
SNDWALL             2
SNDWIN              7
STACUR              3F40
STAEMPTY            35DC
STAINIT             352E
STANEXT             3F42
STANONE             FFFFFFFF
STAPLOT             35AC
STAPLOT:PLTTBL      35C8
START               3E7E
START:DOPLOT        3F1C
START:LOOP          3EC6
START:NOTPLOT       3F26
START:SOLOWFPS      3F10
START:TXT           3F28
START:WINT          3ED0
STAUPD              3546
STAUPD:DOUPD        356C
STAUPD:INITBL       3584
STAUPD:UPDTBL       3598
SYSINIT             10C2
TANENEM             3
TANHEIGH            10
TANID               3F3C
TANINIT             1E16
TANINIT:BOT         1E6A
TANINIT:NOTDEMO     1E68
TANKCOL             1922
TANKCOL:CHKPLAY     198A
TANKCOL:LOOP        1956
TANKCOL:NTHG        1980
TANKCOL:NTHG1       19C4
TANPLAY             2
TANPLOT             23AA
TANPLOT:COLUMNA     23E0
TANPLOT:DRAW        23CC
TANPLOT:DRAWPLAY    23C8
TANPLOT:END         2462
TANPLOT:FILA        23D6
TANPLOT:PLOTLIFE    2428
TANUPD              1E88
TANUPD:BOT2         1F7C
TANUPD:CASOCERO     2008
TANUPD:CASODOS      2040
TANUPD:CASOUNO      2024
TANUPD:CHKDWN       1F18
TANUPD:CHKLEFT      1EE2
TANUPD:CHKVERT      21DA
TANUPD:COLBOT       2222
TANUPD:COLLFT       2208
TANUPD:COLRGT       21EE
TANUPD:COLTOP       22CE
TANUPD:CONT1        1F00
TANUPD:CONT2        211C
TANUPD:DEMOPLAY     1FAC
TANUPD:DIRASIGN     1FD4
TANUPD:DISP         1F30
TANUPD:DONE         2374
TANUPD:ENDALG       20B0
TANUPD:ENDALG2      20B2
TANUPD:ENEDISP      20E0
TANUPD:ENEDISP2     20F0
TANUPD:ENEMPOS      2394
TANUPD:FABSC        2240
TANUPD:FALSC        221C
TANUPD:FARSC        2202
TANUPD:FATSC        22E6
TANUPD:FDA          2324
TANUPD:FDB          227E
TANUPD:FIA          2368
TANUPD:FIB          22C2
TANUPD:FINISH       23A0
TANUPD:FLLOWPLR     2056
TANUPD:IA           232A
TANUPD:IB           2284
TANUPD:MOVVEC       23A6
TANUPD:NEGVELX      2070
TANUPD:NEGVELY      2098
TANUPD:NNA          236A
TANUPD:NNB          22C4
TANUPD:NOADVL       22B2
TANUPD:NOADVLA      2358
TANUPD:NOADVR       226E
TANUPD:NOADVRA      2314
TANUPD:NTRAT        2156
TANUPD:NXTEJE       2182
TANUPD:NXTEJE2      21AE
TANUPD:POSVELX      207E
TANUPD:POSVELY      20A6
TANUPD:SEG          21B2
TANUPD:SUBRTF       2118
TANUPD:TENX         217A
TANUPD:TENY         21A6
TANUPD:VELY         2088
TANWIDTH            10
TIEMPO              3F7A
UTLCHCOL            15B4
UTLCHCOL:END        15E2
UTLCHCOL:NOCOL      15E0
UTLCHRWD            8
UTLINIT             156C
UTLPRINT            1582
UTLPRINT:ENDLOOP    1594
UTLPRINT:LOOP       158A
UTLRAND             19FE
UTLRAND:RANDVEC     1A1C
UTLRNDIX            3F68
UTLSFIL             12A
UTLSPEN             0
WINDATA             18A986
WINHEIGH            50
WININIT             33B6
WININIT:TXT1        341C
WININIT:TXT2        3429
WINUPD              3468
WINUPD:CONT         347C
WINWIDTH            64
